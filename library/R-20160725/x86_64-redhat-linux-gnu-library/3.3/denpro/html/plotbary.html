<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Makes a barycenter plot of a level set tree, a location plot...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plotbary {denpro}"><tr><td>plotbary {denpro}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Makes a barycenter plot of a level set tree, a location plot of a
shape tree, or a tail tree plot of a tail tree
</h2>

<h3>Description</h3>

<p>Plots a barycenter plot of a level set tree,
or a location plot of a shape tree (of the given direction),
or a tail tree plot of tail tree (of the given direction).
A barycenter plot visualizes the barycenters of the separated
regions of the level sets of the function.
The barycenter of a set is the &quot;center of mass&quot; of this set.
A location plot visualizes the barycenters of the tail regions of a set.
A tail tree plot makes a parallel level plot of the data, and shows
the tree structure of the tail tree in the plot.
</p>


<h3>Usage</h3>

<pre>
plotbary(lst, coordi=1, 
plot=TRUE, data=FALSE, crit=NULL,orderrule="distcenter",
modelabel=FALSE, ptext=0, leimat=NULL, symbo=NULL, 
info=NULL, infolift=0, infopos=0,
xmarginleft=0, xmarginright=0, ymargin=0, 
xlim=NULL, ylim=NULL, xaxt="s", yaxt="s", 
nodesymbo=20, col=NULL, col.axis="black", collines=NULL, paletti=NULL,
shift=0, shiftindex=NULL,
modlabret=FALSE, modecolo=NULL, modepointer=NULL, colometh = "lst", 
colothre = min(lst$level), lines=TRUE, wedge=FALSE, lty.wedge=2, title=TRUE,
titletext="coordinate", cex=NULL, nodemag=NULL, cex.sub=1, cex.axis = 1, 
newtitle = FALSE, cex.lab = 1, lowest="dens", subtitle=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lst</code></td>
<td>
<p>level set tree or shape tree; list of vectors.
The list contains at least vectors &quot;level&quot;, &quot;volume&quot;, and &quot;parent&quot;. 
For example, function &quot;leafsfirst&quot; gives a level set tree or a shape tree
as an output. 
Functions &quot;profkern&quot; and &quot;profhist&quot; give a level 
set tree as an output.
</p>
</td></tr>
<tr valign="top"><td><code>coordi</code></td>
<td>
<p>integer 1,...,d, when the function is d-dimensional; 
gives the coordinate direction
with respect which the plot will be made.</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p>T or F; TRUE if we make a plot, otherwise FALSE.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>T or F; TRUE if we want the output to contain some
information, for example the ordering for siblings. 
This option is needed only by  other plotting
functions of the package, it is not needed by the end user.</p>
</td></tr>
<tr valign="top"><td><code>crit</code></td>
<td>
<p>d-vector of real numbers; gives a way to control
an ordering of siblings. The leftmost sibling is the one whose
barycenter is furthest away from vector &quot;crit&quot;, in the Euclidean metric.</p>
</td></tr>
<tr valign="top"><td><code>orderrule</code></td>
<td>
<p>lower level parameter</p>
</td></tr>
<tr valign="top"><td><code>modelabel</code></td>
<td>
<p>T or F; TRUE if the modes will be labelled.
The default is to use labels M1, M2,...</p>
</td></tr>
<tr valign="top"><td><code>ptext</code></td>
<td>
<p>non-negative real number; amount by which the mode
labels will be lifted.</p>
</td></tr>
<tr valign="top"><td><code>leimat</code></td>
<td>
<p>vector of characters; the length of the vector should be
equal to the number of modes of the estimate.
This option is for the case we do not want the ordering of the
labels to be done automatically.</p>
</td></tr>
<tr valign="top"><td><code>symbo</code></td>
<td>
<p>character; for example &quot;L&quot;. The default value for the
automatic labelling of the modes is to use M1, M2,...
With &quot;symbo&quot; we may switch to L1, L2,..., for example.</p>
</td></tr>
<tr valign="top"><td><code>info</code></td>
<td>
<p>vector of numbers or characters, whose length is equal
to the number of nodes of the level set tree.
The elements of &quot;info&quot; will be placed on the right side of the 
nodes. For example &quot;info&quot; may be generated by &quot;excmas&quot; or we may define
&quot;info&quot; to contain the frequencies of the nodes.
(Frequencies may be obtained directly from the function &quot;profhist&quot;)</p>
</td></tr>
<tr valign="top"><td><code>infolift</code></td>
<td>
<p>real number; controls the vertical positioning of
the elements of &quot;info&quot;.</p>
</td></tr>
<tr valign="top"><td><code>infopos</code></td>
<td>
<p>real number; controls the horizontal positioning of
the elements of &quot;info&quot;. Negative &quot;infopos&quot; will move elements of
&quot;info&quot; to the right hand side.</p>
</td></tr>
<tr valign="top"><td><code>xmarginleft</code></td>
<td>
<p>non-negative real number; adds more margin on the 
left hand side. The box around the plot will be moved to the left
with the amount &quot;xmarginleft&quot;.</p>
</td></tr>
<tr valign="top"><td><code>xmarginright</code></td>
<td>
<p>non-negative real number; adds more margin on the 
right hand side. The box around the plot will be moved to the right
with the amount &quot;xmarginright&quot;.</p>
</td></tr>
<tr valign="top"><td><code>ymargin</code></td>
<td>
<p>nonnegative real number; adds more margin on the 
top of the plot. The box around plot will be moved up
with the amount &quot;ymargin&quot;.</p>
</td></tr>
<tr valign="top"><td><code>xlim</code></td>
<td>
<p>vector of 2 real numbers; gives the limits for the scale
of x-axis.</p>
</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
<p>vector of 2 real numbers; gives the limits for the scale
of y-axis.</p>
</td></tr>
<tr valign="top"><td><code>xaxt</code></td>
<td>
<p>a character which specifies the x axis type; either &quot;s&quot; or &quot;n&quot;;
see &quot;par&quot;</p>
</td></tr>
<tr valign="top"><td><code>yaxt</code></td>
<td>
<p>a character which specifies the y axis type; either &quot;s&quot; or &quot;n&quot;;
see &quot;par&quot;</p>
</td></tr>
<tr valign="top"><td><code>nodesymbo</code></td>
<td>
<p>symbol for the nodes of the tree; integer 19-25; 
see help(points) for the definitions</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>colour for the nodes; for example &quot;black&quot; or &quot;blue&quot;.</p>
</td></tr>
<tr valign="top"><td><code>col.axis</code></td>
<td>
<p>colour for the x and y-axis; for example &quot;black&quot; or
&quot;blue&quot;.</p>
</td></tr>
<tr valign="top"><td><code>collines</code></td>
<td>
<p>colour for lines joining nodes; 
for example &quot;black&quot; or &quot;blue&quot;.</p>
</td></tr>
<tr valign="top"><td><code>paletti</code></td>
<td>
<p>a character vector of color names, in the order they will be
used to color the nodes and the lines connecting the nodes; coloring starts
from the leafs nodes and the color is changed always when two branches 
are joining</p>
</td></tr>
<tr valign="top"><td><code>shift</code></td>
<td>
<p>a real number; the amount to shift a label of a leaf node;
used to enhance the plot, see the parameter &quot;shiftindex&quot;</p>
</td></tr>
<tr valign="top"><td><code>shiftindex</code></td>
<td>
<p>the index to be shifted, see the parameter &quot;shift&quot;</p>
</td></tr>
<tr valign="top"><td><code>modlabret</code></td>
<td>
<p>T or F; T if the locations of the modes will be returned</p>
</td></tr>
<tr valign="top"><td><code>modecolo</code></td>
<td>
<p>lowel level parameter</p>
</td></tr>
<tr valign="top"><td><code>modepointer</code></td>
<td>
<p>lowel level parameter</p>
</td></tr>
<tr valign="top"><td><code>colometh</code></td>
<td>
<p>if colometh==&quot;lst&quot;, then colors are first chosen for 
the leafs, otherwise the colors are first chosen for the roots;
for the level set trees it is better to choose &quot;lst&quot;, but for dendrograms it
is better to color the roots first</p>
</td></tr>
<tr valign="top"><td><code>colothre</code></td>
<td>
<p>positive real number; fixes the colors at the level given by
&quot;colothre&quot;, this option is used for dendrograms</p>
</td></tr>
<tr valign="top"><td><code>lines</code></td>
<td>
<p>TRUE or FALSE; used in a tail tree plot; FALSE suppresses the 
parent-child lines and one can avoid over plotting</p>
</td></tr>
<tr valign="top"><td><code>wedge</code></td>
<td>
<p>TRUE or FALSE; used in a tail tree plot if TRUE, then the 
outer limts for the points will be plotted; these outer limits have a
wedge form</p>
</td></tr>
<tr valign="top"><td><code>lty.wedge</code></td>
<td>
<p>&quot;lty&quot; parameter (line type) for the wedge lines</p>
</td></tr>
<tr valign="top"><td><code>title</code></td>
<td>
<p>if TRUE, then the subtitle &quot;coordinate i&quot; is printed
when the coordinate is i and the the titletext is &quot;coordinate&quot;</p>
</td></tr>
<tr valign="top"><td><code>titletext</code></td>
<td>
<p>character string; the text in the title will be titletext i,
if the barycenter plot is for the i:th coordinate</p>
</td></tr>
<tr valign="top"><td><code>cex</code></td>
<td>
<p>magnification factor for the symbols; see &quot;par&quot; </p>
</td></tr>
<tr valign="top"><td><code>nodemag</code></td>
<td>
<p>magnification factor for the the points </p>
</td></tr>
<tr valign="top"><td><code>cex.sub</code></td>
<td>
<p>magnification factor for the subtitle; see &quot;par&quot; </p>
</td></tr>
<tr valign="top"><td><code>cex.axis</code></td>
<td>
<p>the magnification to be used for axis annotation; see &quot;par&quot;</p>
</td></tr>
<tr valign="top"><td><code>newtitle</code></td>
<td>
<p>FALSE or TRUE; if TITLE=FALSE, we can put newtitle=TRUE
to print the title as an x-axis annotation, and not as a subtitle</p>
</td></tr>
<tr valign="top"><td><code>cex.lab</code></td>
<td>
<p>the magnification to be used for x and y labels; see &quot;par&quot;</p>
</td></tr>
<tr valign="top"><td><code>lowest</code></td>
<td>
<p>&quot;dens&quot; or &quot;regr&quot;; if lowest=&quot;dens&quot;, then it is assumed that the 
underlying function is a density function; if lowest=&quot;regr&quot;, then it is
assumed that the underlying function is an arbitrary multivariate real 
function</p>
</td></tr>
<tr valign="top"><td><code>subtitle</code></td>
<td>
<p>NULL or a character string; gives the subtitle of the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default a plot is made on the graphics window. 
If modlabret=T, then the locations of the modes are returned,
with the labeling of the modes corresponding to the labeling in the plot. 
</p>


<h3>Author(s)</h3>

<p> Jussi Klemela </p>


<h3>See Also</h3>

 
<p><code><a href="leafsfirst.html">leafsfirst</a></code>,
<code><a href="treedisc.html">treedisc</a></code>,
<code><a href="prunemodes.html">prunemodes</a></code>,
<code><a href="plotvolu.html">plotvolu</a></code>, 
<code><a href="plottree.html">plottree</a></code>
</p>


<h3>Examples</h3>

<pre>
# level set tree

dendat&lt;-sim.data(n=100,type="mulmod")
pcf&lt;-pcf.kern(dendat,h=1,N=c(32,32))
lst&lt;-leafsfirst(pcf)             
td&lt;-treedisc(lst,pcf,ngrid=30)

plotbary(td)

plotbary(td,coordi=2,ptext=0.002,symbo="L",modlabret=TRUE)

# shape tree

dendat&lt;-sim.data(n=100,type="cross")
pcf&lt;-pcf.kern(dendat,h=1,N=c(32,32))
st&lt;-leafsfirst(pcf,propor=0.01)   
td&lt;-treedisc(st,pcf,ngrid=60)

plotbary(td)

# tail tree

tt&lt;-leafsfirst(dendat=dendat,rho=0.65)  
plotbary(tt)

</pre>

<hr /><div style="text-align: center;">[Package <em>denpro</em> version 0.9.2 <a href="00Index.html">Index</a>]</div>
</body></html>
