<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: The Beta-Binomial Distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Betabinom {VGAM}"><tr><td>Betabinom {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>The Beta-Binomial Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, and random
generation for the beta-binomial distribution
and the inflated beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre>
dbetabinom(x, size, prob, rho = 0, log = FALSE)
pbetabinom(q, size, prob, rho, log.p = FALSE)
rbetabinom(n, size, prob, rho = 0)
dbetabinom.ab(x, size, shape1, shape2, log = FALSE, Inf.shape = 1e6)
pbetabinom.ab(q, size, shape1, shape2, log.p = FALSE)
rbetabinom.ab(n, size, shape1, shape2, .dontuse.prob = NULL)
dzoibetabinom(x, size, prob, rho = 0, pstr0 = 0, pstrsize = 0, log = FALSE)
pzoibetabinom(q, size, prob, rho, pstr0 = 0, pstrsize = 0, 
              lower.tail = TRUE, log.p = FALSE)
rzoibetabinom(n, size, prob, rho = 0, pstr0 = 0, pstrsize = 0)
dzoibetabinom.ab(x, size, shape1, shape2, pstr0 = 0, pstrsize = 0, log = FALSE)
pzoibetabinom.ab(q, size, shape1, shape2, pstr0 = 0, pstrsize = 0,
              lower.tail = TRUE, log.p = FALSE)
rzoibetabinom.ab(n, size, shape1, shape2, pstr0 = 0, pstrsize = 0)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
</table>

<table summary="R argblock">
<tr valign="top"><td><code>size</code></td>
<td>
<p>number of trials.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of observations.
Same as <code><a href="../../stats/html/runif.html">runif</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>prob</code></td>
<td>

<p>the probability of success <i>mu</i>.
Must be in the unit closed interval <i>[0,1]</i>.
</p>
</td></tr>
<tr valign="top"><td><code>rho</code></td>
<td>

<p>the correlation parameter <i>rho</i>.
Usually must be in the unit open interval <i>(0,1)</i>,
however, the value 0 is sometimes supported
(if so then it corresponds to the usual binomial distribution).
</p>
</td></tr>
<tr valign="top"><td><code>shape1, shape2</code></td>
<td>

<p>the two (positive) shape parameters of the standard
beta distribution. They are called <code>a</code> and <code>b</code> in
<code><a href="../../base/html/Special.html">beta</a></code> respectively.
</p>
</td></tr>
<tr valign="top"><td><code>log, log.p, lower.tail</code></td>
<td>

<p>Same meaning as <code><a href="../../stats/html/runif.html">runif</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>Inf.shape</code></td>
<td>

<p>Numeric. A large value such that,
if <code>shape1</code> or <code>shape2</code> exceeds this, then
it is taken to be <code>Inf</code>.
Also, if <code>shape1</code> or <code>shape2</code> is less than its reciprocal,
then it might be loosely thought of as being effectively <code>0</code>
(although not treated exactly as so in the code).
This feature/approximation is needed to avoid numerical
problem with catastrophic cancellation of
multiple <code><a href="../../base/html/Special.html">lbeta</a></code> calls.
</p>
</td></tr>
<tr valign="top"><td><code>.dontuse.prob</code></td>
<td>

<p>An argument that should be ignored and unused.
</p>
</td></tr>
<tr valign="top"><td><code>pstr0</code></td>
<td>

<p>Probability of a structual zero (i.e., ignoring the beta-binomial distribution). 
The default value of <code>pstr0</code> corresponds to the response having a
beta-binomial distribuion inflated only at <code>size</code>.
</p>
</td></tr>
<tr valign="top"><td><code>pstrsize</code></td>
<td>

<p>Probability of a structual maximum value <code>size</code>. The default value of
<code>pstrsize</code> corresponds to the response having a beta-binomial distribution
inflated only at 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The beta-binomial distribution is a binomial distribution whose
probability of success is not a constant but it is generated from a
beta distribution with parameters <code>shape1</code> and <code>shape2</code>.
Note that the mean of this beta distribution is
<code>mu = shape1/(shape1+shape2)</code>, which therefore is the
mean or the probability of success.
</p>
<p>See <code><a href="betabinomial.html">betabinomial</a></code> and <code><a href="betabinomialff.html">betabinomialff</a></code>,
the <span class="pkg">VGAM</span> family functions for
estimating the parameters, for the formula of the probability density
function and other details.
</p>
<p>For the inflated beta-binomial distribution, the probability mass 
function is
</p>
<p style="text-align: center;"><i>
        F(Y = y) =(1 -  pstr0 - pstrsize) * BB(y) +  pstr0 * I[y = 0] +
        pstrsize * I[y = size]</i></p>

<p>where <i>BB(y)</i> is the probability mass function
of the beta-binomial distribution with the same shape parameters
(<code><a href="pbetabinom.ab.html">pbetabinom.ab</a></code>), 
<code>pstr0</code> is the inflated probability at 0
and <code>pstrsize</code> is the inflated probability at 1.
The default values of <code>pstr0</code> and <code>pstrsize</code> mean that these
functions behave like the ordinary <code><a href="Betabinom.html">Betabinom</a></code>
when only the essential arguments are inputted.
</p>


<h3>Value</h3>

<p><code>dbetabinom</code> and <code>dbetabinom.ab</code> give the density,
<code>pbetabinom</code> and <code>pbetabinom.ab</code> give the distribution function, and
<code>rbetabinom</code> and <code>rbetabinom.ab</code> generate random deviates.
</p>

<p><code>dzoibetabinom</code> and <code>dzoibetabinom.ab</code> give the inflated density,
<code>pzoibetabinom</code> and <code>pzoibetabinom.ab</code> give the inflated distribution function, and
<code>rzoibetabinom</code> and <code>rzoibetabinom.ab</code> generate random inflated deviates.
</p>


<h3>Note</h3>

<p><code>pzoibetabinom</code>, <code>pzoibetabinom.ab</code>, 
<code>pbetabinom</code> and <code>pbetabinom.ab</code> can be particularly slow.
The functions here ending in <code>.ab</code> are called from those
functions which don't.
The simple transformations
<i>mu=alpha/(alpha+beta)</i> and
<i>rho=1/(1+alpha+beta)</i> are used,
where <i>alpha</i> and <i>beta</i> are the two
shape parameters.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee and Xiangjie Xue</p>


<h3>See Also</h3>

<p><code><a href="betabinomial.html">betabinomial</a></code>,
<code><a href="betabinomialff.html">betabinomialff</a></code>,
<code><a href="zoabetaUC.html">Zoabeta</a></code>.
</p>


<h3>Examples</h3>

<pre>
set.seed(1); rbetabinom(10, 100, prob = 0.5)
set.seed(1);     rbinom(10, 100, prob = 0.5)  # The same since rho = 0

## Not run:  N &lt;- 9; xx &lt;- 0:N; s1 &lt;- 2; s2 &lt;- 3
dy &lt;- dbetabinom.ab(xx, size = N, shape1 = s1, shape2 = s2)
barplot(rbind(dy, dbinom(xx, size = N, prob = s1 / (s1+s2))),
        beside = TRUE, col = c("blue","green"), las = 1,
        main = paste("Beta-binomial (size=",N,", shape1=", s1,
                   ", shape2=", s2, ") (blue) vs\n",
        " Binomial(size=", N, ", prob=", s1/(s1+s2), ") (green)", sep = ""),
        names.arg = as.character(xx), cex.main = 0.8)
sum(dy * xx)  # Check expected values are equal
sum(dbinom(xx, size = N, prob = s1 / (s1+s2)) * xx)
cumsum(dy) - pbetabinom.ab(xx, N, shape1 = s1, shape2 = s2)  # Should be all 0

y &lt;- rbetabinom.ab(n = 10000, size = N, shape1 = s1, shape2 = s2)
ty &lt;- table(y)
barplot(rbind(dy, ty / sum(ty)),
        beside = TRUE, col = c("blue", "orange"), las = 1,
        main = paste("Beta-binomial (size=", N, ", shape1=", s1,
                     ", shape2=", s2, ") (blue) vs\n",
        " Random generated beta-binomial(size=", N, ", prob=", s1/(s1+s2),
        ") (orange)", sep = ""), cex.main = 0.8,
        names.arg = as.character(xx)) 

set.seed(208); N &lt;- 1000000; size = 20;
pstr0 &lt;- 0.2; pstrsize &lt;- 0.2
k &lt;- rzoibetabinom.ab(N, size, s1, s2, pstr0, pstrsize)
hist(k, probability = TRUE, border = "blue",
     main = "Blue = inflated; orange = ordinary beta-binomial",
     breaks = -0.5 : (size + 0.5))
sum(k == 0) / N  # Proportion of 0
sum(k == size) / N  # Proportion of size
lines(0 : size,
      dbetabinom.ab(0 : size, size, s1, s2), col = "orange")
lines(0 : size, col = "blue",
      dzoibetabinom.ab(0 : size, size, s1, s2, pstr0, pstrsize))

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
