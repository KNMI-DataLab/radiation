<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fitting a Dirichlet Distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for dirichlet {VGAM}"><tr><td>dirichlet {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Fitting a Dirichlet Distribution </h2>

<h3>Description</h3>

<p>Fits a Dirichlet distribution to a matrix of compositions.
</p>


<h3>Usage</h3>

<pre>
dirichlet(link = "loge", parallel = FALSE, zero = NULL, imethod = 1)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link</code></td>
<td>

<p>Link function applied to each of the <i>M</i> (positive) shape
parameters <i>alpha_j</i>.
See <code><a href="Links.html">Links</a></code> for more choices.
The default gives <i>eta_j=log(alpha_j)</i>.
</p>
</td></tr>
<tr valign="top"><td><code>parallel, zero, imethod</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this help file the response is assumed to be a <i>M</i>-column
matrix with positive values and whose rows each sum to unity.
Such data can be thought of as compositional data.
There are <i>M</i> linear/additive predictors <i>eta_j</i>.
</p>
<p>The Dirichlet distribution is commonly used to model compositional
data, including applications in genetics.
Suppose <i>(Y_1,&hellip;,Y_M)^T</i> is
the response. Then it has a Dirichlet distribution if
<i>(Y_1,&hellip;,Y_{M-1})^T</i> has density
</p>
<p style="text-align: center;"><i>
           (Gamma(alpha_+) / prod_{j=1}^M gamma(alpha_j))
           prod_{j=1}^M y_j^(alpha_j -1)</i></p>

<p>where <i>alpha_+= alpha_1 + &hellip; + alpha_M</i>,
<i>alpha_j &gt; 0</i>,
and the density is defined on the unit simplex
</p>
<p style="text-align: center;"><i>
  Delta_M = {
  (y_1,&hellip;,y_M)^T :
  y_1 &gt; 0, &hellip;, y_M &gt; 0,
  &sum;_{j=1}^M y_j = 1 }.
  </i></p>

<p>One has <i>E(Y_j) = alpha_j / alpha_{+}</i>,
which are returned as the fitted values.
For this distribution Fisher scoring corresponds to Newton-Raphson.
</p>
<p>The Dirichlet distribution can be motivated by considering the random variables
<i>(G_1,&hellip;,G_M)^T</i> which are each independent
and identically distributed as a gamma distribution with density 
<i>f(g_j)=
              g_j^(alpha_j - 1) e^(-g_j) / gamma(alpha_j)</i>.
Then the Dirichlet distribution arises when
<i>Y_j = G_j / (G_1 + ... + G_M)</i>.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
<code><a href="rrvglm.html">rrvglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>
<p>When fitted, the <code>fitted.values</code> slot of the object contains the
<i>M</i>-column matrix of means. 
</p>


<h3>Note</h3>

<p>The response should be a matrix of positive values whose rows
each sum to unity. Similar to this is count data, where probably a
multinomial logit model (<code><a href="multinomial.html">multinomial</a></code>) may be appropriate.
Another similar distribution to the Dirichlet is the
Dirichlet-multinomial (see <code><a href="dirmultinomial.html">dirmultinomial</a></code>).
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Lange, K. (2002)
<em>Mathematical and Statistical Methods for Genetic Analysis</em>,
2nd ed. New York: Springer-Verlag.
</p>
<p>Forbes, C., Evans, M., Hastings, N. and Peacock, B. (2011)
<em>Statistical Distributions</em>,
Hoboken, NJ, USA: John Wiley and Sons, Fourth edition.
</p>





<h3>See Also</h3>

<p><code><a href="rdiric.html">rdiric</a></code>,
<code><a href="dirmultinomial.html">dirmultinomial</a></code>,
<code><a href="multinomial.html">multinomial</a></code>,
<code><a href="simplex.html">simplex</a></code>.
</p>


<h3>Examples</h3>

<pre>
ddata &lt;- data.frame(rdiric(n = 1000,
                           shape = exp(c(y1 = -1, y2 = 1, y3 = 0))))
fit &lt;- vglm(cbind(y1, y2, y3)  ~ 1, dirichlet,
            data = ddata, trace = TRUE, crit = "coef")
Coef(fit)
coef(fit, matrix = TRUE)
head(fitted(fit))
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
