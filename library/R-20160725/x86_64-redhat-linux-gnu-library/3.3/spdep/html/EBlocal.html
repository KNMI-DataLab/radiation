<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Local Empirical Bayes estimator</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for EBlocal {spdep}"><tr><td>EBlocal {spdep}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Local Empirical Bayes estimator</h2>

<h3>Description</h3>

<p>The function computes local empirical Bayes estimates for rates &quot;shrunk&quot; to a neighbourhood mean for neighbourhoods given by the <code>nb</code> neighbourhood list.
</p>


<h3>Usage</h3>

<pre>
EBlocal(ri, ni, nb, zero.policy = NULL, spChk = NULL, geoda=FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>ri</code></td>
<td>
<p>a numeric vector of counts of cases the same length as the neighbours list in nb</p>
</td></tr>
<tr valign="top"><td><code>ni</code></td>
<td>
<p>a numeric vector of populations at risk the same length as the neighbours list in nb</p>
</td></tr>
<tr valign="top"><td><code>nb</code></td>
<td>
<p>a <code>nb</code> object of neighbour relationships</p>
</td></tr>
<tr valign="top"><td><code>zero.policy</code></td>
<td>
<p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td></tr>
<tr valign="top"><td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td></tr>
<tr valign="top"><td><code>geoda</code></td>
<td>
<p>default=FALSE, following Marshall's algorithm as interpreted by Bailey and Gatrell, pp. 305-307, and exercise 8.2, pp. 328-330 for the definition of phi; TRUE for the definition of phi used in GeoDa (see discussion on OpenSpace mailing list June 2003: http://agec221.agecon.uiuc.edu/pipermail/openspace/2003-June/thread.html)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details of the implementation are to be found in Marshall, p. 286, and Bailey and Gatrell p. 307 and exercise 8.2, pp. 328&ndash;330. The example results do not fully correspond to the sources because of slightly differing neighbourhoods, but are generally close.
</p>


<h3>Value</h3>

<p>A data frame with two columns:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>raw</code></td>
<td>
<p>a numerical vector of raw (crude) rates</p>
</td></tr>
<tr valign="top"><td><code>est</code></td>
<td>
<p>a numerical vector of local empirical Bayes estimates</p>
</td></tr>
</table>
<p>and a <code>parameters</code> attribute list with components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>a</code></td>
<td>
<p>a numerical vector of local phi values</p>
</td></tr>
<tr valign="top"><td><code>m</code></td>
<td>
<p>a numerical vector of local gamma values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a>, based on contributions by Marilia Carvalho</p>


<h3>References</h3>

<p>Marshall R M (1991) Mapping disease and mortality rates using Empirical Bayes Estimators, Applied Statistics, 40, 283&ndash;294; Bailey T, Gatrell A (1995) Interactive Spatial Data Analysis, Harlow: Longman, pp. 303&ndash;306.</p>


<h3>See Also</h3>

<p><code><a href="EBest.html">EBest</a></code>, <code><a href="probmap.html">probmap</a></code></p>


<h3>Examples</h3>

<pre>
example(auckland)
res &lt;- EBlocal(auckland$M77_85,  9*auckland$Und5_81, auckland.nb)
brks &lt;- c(-Inf,2,2.5,3,3.5,Inf)
cols &lt;- grey(6:2/7)
plot(auckland, col=cols[findInterval(res$est*1000, brks, all.inside=TRUE)])
legend("bottomleft", fill=cols, legend=leglabs(brks), bty="n")
title(main="Local moment estimator of infant mortality per 1000 per year")
</pre>

<hr /><div style="text-align: center;">[Package <em>spdep</em> version 0.6-6 <a href="00Index.html">Index</a>]</div>
</body></html>
