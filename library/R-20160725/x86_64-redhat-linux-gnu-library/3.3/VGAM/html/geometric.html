<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Geometric (Truncated and Untruncated) Distributions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for geometric {VGAM}"><tr><td>geometric {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Geometric (Truncated and Untruncated) Distributions </h2>

<h3>Description</h3>

<p>Maximum likelihood estimation for the geometric
and truncated geometric distributions.
</p>


<h3>Usage</h3>

<pre>
geometric(link = "logit", expected = TRUE, imethod = 1,
          iprob = NULL, zero = NULL)
truncgeometric(upper.limit = Inf,
               link = "logit", expected = TRUE, imethod = 1,
               iprob = NULL, zero = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link</code></td>
<td>

<p>Parameter link function applied to the
probability parameter <i>prob</i>, which lies in the unit interval.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>expected</code></td>
<td>
 
<p>Logical. 
Fisher scoring is used if <code>expected = TRUE</code>, else Newton-Raphson.
</p>
</td></tr>
<tr valign="top"><td><code>iprob, imethod, zero</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for details.
</p>
</td></tr>
<tr valign="top"><td><code>upper.limit</code></td>
<td>

<p>Numeric.
Upper values.
As a vector, it is recycled across responses first.
The default value means both family functions should give the same result.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A random variable <i>Y</i> has a 1-parameter geometric distribution
if <i>P(Y=y) = prob * (1-prob)^y</i>
for <i>y=0,1,2,...</i>.
Here, <i>prob</i> is the probability of success,
and <i>Y</i> is the number of (independent) trials that are fails
until a success occurs.
Thus the response <i>Y</i> should be a non-negative integer.
The mean of <i>Y</i> is <i>E(Y) = (1-prob)/prob</i>
and its variance is <i>Var(Y) = (1-prob)/prob^2</i>.
The geometric distribution is a special case of the 
negative binomial distribution (see <code><a href="negbinomial.html">negbinomial</a></code>).
The geometric distribution is also a special case of the 
Borel distribution, which is a Lagrangian distribution.
If <i>Y</i> has a geometric distribution with parameter <i>prob</i> then
<i>Y+1</i> has a positive-geometric distribution with the same parameter.
Multiple responses are permitted.
</p>
<p>For <code>truncgeometric()</code>,
the (upper) truncated geometric distribution can have response integer
values from 0 to <code>upper.limit</code>.
It has density <code>prob * (1 - prob)^y / [1-(1-prob)^(1+upper.limit)]</code>.
</p>
<p>For a generalized truncated geometric distribution with
integer values <i>L</i> to <i>U</i>, say, subtract <i>L</i>
from the response and feed in <i>U-L</i> as the upper limit.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Author(s)</h3>

<p>T. W. Yee.
Help from Viet Hoang Quoc is gratefully acknowledged.
</p>


<h3>References</h3>

<p>Forbes, C., Evans, M., Hastings, N. and Peacock, B. (2011)
<em>Statistical Distributions</em>,
Hoboken, NJ, USA: John Wiley and Sons, Fourth edition.
</p>


<h3>See Also</h3>

 
<p><code><a href="negbinomial.html">negbinomial</a></code>,
<code><a href="../../stats/html/Geometric.html">Geometric</a></code>,
<code><a href="betageometric.html">betageometric</a></code>,
<code><a href="expgeometric.html">expgeometric</a></code>,
<code><a href="zageometric.html">zageometric</a></code>,
<code><a href="zigeometric.html">zigeometric</a></code>,
<code><a href="betageomUC.html">rbetageom</a></code>,
<code><a href="simulate.vlm.html">simulate.vlm</a></code>.
</p>


<h3>Examples</h3>

<pre>
gdata &lt;- data.frame(x2 = runif(nn &lt;- 1000) - 0.5)
gdata &lt;- transform(gdata, x3 = runif(nn) - 0.5,
                          x4 = runif(nn) - 0.5)
gdata &lt;- transform(gdata, eta  = -1.0 - 1.0 * x2 + 2.0 * x3)
gdata &lt;- transform(gdata, prob = logit(eta, inverse = TRUE))
gdata &lt;- transform(gdata, y1 = rgeom(nn, prob))
with(gdata, table(y1))
fit1 &lt;- vglm(y1 ~ x2 + x3 + x4, geometric, data = gdata, trace = TRUE)
coef(fit1, matrix = TRUE)
summary(fit1)

# Truncated geometric (between 0 and upper.limit)
upper.limit &lt;- 5
tdata &lt;- subset(gdata, y1 &lt;= upper.limit)
nrow(tdata)  # Less than nn
fit2 &lt;- vglm(y1 ~ x2 + x3 + x4, truncgeometric(upper.limit),
             data = tdata, trace = TRUE)
coef(fit2, matrix = TRUE)

# Generalized truncated geometric (between lower.limit and upper.limit)
lower.limit &lt;- 1
upper.limit &lt;- 8
gtdata &lt;- subset(gdata, lower.limit &lt;= y1 &amp; y1 &lt;= upper.limit)
with(gtdata, table(y1))
nrow(gtdata)  # Less than nn
fit3 &lt;- vglm(y1 - lower.limit ~ x2 + x3 + x4,
             truncgeometric(upper.limit - lower.limit),
             data = gtdata, trace = TRUE)
coef(fit3, matrix = TRUE)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
