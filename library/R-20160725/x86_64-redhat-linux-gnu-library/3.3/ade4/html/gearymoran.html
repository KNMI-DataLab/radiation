<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Moran's I and Geary'c randomization tests for spatial and...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for gearymoran {ade4}"><tr><td>gearymoran {ade4}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Moran's I and Geary'c randomization tests for spatial and phylogenetic autocorrelation</h2>

<h3>Description</h3>

<p>This function performs Moran's I test using phylogenetic and spatial link matrix (binary or general). It uses neighbouring weights so Moran's I and Geary's c randomization tests are equivalent.
</p>


<h3>Usage</h3>

<pre>
gearymoran(bilis, X, nrepet = 999, alter=c("greater", "less", "two-sided"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>bilis</code></td>
<td>
<p>: a <em>n</em> by <em>n</em> link matrix where <em>n</em> is the row number of X</p>
</td></tr>
<tr valign="top"><td><code>X</code></td>
<td>
<p>: a data frame with continuous variables</p>
</td></tr>
<tr valign="top"><td><code>nrepet</code></td>
<td>
<p>: number of random vectors for the randomization test</p>
</td></tr>
<tr valign="top"><td><code>alter</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;greater&quot; (default), &quot;less&quot; or &quot;two-sided&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bilis</code> is a squared symmetric matrix which terms are all positive or null. 
</p>
<p><code>bilis</code> is firstly transformed in frequency matrix A by dividing it by the total sum of data matrix :  
</p>
<p style="text-align: center;"><i>a_ij = bilis_ij / (sum_i sum_j bilis_ij)</i></p>
 
<p>The neighbouring weights is defined by the matrix <i>D = diag(d_1,d_2, &hellip;)</i> where <i>d_i = sum_j bilis_ij</i>.
For each vector x of the data frame X, the test is based on the Moran statistic <i>t(x)Ax</i> where x is D-centred. 
</p>


<h3>Value</h3>

<p>Returns an object of class <code>krandtest</code> (randomization tests).
</p>


<h3>Author(s)</h3>

<p>SÃ©bastien Ollier <a href="mailto:sebastien.ollier@u-psud.fr">sebastien.ollier@u-psud.fr</a> <br />
Daniel Chessel 
</p>


<h3>References</h3>

<p>Cliff, A. D. and Ord, J. K. (1973) <em>Spatial autocorrelation</em>, Pion, London.
</p>
<p>Thioulouse, J., Chessel, D. and Champely, S. (1995) Multivariate analysis of spatial patterns: a unified approach to local and global structures. 
<em>Environmental and Ecological Statistics</em>, <b>2</b>, 1&ndash;14.
</p>


<h3>See Also</h3>

<p><code><a href="../../spdep/html/moran.test.html">moran.test</a></code> and <code><a href="../../spdep/html/geary.test.html">geary.test</a></code> for classical versions of Moran's test and Geary's one</p>


<h3>Examples</h3>

<pre>
# a spatial example
data(mafragh)
tab0 &lt;- (as.data.frame(scalewt(mafragh$mil)))
bilis0 &lt;- neig2mat(mafragh$neig)
gm0 &lt;- gearymoran(bilis0, tab0, 999)
gm0
plot(gm0, nclass = 20)

## Not run: 
# a phylogenetic example
data(mjrochet)
mjr.phy &lt;- newick2phylog(mjrochet$tre)
mjr.tab &lt;- log(mjrochet$tab)
gearymoran(mjr.phy$Amat, mjr.tab)
gearymoran(mjr.phy$Wmat, mjr.tab)
if(adegraphicsLoaded()) {
  g1 &lt;- table.value(mjr.phy$Wmat, ppoints.cex = 0.35, nclass = 5,
axis.text = list(cex = 0), plot = F)
  g2 &lt;- table.value(mjr.phy$Amat, ppoints.cex = 0.35, nclass = 5,
axis.text = list(cex = 0), plot = F)
  G &lt;- cbindADEg(g1, g2, plot = TRUE)
  
} else {
  par(mfrow = c(1,2))
  table.value(mjr.phy$Wmat, csi = 0.25, clabel.r = 0)
  table.value(mjr.phy$Amat, csi = 0.35, clabel.r = 0)
  par(mfrow = c(1,1))
}

## End(Not run)</pre>

<hr /><div style="text-align: center;">[Package <em>ade4</em> version 1.7-4 <a href="00Index.html">Index</a>]</div>
</body></html>
