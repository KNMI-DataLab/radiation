<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Beta-binomial Distribution Family Function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for betabinomial {VGAM}"><tr><td>betabinomial {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Beta-binomial Distribution Family Function </h2>

<h3>Description</h3>

<p>Fits a beta-binomial distribution by maximum likelihood estimation.
The two parameters here are the mean and correlation coefficient.
</p>


<h3>Usage</h3>

<pre>
betabinomial(lmu = "logit", lrho = "logit", irho = NULL, imethod = 1,
             ishrinkage = 0.95, nsimEIM = NULL, zero = "rho")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lmu, lrho</code></td>
<td>
 
<p>Link functions applied to the two parameters.
See <code><a href="Links.html">Links</a></code> for more choices.
The defaults ensure the parameters remain in <i>(0,1)</i>,
however, see the warning below.
</p>
</td></tr>
<tr valign="top"><td><code>irho</code></td>
<td>
 
<p>Optional initial value for the correlation parameter.
If given, it must be in <i>(0,1)</i>, and is recyled to the necessary
length. Assign this argument a value if a convergence failure occurs.
Having <code>irho = NULL</code> means an initial value is obtained internally,
though this can give unsatisfactory results.
</p>
</td></tr>
<tr valign="top"><td><code>imethod</code></td>
<td>

<p>An integer with value <code>1</code> or <code>2</code> or ...,
which specifies the initialization method for <i>mu</i>.
If failure to converge occurs try the another value
and/or else specify a value for <code>irho</code>.
</p>
</td></tr>
<tr valign="top"><td><code>zero</code></td>
<td>
 
<p>Specifyies which
linear/additive predictor is to be modelled as an intercept only.
If assigned, the single value can be either <code>1</code> or <code>2</code>.
The default is to have a single correlation parameter.
To model both parameters as functions of the covariates assign
<code>zero = NULL</code>.
See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more information.
</p>
</td></tr>
<tr valign="top"><td><code>ishrinkage, nsimEIM</code></td>
<td>
 
<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more information.
The argument <code>ishrinkage</code> is used only if <code>imethod = 2</code>.
Using the argument <code>nsimEIM</code> may offer large advantages for large
values of <i>N</i> and/or large data sets.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are several parameterizations of the beta-binomial distribution.
This family function directly models the mean and correlation
parameter, i.e.,
the probability of success. 
The model can be written
<i>T|P=p ~ Binomial(N,p)</i>
where <i>P</i> has a beta distribution with shape parameters
<i>alpha</i> and <i>beta</i>. Here,
<i>N</i> is the number of trials (e.g., litter size),
<i>T=NY</i> is the number of successes, and
<i>p</i> is the probability of a success (e.g., a malformation).
That is, <i>Y</i> is the <em>proportion</em> of successes. Like
<code><a href="binomialff.html">binomialff</a></code>, the fitted values are the
estimated probability
of success (i.e., <i>E[Y]</i> and not <i>E[T]</i>) 
and the prior weights <i>N</i> are attached separately on the
object in a slot.
</p>
<p>The probability function is
</p>
<p style="text-align: center;"><i>
        P(T=t) = choose(N,t) B(alpha+t, beta+N-t) / B(alpha, beta)</i></p>

<p>where <i>t=0,1,&hellip;,N</i>, and <i>B</i> is the
<code><a href="../../base/html/Special.html">beta</a></code> function
with shape parameters <i>alpha</i> and <i>beta</i>.
Recall <i>Y = T/N</i> is the real response being modelled.
</p>
<p>The default model is <i>eta1 =logit(mu)</i>
and <i>eta2 = logit(rho)</i> because both
parameters lie between 0 and 1.
The mean (of <i>Y</i>) is 
<i>p = mu = alpha / (alpha + beta)</i>
and the variance (of <i>Y</i>) is 
<i>mu(1-mu)(1+(N-1)rho)/N</i>.
Here, the correlation <i>rho</i> is given by
<i>1/(1 + alpha + beta)</i>
and is the correlation between the <i>N</i> individuals
within a litter. A <em>litter effect</em> is typically reflected by a
positive value of <i>rho</i>. It is known as the
<em>over-dispersion parameter</em>.
</p>
<p>This family function uses Fisher scoring.
Elements of the second-order expected
derivatives with respect to <i>alpha</i> and 
<i>beta</i> are computed numerically, which may 
fail for large <i>alpha</i>, <i>beta</i>, 
<i>N</i> or else take a long time.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>.
</p>
<p>Suppose <code>fit</code> is a fitted beta-binomial model. Then
<code>fit@y</code> contains the sample proportions <i>y</i>,
<code>fitted(fit)</code> returns estimates of <i>E(Y)</i>, and
<code>weights(fit, type="prior")</code> returns the number
of trials <i>N</i>.
</p>


<h3>Warning </h3>

<p>If the estimated rho parameter is close to 0 then it pays to
try <code>lrho = "rhobit"</code>. One day this may become the default
link function.
</p>
<p>This family function is prone to numerical difficulties due to
the expected information matrices not being positive-definite
or ill-conditioned over some regions of the parameter space.
If problems occur try setting <code>irho</code> to some numerical
value, <code>nsimEIM = 100</code>, say, or else use <code>etastart</code>
argument of <code><a href="vglm.html">vglm</a></code>, etc.
</p>


<h3>Note</h3>

<p>This function processes the input in the same way
as <code><a href="binomialff.html">binomialff</a></code>. But it does not handle 
the case <i>N=1</i> very well because there are two
parameters to estimate, not one, for each row of the input.
Cases where <i>N=1</i> can be omitted via the 
<code>subset</code> argument of <code><a href="vglm.html">vglm</a></code>.
</p>
<p>The <em>extended</em> beta-binomial distribution of Prentice (1986)
is currently not implemented in the <span class="pkg">VGAM</span> package as it has
range-restrictions for the correlation parameter that are currently
too difficult to handle in this package.
However, try <code>lrho = "rhobit"</code>.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee </p>


<h3>References</h3>

<p>Moore, D. F. and Tsiatis, A. (1991)
Robust estimation of the variance in moment methods for
extra-binomial and extra-Poisson variation.
<em>Biometrics</em>,
<b>47</b>, 383&ndash;401.
</p>
<p>Prentice, R. L. (1986)
Binary regression using an extended beta-binomial distribution,
with discussion of correlation induced by
covariate measurement errors.
<em>Journal of the American Statistical Association</em>,
<b>81</b>, 321&ndash;327.
</p>


<h3>See Also</h3>

<p><code><a href="betabinomialff.html">betabinomialff</a></code>,
<code><a href="betabinomUC.html">Betabinom</a></code>,
<code><a href="binomialff.html">binomialff</a></code>,
<code><a href="betaff.html">betaff</a></code>,
<code><a href="dirmultinomial.html">dirmultinomial</a></code>,
<code><a href="lirat.html">lirat</a></code>,
<code><a href="simulate.vlm.html">simulate.vlm</a></code>.
</p>


<h3>Examples</h3>

<pre>
# Example 1
bdata &lt;- data.frame(N = 10, mu = 0.5, rho = 0.8)
bdata &lt;- transform(bdata,
                   y = rbetabinom(n = 100, size = N, prob = mu, rho = rho))
fit &lt;- vglm(cbind(y, N-y) ~ 1, betabinomial, data = bdata, trace = TRUE)
coef(fit, matrix = TRUE)
Coef(fit)
head(cbind(depvar(fit), weights(fit, type = "prior")))


# Example 2
fit &lt;- vglm(cbind(R, N-R) ~ 1, betabinomial, lirat,
            trace = TRUE, subset = N &gt; 1)
coef(fit, matrix = TRUE)
Coef(fit)
t(fitted(fit))
t(depvar(fit))
t(weights(fit, type = "prior"))


# Example 3, which is more complicated
lirat &lt;- transform(lirat, fgrp = factor(grp))
summary(lirat)  # Only 5 litters in group 3
fit2 &lt;- vglm(cbind(R, N-R) ~ fgrp + hb, betabinomial(zero = 2),
             data = lirat, trace = TRUE, subset = N &gt; 1)
coef(fit2, matrix = TRUE)
## Not run:  with(lirat, plot(hb[N &gt; 1], fit2@misc$rho,
                 xlab = "Hemoglobin", ylab = "Estimated rho",
                 pch = as.character(grp[N &gt; 1]), col = grp[N &gt; 1])) 
## End(Not run)
## Not run:   # cf. Figure 3 of Moore and Tsiatis (1991)
with(lirat, plot(hb, R / N, pch = as.character(grp), col = grp, las = 1,
                 xlab = "Hemoglobin level", ylab = "Proportion Dead",
                 main = "Fitted values (lines)"))
smalldf &lt;- with(lirat, lirat[N &gt; 1, ])
for (gp in 1:4) {
  xx &lt;- with(smalldf, hb[grp == gp])
  yy &lt;- with(smalldf, fitted(fit2)[grp == gp])
  ooo &lt;- order(xx)
  lines(xx[ooo], yy[ooo], col = gp)
} 
## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
