<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Positive Bernoulli Family Function with Behavioural Effects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for posbernoulli.b {VGAM}"><tr><td>posbernoulli.b {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Positive Bernoulli Family Function with Behavioural Effects </h2>

<h3>Description</h3>

<p>Fits a GLM-/GAM-like model to multiple Bernoulli responses where
each row in the capture history matrix response has at least one success
(capture).
Capture history behavioural effects are accommodated.
</p>


<h3>Usage</h3>

<pre>
posbernoulli.b(link = "logit", drop.b = FALSE ~ 1,
               type.fitted = c("likelihood.cond", "mean.uncond"), I2 = FALSE,
               ipcapture = NULL, iprecapture = NULL,
               p.small = 1e-4, no.warning = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link, drop.b, ipcapture, iprecapture</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for information about
these arguments.
By default the parallelism assumption does not apply to the intercept.
With an intercept-only model
setting <code>drop.b = TRUE ~ 1</code> results in the <i>M_0</i>/<i>M_h</i> model.
</p>







</td></tr>
<tr valign="top"><td><code>I2</code></td>
<td>

<p>Logical.
This argument is used for terms that are not parallel.
If <code>TRUE</code> then the constraint matrix <code>diag(2)</code>
(the general default constraint matrix in <span class="pkg">VGAM</span>) is used,
else <code>cbind(0:1, 1)</code>. The latter means the first element/column
corresponds to the behavioural effect.
Consequently it and its standard error etc. can be accessed
directly without subtracting two quantities.
</p>
</td></tr>
<tr valign="top"><td><code>type.fitted</code></td>
<td>

<p>Details at <code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>p.small, no.warning</code></td>
<td>

<p>See <code><a href="posbernoulli.t.html">posbernoulli.t</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This model
(commonly known as <i>M_b</i>/<i>M_{bh}</i> in the
capture&ndash;recapture literature)
operates on a capture history matrix response of 0s and 1s
(<i>n x tau</i>).
See <code><a href="posbernoulli.t.html">posbernoulli.t</a></code> for details,
e.g., common assumptions with other models.
Once an animal is captured for the first time,
it is marked/tagged so that its future
capture history can be recorded. The effect of the recapture
probability is modelled through a second linear/additive predictor.
It is well-known that some species of animals are affected by capture,
e.g., trap-shy or trap-happy. This <span class="pkg">VGAM</span> family function
<em>does</em> allow the capture history to be modelled via such
behavioural effects.
So does <code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code> but <code><a href="posbernoulli.t.html">posbernoulli.t</a></code> cannot.
</p>

<p>The number of linear/additive predictors is <i>M = 2</i>,
and the default links
are <i>(logit p_c, logit p_r)^T</i>
where <i>p_c</i> is the probability of capture and
<i>p_r</i> is the probability of recapture.
The fitted value returned is of the same dimension as
the response matrix, and depends on the capture history:
prior to being first captured, it is <code>pcapture</code>.
Afterwards, it is <code>precapture</code>.
</p>
<p>By default, the constraint matrices for the intercept term
and the other covariates are set up so that <i>p_r</i>
differs from <i>p_c</i> by a simple binary effect,
on a logit scale.
However, this difference (the behavioural effect) is more
directly estimated by having <code>I2 = FALSE</code>.
Then it allows an estimate of the trap-happy/trap-shy effect;
these are positive/negative values respectively.
If <code>I2 = FALSE</code> then
the (nonstandard) constraint matrix used is <code>cbind(0:1, 1)</code>,
meaning the first element can be interpreted as the behavioural effect.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Note</h3>

<p>The dependent variable is <em>not</em> scaled to row proportions.
This is the same as <code><a href="posbernoulli.t.html">posbernoulli.t</a></code>
and <code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code>
but different from <code><a href="posbinomial.html">posbinomial</a></code>
and <code><a href="binomialff.html">binomialff</a></code>.
</p>






<h3>Author(s)</h3>

<p> Thomas W. Yee. </p>


<h3>References</h3>

<p>See <code><a href="posbernoulli.t.html">posbernoulli.t</a></code>.
</p>


<h3>See Also</h3>

 
<p><code><a href="posbernoulli.t.html">posbernoulli.t</a></code> and
<code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code> (including estimating <i>N</i>),
<code><a href="deermice.html">deermice</a></code>,
<code><a href="posbernUC.html">dposbern</a></code>,
<code><a href="posbernUC.html">rposbern</a></code>,
<code><a href="posbinomial.html">posbinomial</a></code>,
<code><a href="auxposbernoulli.t.html">aux.posbernoulli.t</a></code>,
<code><a href="prinia.html">prinia</a></code>.
</p>




<h3>Examples</h3>

<pre>
# deermice data ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

# Fit a M_b model
M.b &lt;- vglm(cbind(y1, y2, y3, y4, y5, y6) ~ 1,
            posbernoulli.b, data = deermice, trace = TRUE)
coef(M.b)["(Intercept):1"]  # Behavioural effect on the logit scale
coef(M.b, matrix = TRUE)
constraints(M.b, matrix = TRUE)
summary(M.b, presid = FALSE)

# Fit a M_bh model
M.bh &lt;- vglm(cbind(y1, y2, y3, y4, y5, y6) ~ sex + weight,
             posbernoulli.b, data = deermice, trace = TRUE)
coef(M.bh, matrix = TRUE)
coef(M.bh)["(Intercept):1"]  # Behavioural effect on the logit scale
constraints(M.bh)  # (2,1) element of "(Intercept)" is for the behavioural effect
summary(M.bh, presid = FALSE)  # Significant positive (trap-happy) behavioural effect
# Approx. 95 percent confidence for the behavioural effect:
SE.M.bh &lt;- coef(summary(M.bh))["(Intercept):1", "Std. Error"]
coef(M.bh)["(Intercept):1"] + c(-1, 1) * 1.96 * SE.M.bh

# Fit a M_h model
M.h &lt;- vglm(cbind(y1, y2, y3, y4, y5, y6) ~ sex + weight,
            posbernoulli.b(drop.b = TRUE ~ sex + weight),
            data = deermice, trace = TRUE)
coef(M.h, matrix = TRUE)
constraints(M.h, matrix = TRUE)
summary(M.h, presid = FALSE)

# Fit a M_0 model
M.0 &lt;- vglm(cbind(    y1 + y2 + y3 + y4 + y5 + y6,
                  6 - y1 - y2 - y3 - y4 - y5 - y6) ~ 1,
            posbinomial, data = deermice, trace = TRUE)
coef(M.0, matrix = TRUE)
summary(M.0, presid = FALSE)


# Simulated data set ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
set.seed(123); nTimePts &lt;- 5; N &lt;- 1000  # N is the popn size
pdata &lt;- rposbern(n = N, nTimePts = nTimePts, pvars = 2, is.popn = TRUE)
nrow(pdata)  # Less than N (because some animals were never captured)
# The truth: xcoeffs are c(-2, 1, 2) and cap.effect = +1

M.bh.2 &lt;- vglm(cbind(y1, y2, y3, y4, y5) ~ x2,
               posbernoulli.b, data = pdata, trace = TRUE)
coef(M.bh.2)
coef(M.bh.2, matrix = TRUE)
constraints(M.bh.2, matrix = TRUE)
summary(M.bh.2, presid = FALSE)
head(depvar(M.bh.2))    # Capture history response matrix
head(M.bh.2@extra$cap.hist1)  # Info on its capture history
head(M.bh.2@extra$cap1)  # When it was first captured
head(fitted(M.bh.2))     # Depends on capture history
(trap.effect &lt;- coef(M.bh.2)["(Intercept):1"])  # Should be +1
head(model.matrix(M.bh.2, type = "vlm"), 21)
head(pdata)
summary(pdata)
dim(depvar(M.bh.2))
vcov(M.bh.2)

M.bh.2@extra$N.hat     # Estimate of the population size; should be about N
M.bh.2@extra$SE.N.hat  # SE of the estimate of the population size
# An approximate 95 percent confidence interval:
round(M.bh.2@extra$N.hat + c(-1, 1) * 1.96 *  M.bh.2@extra$SE.N.hat, 1)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
