<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calibration for CQO and CAO models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for calibrate.qrrvglm {VGAM}"><tr><td>calibrate.qrrvglm {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Calibration for CQO and CAO models </h2>

<h3>Description</h3>

<p>Performs maximum likelihood calibration for constrained and
unconstrained quadratic and additive ordination models (CQO and CAO
models are better known as QRR-VGLMs and RR-VGAMs respectively).
</p>


<h3>Usage</h3>

<pre>
calibrate.qrrvglm(object, newdata = NULL,
        type = c("latvar", "predictors", "response", "vcov", "all3or4"),
        initial.vals = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p> The fitted CQO/CAO model.
</p>
</td></tr>
<tr valign="top"><td><code>newdata</code></td>
<td>
<p> A data frame with new response data
(usually new species data).
The default is to use the original data used to fit the model;
however, the calibration may take a long time to compute
because the computations are expensive.
</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p> What type of result is to be returned.
The first are the calibrated latent variables or site scores.
This must be computed always.
The <code>"predictors"</code> are the linear/quadratic or additive
predictors evaluated at the calibrated latent variables or site
scores.
The <code>"response"</code> are the fitted means evaluated at the
calibrated latent variables or site scores.
The <code>"vcov"</code> are the estimated variance-covariance
matrices of the
calibrated latent variables or site scores.
The <code>"all3or4"</code> is for all of them, i.e., all <code>type</code>s.
For CAO models,
<code>"vcov"</code> is unavailable, so all 3 are returned.
For CQO models,
<code>"vcov"</code> is available, so all 4 are returned.
</p>
</td></tr>
<tr valign="top"><td><code>initial.vals</code></td>
<td>
<p> Initial values for the search.
For rank-1 models, this should be a vector of length
<code>nrow(newdata)</code>, and for rank 2 models
this should be a two column matrix with the number of rows equalling
the number of rows in <code>newdata</code>.
The default is a grid defined by arguments in
<code><a href="calibrate.qrrvglm.control.html">calibrate.qrrvglm.control</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>Arguments that are fed into
<code><a href="calibrate.qrrvglm.control.html">calibrate.qrrvglm.control</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a fitted regression CQO/CAO model,
maximum likelihood calibration is theoretically easy and elegant.
However, the method assumes that all species are
independent, which is not really true in practice.
More details and references are given in Yee (2012).
</p>
<p>The function <code><a href="../../stats/html/optim.html">optim</a></code> is used to search for
the maximum likelihood solution. Good initial values are
needed, and <code><a href="calibrate.qrrvglm.control.html">calibrate.qrrvglm.control</a></code>
allows the user some control over the choice of these.
</p>


<h3>Value</h3>

<p>The argument <code>type</code> determines what is returned.
If <code>type = "all3or4"</code> then all the <code>type</code> values
are returned in a list, with the following components.
Each component has length <code>nrow(newdata)</code>.
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>latvar</code></td>
<td>
<p>Calibrated latent variables or site scores.
</p>
</td></tr>
<tr valign="top"><td><code>predictors </code></td>
<td>
<p>linear/quadratic or additive predictors.
For example, for Poisson families, this will be on a log scale,
and for binomial families, this will be on a logit scale.
</p>
</td></tr>
<tr valign="top"><td><code>response</code></td>
<td>
<p>Fitted values of the response, evaluated at the
calibrated latent variables or site scores.
</p>
</td></tr>
<tr valign="top"><td><code>vcov</code></td>
<td>
<p>Estimated variance-covariance matrix of the
calibrated latent variables or site scores.  Actually,
these are stored in an array whose last dimension is
<code>nrow(newdata)</code>.
</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>This function is computationally expensive.
Setting <code>trace = TRUE</code> to get a running log is a good idea.
</p>


<h3>Note</h3>

<p>Despite the name of this function, CAO models are handled 
as well.
</p>



<h3>Author(s)</h3>

<p>T. W. Yee</p>


<h3>References</h3>

<p>Yee, T. W. (2012)
On constrained and unconstrained
quadratic ordination.
<em>Manuscript in preparation</em>.
</p>
<p>ter Braak, C. J. F. 1995.
Calibration. In:
<em>Data Analysis in Community and Landscape Ecology</em>
by Jongman, R. H. G., ter Braak, C. J. F. and
van Tongeren, O. F. R. (Eds.)
Cambridge University Press,
Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="calibrate.qrrvglm.control.html">calibrate.qrrvglm.control</a></code>,
<code><a href="calibrate.html">calibrate</a></code>,
<code><a href="cqo.html">cqo</a></code>,
<code><a href="cao.html">cao</a></code>.

</p>


<h3>Examples</h3>

<pre>
## Not run: 
hspider[,1:6] &lt;- scale(hspider[, 1:6])  # Standardize the environmental variables
set.seed(123)
p1 &lt;- cqo(cbind(Pardlugu, Pardmont, Pardnigr, Pardpull, Zoraspin) ~
          WaterCon + BareSand + FallTwig +
          CoveMoss + CoveHerb + ReflLux,
          family = poissonff, data = hspider, Rank = 1,
          I.toler = TRUE, Crow1positive = TRUE)

siteNos &lt;- 3:4  # Calibrate these sites
cp1 &lt;- calibrate(p1, new = data.frame(depvar(p1)[siteNos, ]), trace = TRUE)

## End(Not run)

## Not run: 
# Graphically compare the actual site scores with their calibrated values
persp(p1, main = "Site scores: solid=actual, dashed=calibrated",
      label = TRUE, col = "blue", las = 1)
# Actual site scores:
abline(v = latvar(p1)[siteNos], lty = 1, col = 1:length(siteNos))
abline(v = cp1, lty = 2, col = 1:length(siteNos))  # Calibrated values

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
