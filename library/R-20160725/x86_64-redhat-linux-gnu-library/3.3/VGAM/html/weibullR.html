<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Weibull Distribution Family Function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for weibullR {VGAM}"><tr><td>weibullR {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Weibull Distribution Family Function </h2>

<h3>Description</h3>

<p>Maximum likelihood estimation of the 2-parameter Weibull distribution.
No observations should be censored.
</p>


<h3>Usage</h3>

<pre>
weibullR(lscale = "loge", lshape = "loge",
         iscale = NULL,   ishape = NULL, lss = TRUE, nrfs = 1,
         probs.y = c(0.2, 0.5, 0.8), imethod = 1, zero = "shape")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lshape, lscale</code></td>
<td>

<p>Parameter link functions applied to the 
(positive) shape parameter (called <i>a</i> below) and
(positive) scale parameter (called <i>b</i> below).
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>ishape, iscale</code></td>
<td>

<p>Optional initial values for the shape and scale parameters.
</p>
</td></tr>
<tr valign="top"><td><code>nrfs</code></td>
<td>

<p>Currently this argument is ignored.
Numeric, of length one, with value in <i>[0,1]</i>.
Weighting factor between Newton-Raphson and Fisher scoring.
The value 0 means pure Newton-Raphson, while 1 means pure Fisher scoring.
The default value uses a mixture of the two algorithms, and retaining
positive-definite working weights.
</p>
</td></tr>
<tr valign="top"><td><code>imethod</code></td>
<td>

<p>Initialization method used if there are censored observations.
Currently only the values 1 and 2 are allowed.
</p>
</td></tr>
<tr valign="top"><td><code>zero, probs.y, lss</code></td>
<td>

<p>Details at <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Weibull density for a response <i>Y</i> is 
</p>
<p style="text-align: center;"><i>
        f(y;a,b) = a y^(a-1) * exp(-(y/b)^a) / [b^a]</i></p>

<p>for <i>a &gt; 0</i>, <i>b &gt; 0</i>, <i>y &gt; 0</i>.
The cumulative distribution function is 
</p>
<p style="text-align: center;"><i>
        F(y;a,b) = 1 - exp(-(y/b)^a).</i></p>

<p>The mean of <i>Y</i> is <i>b * gamma(1+ 1/a)</i>
(returned as the fitted values),
and the mode is at <i>b * (1- 1/a)^(1/a)</i> when
<i>a&gt;1</i>.
The density is unbounded for <i>a&lt;1</i>.
The <i>k</i>th moment about the origin is
<i>E(Y^k) = b^k * gamma(1+ k/a)</i>.
The hazard function is <i>a * t^(a-1) / b^a</i>.
</p>
<p>This <span class="pkg">VGAM</span> family function currently does not handle 
censored data.
Fisher scoring is used to estimate the two parameters.
Although the expected information matrices used here are valid
in all regions of the parameter space,
the regularity conditions for maximum
likelihood estimation are satisfied only if <i>a&gt;2</i>
(according to Kleiber and Kotz (2003)).
If this is violated then a warning message is issued.
One can enforce <i>a&gt;2</i> by
choosing <code>lshape = logoff(offset = -2)</code>.
Common values of the shape parameter lie between 0.5 and 3.5.
</p>
<p>Summarized in Harper et al. (2011),
for inference, there are 4 cases to consider.
If <i>a &le; 1</i> then the MLEs are not consistent
(and the smallest observation becomes a hyperefficient
solution for the location parameter in the 3-parameter case).
If <i>1 &lt; a &lt; 2</i> then MLEs exist but are not asymptotically normal.
If <i>a = 2</i> then the MLEs exist and are normal and asymptotically
efficient but with a slower convergence rate than when <i>a &gt; 2</i>.
If <i>a &gt; 2</i> then MLEs have classical asymptotic properties.
</p>
<p>The 3-parameter (location is the third parameter) Weibull can
be estimated by maximizing a profile log-likelihood (see,
e.g., Harper et al. (2011) and Lawless (2003)), else try
<code><a href="gev.html">gev</a></code> which is a better parameterization.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Warning</h3>

<p>This function is under development to handle other censoring situations.
The version of this function which will handle censored data will be
called <code>cenweibull()</code>. It is currently being written and will use
<code><a href="SurvS4.html">SurvS4</a></code> as input. 
It should be released in later versions of <span class="pkg">VGAM</span>.
</p>
<p>If the shape parameter is less than two then misleading inference may
result, e.g., in the <code>summary</code> and <code>vcov</code> of the object.
</p>


<h3>Note</h3>

<p>Successful convergence depends on having reasonably good initial
values. If the initial values chosen by this function are not good,
make use the two initial value arguments.
</p>
<p>This <span class="pkg">VGAM</span> family function handles multiple responses.
</p>
<p>The Weibull distribution is often an alternative to the lognormal
distribution. The inverse Weibull distribution, which is that of
<i>1/Y</i> where <i>Y</i> has a Weibull(<i>a,b</i>) distribution, is
known as the log-Gompertz distribution.
</p>
<p>There are problems implementing the three-parameter Weibull
distribution. These are because
the classical regularity conditions for the
asymptotic properties of the MLEs are not satisfied because the
support of the distribution depends on one of the parameters.
</p>
<p>Other related distributions are the Maxwell and Rayleigh
distributions.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee </p>


<h3>References</h3>

<p>Kleiber, C. and Kotz, S. (2003)
<em>Statistical Size Distributions in Economics and Actuarial Sciences</em>,
Hoboken, NJ, USA: Wiley-Interscience.
</p>
<p>Johnson, N. L. and Kotz, S. and Balakrishnan, N. (1994)
<em>Continuous Univariate Distributions</em>,
2nd edition, Volume 1, New York: Wiley.
</p>
<p>Lawless, J. F. (2003)
<em>Statistical Models and Methods for Lifetime Data</em>,
2nd ed.
Hoboken, NJ, USA: John Wiley &amp; Sons.
</p>
<p>Rinne, Horst. (2009)
<em>The Weibull Distribution: A Handbook</em>.
Boca Raton, FL, USA: CRC Press.
</p>
<p>Gupta, R. D. and Kundu, D. (2006)
On the comparison of Fisher information of the
Weibull and GE distributions,
<em>Journal of Statistical Planning and Inference</em>,
<b>136</b>,
3130&ndash;3144.
</p>
<p>Harper, W. V. and Eschenbach, T. G. and James, T. R. (2011)
Concerns about Maximum Likelihood Estimation for
the Three-Parameter Weibull Distribution:
Case Study of Statistical Software,
<em>The American Statistician</em>,
<b>65(1)</b>,
44&ndash;54.
</p>
<p>Smith, R. L. (1985)
Maximum likelihood estimation in a class of nonregular cases.
<em>Biometrika</em>, <b>72</b>, 67&ndash;90.
</p>
<p>Smith, R. L. and Naylor, J. C. (1987)
A comparison of maximum likelihood and Bayesian estimators
for the three-parameter Weibull distribution.
<em>Applied Statistics</em>, <b>36</b>, 358&ndash;369.
</p>


<h3>See Also</h3>

<p><code><a href="weibull.mean.html">weibull.mean</a></code>,
<code><a href="../../stats/html/Weibull.html">dweibull</a></code>,
<code><a href="truncweibull.html">truncweibull</a></code>,
<code><a href="gev.html">gev</a></code>,
<code><a href="lognormal.html">lognormal</a></code>,
<code><a href="expexpff.html">expexpff</a></code>,
<code><a href="maxwell.html">maxwell</a></code>,
<code><a href="rayleigh.html">rayleigh</a></code>,
<code><a href="gumbelII.html">gumbelII</a></code>.
</p>


<h3>Examples</h3>

<pre>
wdata &lt;- data.frame(x2 = runif(nn &lt;- 1000))  # Complete data
wdata &lt;- transform(wdata,
            y1 = rweibull(nn, shape = exp(1), scale = exp(-2 + x2)),
            y2 = rweibull(nn, shape = exp(2), scale = exp( 1 - x2)))
fit &lt;- vglm(cbind(y1, y2) ~ x2, weibullR, data = wdata, trace = TRUE)
coef(fit, matrix = TRUE)
vcov(fit)
summary(fit)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
