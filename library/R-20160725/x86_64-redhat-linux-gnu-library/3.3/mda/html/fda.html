<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Flexible Discriminant Analysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for fda {mda}"><tr><td>fda {mda}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Flexible Discriminant Analysis</h2>

<h3>Description</h3>

<p>Flexible discriminant analysis.</p>


<h3>Usage</h3>

<pre>
fda(formula, data, weights, theta, dimension, eps, method,
    keep.fitted, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p>of the form <code>y~x</code> it describes the response and
the predictors.  The formula can be more complicated, such as
<code>y~log(x)+z</code> etc (see <code><a href="../../stats/html/formula.html">formula</a></code> for more details).
The response should be a factor representing the response variable,
or any vector that can be coerced to such (such as a logical
variable).</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>data frame containing the variables in the formula
(optional).</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>an optional vector of observation weights.</p>
</td></tr>
<tr valign="top"><td><code>theta</code></td>
<td>
<p>an optional matrix of class scores, typically with less
than <code>J-1</code> columns.</p>
</td></tr>
<tr valign="top"><td><code>dimension</code></td>
<td>
<p>The dimension of the solution, no greater than
<code>J-1</code>, where <code>J</code> is the number classes.  Default is
<code>J-1</code>.</p>
</td></tr>
<tr valign="top"><td><code>eps</code></td>
<td>
<p>a threshold for small singular values for excluding
discriminant variables; default is <code>.Machine$double.eps</code>.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>regression method used in optimal scaling.  Default is
linear regression via the function <code>polyreg</code>, resulting in
linear discriminant analysis.  Other possibilities are <code>mars</code>
and <code>bruto</code>.  For Penalized Discriminant analysis
<code>gen.ridge</code> is appropriate.</p>
</td></tr>
<tr valign="top"><td><code>keep.fitted</code></td>
<td>
<p>a logical variable, which determines whether the
(sometimes large) component <code>"fitted.values"</code> of the <code>fit</code>
component of the returned fda object should be kept.  The default is
<code>TRUE</code> if <code>n * dimension &lt; 5000</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional arguments to <code>method</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>"fda"</code>.  Use <code>predict</code> to extract
discriminant variables, posterior probabilities or predicted class
memberships.  Other extractor functions are <code>coef</code>,
<code>confusion</code> and <code>plot</code>.
</p>
<p>The object has the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>percent.explained</code></td>
<td>
<p>the percent between-group variance explained
by each dimension (relative to the total explained.)</p>
</td></tr>
<tr valign="top"><td><code>values</code></td>
<td>
<p>optimal scaling regression sum-of-squares for each
dimension (see reference).  The usual discriminant analysis
eigenvalues are given by <code>values / (1-values)</code>, which are used
to define <code>percent.explained</code>.</p>
</td></tr>
<tr valign="top"><td><code>means</code></td>
<td>
<p>class means in the discriminant space.  These are also
scaled versions of the final theta's or class scores, and can be
used in a subsequent call to <code>fda</code> (this only makes sense if
some columns of theta are omitted&mdash;see the references).</p>
</td></tr> 
<tr valign="top"><td><code>theta.mod</code></td>
<td>
<p>(internal) a class scoring matrix which allows
<code>predict</code> to work properly.</p>
</td></tr>
<tr valign="top"><td><code>dimension</code></td>
<td>
<p>dimension of discriminant space.</p>
</td></tr>
<tr valign="top"><td><code>prior</code></td>
<td>
<p>class proportions for the training data.</p>
</td></tr>
<tr valign="top"><td><code>fit</code></td>
<td>
<p>fit object returned by <code>method</code>.</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
<p>the call that created this object (allowing it to be
<code>update</code>-able)</p>
</td></tr>
<tr valign="top"><td><code>confusion</code></td>
<td>
<p>confusion matrix when classifying the training data.</p>
</td></tr>
</table>
<p>The <code>method</code> functions are required to take arguments <code>x</code>
and <code>y</code> where both can be matrices, and should produce a matrix
of <code>fitted.values</code> the same size as <code>y</code>.  They can take
additional arguments <code>weights</code> and should all have a <code>...</code>
for safety sake.  Any arguments to <code>method</code> can be passed on via
the <code>...</code> argument of <code>fda</code>.  The default method
<code><a href="polyreg.html">polyreg</a></code> has a <code>degree</code> argument which allows
polynomial regression of the required total degree.  See the
documentation for <code><a href="predict.fda.html">predict.fda</a></code> for further requirements
of <code>method</code>. The package <code>earth</code> is suggested for this
package as well; <code>earth</code> is a more detailed implementation of
the mars model, and works as a <code>method</code> argument.
</p>


<h3>Author(s)</h3>

<p>Trevor Hastie and Robert Tibshirani
</p>


<h3>References</h3>

<p>&ldquo;Flexible Disriminant Analysis by Optimal Scoring&rdquo;  by Hastie,
Tibshirani and Buja, 1994, JASA, 1255-1270.
</p>
<p>&ldquo;Penalized Discriminant Analysis&rdquo; by Hastie, Buja and Tibshirani, 1995,
Annals of Statistics, 73-102.
</p>
<p>&ldquo;Elements of Statisical Learning - Data Mining, Inference and
Prediction&rdquo; (2nd edition, Chapter 12) by Hastie, Tibshirani and
Friedman, 2009, Springer
</p>


<h3>See Also</h3>

<p><code><a href="predict.fda.html">predict.fda</a></code>,
<code><a href="plot.fda.html">plot.fda</a></code>,
<code><a href="mars.html">mars</a></code>,
<code><a href="bruto.html">bruto</a></code>,
<code><a href="polyreg.html">polyreg</a></code>,
<code><a href="softmax.html">softmax</a></code>,
<code><a href="confusion.html">confusion</a></code>,

</p>


<h3>Examples</h3>

<pre>
data(iris)
irisfit &lt;- fda(Species ~ ., data = iris)
irisfit
## fda(formula = Species ~ ., data = iris)
##
## Dimension: 2 
##
## Percent Between-Group Variance Explained:
##     v1     v2 
##  99.12 100.00 
##
## Degrees of Freedom (per dimension): 5 
##
## Training Misclassification Error: 0.02 ( N = 150 )

confusion(irisfit, iris)
##            Setosa Versicolor Virginica 
##     Setosa     50          0         0
## Versicolor      0         48         1
##  Virginica      0          2        49
## attr(, "error"):
## [1] 0.02

plot(irisfit)

coef(irisfit)
##           [,1]        [,2]
## [1,] -2.126479 -6.72910343
## [2,] -0.837798  0.02434685
## [3,] -1.550052  2.18649663
## [4,]  2.223560 -0.94138258
## [5,]  2.838994  2.86801283

marsfit &lt;- fda(Species ~ ., data = iris, method = mars)
marsfit2 &lt;- update(marsfit, degree = 2)
marsfit3 &lt;- update(marsfit, theta = marsfit$means[, 1:2]) 
## this refits the model, using the fitted means (scaled theta's)
## from marsfit to start the iterations
</pre>

<hr /><div style="text-align: center;">[Package <em>mda</em> version 0.4-9 <a href="00Index.html">Index</a>]</div>
</body></html>
