<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Simple Procruste Rotation between two sets of points</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for procuste {ade4}"><tr><td>procuste {ade4}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Simple Procruste Rotation between two sets of points</h2>

<h3>Description</h3>

<p>performs a simple procruste rotation between two sets of points. 
</p>


<h3>Usage</h3>

<pre>
procuste(dfX, dfY, scale = TRUE, nf = 4, tol = 1e-07) 
## S3 method for class 'procuste'
plot(x, xax = 1, yax = 2, ...)
## S3 method for class 'procuste'
print(x, ...)
## S3 method for class 'procuste'
randtest(xtest, nrepet = 999, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>dfX, dfY</code></td>
<td>
<p>two data frames with the same rows</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>a logical value indicating whether a transformation by the Gower's scaling (1971) should be applied</p>
</td></tr>
<tr valign="top"><td><code>nf</code></td>
<td>
<p>an integer indicating the number of kept axes</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>a tolerance threshold to test whether the distance matrix is Euclidean : an eigenvalue is considered positive if it is larger than <code>-tol*lambda1</code> where <code>lambda1</code> is the largest eigenvalue.</p>
</td></tr>
</table>
<p><br />
</p>
<table summary="R argblock">
<tr valign="top"><td><code>x, xtest</code></td>
<td>
<p>an objet of class <code>procuste</code></p>
</td></tr>
<tr valign="top"><td><code>xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td></tr>
<tr valign="top"><td><code>yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td></tr>
<tr valign="top"><td><code>nrepet</code></td>
<td>
<p>the number of repetitions to perform the randomization test</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a list of the class <code>procuste</code> with 9 components 
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>d</code></td>
<td>
<p>a numeric vector of the singular values</p>
</td></tr>
<tr valign="top"><td><code>rank</code></td>
<td>
<p>an integer indicating the rank of the crossed matrix</p>
</td></tr>
<tr valign="top"><td><code>nf</code></td>
<td>
<p>an integer indicating the number of kept axes</p>
</td></tr>
<tr valign="top"><td><code>tabX</code></td>
<td>
<p>a data frame with the array X, possibly scaled</p>
</td></tr>
<tr valign="top"><td><code>tabY</code></td>
<td>
<p>a data frame with the array Y, possibly scaled</p>
</td></tr>
<tr valign="top"><td><code>rotX</code></td>
<td>
<p>a data frame with the result of the rotation from array X to array Y</p>
</td></tr>
<tr valign="top"><td><code>rotY</code></td>
<td>
<p>a data frame with the result of the rotation from array Y to array X</p>
</td></tr>
<tr valign="top"><td><code>loadX</code></td>
<td>
<p>a data frame with the loadings of array X</p>
</td></tr>
<tr valign="top"><td><code>loadY</code></td>
<td>
<p>a data frame with the loadings of array Y</p>
</td></tr>
<tr valign="top"><td><code>scorX</code></td>
<td>
<p>a data frame with the scores of array X</p>
</td></tr>
<tr valign="top"><td><code>scorY</code></td>
<td>
<p>a data frame with the scores of array Y</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
<p>a call order of the analysis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Chessel <br />
Anne B Dufour <a href="mailto:anne-beatrice.dufour@univ-lyon1.fr">anne-beatrice.dufour@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Digby, P. G. N. and Kempton, R. A. (1987) Multivariate Analysis of Ecological Communities. <em>Population and Community Biology Series</em>, Chapman and Hall, London.<br /><br />
Gower, J.C. (1971) Statistical methods of comparing different multivariate analyses of the same data. In <em>Mathematics in the archaeological and historical sciences</em>, Hodson, F.R, Kendall, D.G. &amp; Tautu, P. (Eds.) University Press, Edinburgh,  138&ndash;149.<br /><br />
Schönemann, P.H. (1968) On two-sided Procustes problems. <em>Psychometrika</em>, <b>33</b>, 19&ndash;34.<br /><br />
Torre, F. and Chessel, D. (1994) Co-structure de deux tableaux totalement appariés. <em>Revue de Statistique Appliquée</em>, <b>43</b>, 109&ndash;121.<br /><br />
Dray, S., Chessel, D. and Thioulouse, J.  (2003) Procustean co-inertia analysis for the linking of multivariate datasets. <em>Ecoscience</em>, <b>10</b>, 1, 110-119.
</p>


<h3>Examples</h3>

<pre>
data(macaca)
pro1 &lt;- procuste(macaca$xy1, macaca$xy2, scal = FALSE)
pro2 &lt;- procuste(macaca$xy1, macaca$xy2)
if(adegraphicsLoaded()) {
  g1 &lt;- s.match(pro1$tabX, pro1$rotY, plab.cex = 0.7, plot = F)
  g2 &lt;- s.match(pro1$tabY, pro1$rotX, plab.cex = 0.7, plot = F)
  g3 &lt;- s.match(pro2$tabX, pro2$rotY, plab.cex = 0.7, plot = F)
  g4 &lt;- s.match(pro2$tabY, pro2$rotX, plab.cex = 0.7, plot = F)
  G &lt;- ADEgS(list(g1, g2, g3, g4), layout = c(2, 2))
} else {
  par(mfrow = c(2, 2))
  s.match(pro1$tabX, pro1$rotY, clab = 0.7)
  s.match(pro1$tabY, pro1$rotX, clab = 0.7)
  s.match(pro2$tabX, pro2$rotY, clab = 0.7)
  s.match(pro2$tabY, pro2$rotX, clab = 0.7)
  par(mfrow = c(1,1))
}

data(doubs)
pca1 &lt;- dudi.pca(doubs$env, scal = TRUE, scann = FALSE)
pca2 &lt;- dudi.pca(doubs$fish, scal = FALSE, scann = FALSE)
pro3 &lt;- procuste(pca1$tab, pca2$tab, nf = 2)
if(adegraphicsLoaded()) {
  g11 &lt;- s.traject(pro3$scorX, plab.cex = 0, plot = F)
  g12 &lt;- s.label(pro3$scorX, plab.cex = 0.8, plot = F)
  g1 &lt;- superpose(g11, g12)
  g21 &lt;- s.traject(pro3$scorY, plab.cex = 0, plot = F)
  g22 &lt;- s.label(pro3$scorY, plab.cex = 0.8, plot = F)
  g2 &lt;- superpose(g21, g22)
  g3 &lt;- s.arrow(pro3$loadX, plab.cex = 0.75, plot = F)
  g4 &lt;- s.arrow(pro3$loadY, plab.cex = 0.75, plot = F)
  G &lt;- ADEgS(list(g1, g2, g3, g4), layout = c(2, 2))

} else {
  par(mfrow = c(2, 2))
  s.traject(pro3$scorX, clab = 0)
  s.label(pro3$scorX, clab = 0.8, add.p = TRUE)
  s.traject(pro3$scorY, clab = 0)
  s.label(pro3$scorY, clab = 0.8, add.p = TRUE)
  s.arrow(pro3$loadX, clab = 0.75)
  s.arrow(pro3$loadY, clab = 0.75)
  par(mfrow = c(1, 1))
}

plot(pro3)
randtest(pro3)

data(fruits)
plot(procuste(scalewt(fruits$jug), scalewt(fruits$var)))
</pre>

<hr /><div style="text-align: center;">[Package <em>ade4</em> version 1.7-4 <a href="00Index.html">Index</a>]</div>
</body></html>
