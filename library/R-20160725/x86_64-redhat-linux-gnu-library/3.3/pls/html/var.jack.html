<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Jackknife Variance Estimates of Regression Coefficients</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for var.jack {pls}"><tr><td>var.jack {pls}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Jackknife Variance Estimates of Regression Coefficients</h2>

<h3>Description</h3>

<p>Calculates jackknife variance or covariance estimates of regression
coefficients.
</p>


<h3>Usage</h3>

<pre>
var.jack(object, ncomp = object$ncomp, covariance = FALSE, use.mean = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an <code>mvr</code> object.  A cross-validated model fitted
with <code>jackknife = TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>ncomp</code></td>
<td>
<p>the number of components to use for estimating the (co)variances</p>
</td></tr>
<tr valign="top"><td><code>covariance</code></td>
<td>
<p>logical.  If <code>TRUE</code>, covariances are
calculated; otherwise only variances.  The default is <code>FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>use.mean</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), the mean
coefficients are used when estimating the (co)variances; otherwise
the coefficients from a model fitted to the entire data set.  See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The original (Tukey) jackknife variance estimator is defined as
<i>(g-1)/g &sum;_{i=1}^g(\tilde&beta;_{-i} - \bar&beta;)^2</i>, where
<i>g</i> is the number of segments, <i>\tilde&beta;_{-i}</i> is the
estimated coefficient when segment <i>i</i> is left out (called the
jackknife replicates), and
<i>\bar&beta;</i> is the mean of the <i>\tilde&beta;_{-i}</i>.  The most
common case is delete-one jackknife, with <i>g = n</i>, the number of
observations.  
</p>
<p>This is the definition <code>var.jack</code> uses by default.
</p>
<p>However, Martens and Martens (2000) defined the estimator as
<i>(g-1)/g &sum;_{i=1}^g(\tilde&beta;_{-i} - \hat&beta;)^2</i>, where
<i>\hat&beta;</i> is the coefficient estimate using the entire data set.
I.e., they use the original fitted coefficients instead of the
mean of the jackknife replicates.  Most (all?) other jackknife
implementations for PLSR use this estimator.  <code>var.jack</code> can be
made to use this definition with <code>use.mean = FALSE</code>.  In
practice, the difference should be small if the number of
observations is sufficiently large.  Note, however, that all
theoretical results about the jackknife refer to the &lsquo;proper&rsquo;
definition.  (Also note that this option might disappear in a future
version.)
</p>


<h3>Value</h3>

<p>If <code>covariance</code> is <code>FALSE</code>, an <i>p\times q \times c</i>
array of variance estimates, where <i>p</i> is the number of
predictors, <i>q</i> is the number of responses, and <i>c</i> is the
number of components.
</p>
<p>If <code>covariance</code> id <code>TRUE</code>, an <i>pq\times pq \times c</i>
array of variance-covariance estimates.
</p>


<h3>Warning</h3>

<p>Note that the Tukey jackknife variance estimator is not unbiased for
the variance of regression coefficients (Hinkley 1977).
The bias depends on the <i>X</i> matrix.  For ordinary least squares
regression (OLSR), the bias can be calculated, and depends
on the number of observations <i>n</i> and the number of parameters
<i>k</i> in the mode.  For the common case of an orthogonal design
matrix with <i>±1</i> levels, the delete-one jackknife estimate
equals <i>(n-1)/(n-k)</i> times the classical variance estimate for the
regression coefficients in OLSR.  Similar expressions hold for
delete-d estimates.  Modifications have been proposed to reduce or
eliminate the bias for the OLSR case, however, they depend on the
number of parameters used in the model.  See e.g. Hinkley (1977) or Wu
(1986).
</p>
<p>Thus, the results of <code>var.jack</code> should be used with caution.
</p>


<h3>Author(s)</h3>

<p>Bjørn-Helge Mevik</p>


<h3>References</h3>

<p>Tukey J.W. (1958) Bias and Confidence in Not-quite Large
Samples. (Abstract of Preliminary Report).  <em>Annals of
Mathematical Statistics</em>, <b>29</b>(2), 614.
</p>
<p>Martens H. and Martens M. (2000) Modified Jack-knife Estimation of
Parameter Uncertainty in Bilinear Modelling by Partial Least Squares
Regression (PLSR).  <em>Food Quality and Preference</em>, <b>11</b>, 5&ndash;16.
</p>
<p>Hinkley D.V. (1977), Jackknifing in Unbalanced Situations.
<em>Technometrics</em>, <b>19</b>(3), 285&ndash;292.
</p>
<p>Wu C.F.J. (1986) Jackknife, Bootstrap and Other Resampling Methods in
Regression Analysis.  <em>Te Annals of Statistics</em>, <b>14</b>(4),
1261&ndash;1295.
</p>


<h3>See Also</h3>

<p><code><a href="mvrCv.html">mvrCv</a></code>, <code><a href="jack.test.html">jack.test</a></code></p>


<h3>Examples</h3>

<pre>
data(oliveoil)
mod &lt;- pcr(sensory ~ chemical, data = oliveoil, validation = "LOO",
           jackknife = TRUE)
var.jack(mod, ncomp = 2)
</pre>

<hr /><div style="text-align: center;">[Package <em>pls</em> version 2.5-0 <a href="00Index.html">Index</a>]</div>
</body></html>
