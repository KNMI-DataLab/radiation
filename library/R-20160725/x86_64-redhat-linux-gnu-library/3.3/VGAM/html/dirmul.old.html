<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fitting a Dirichlet-Multinomial Distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for dirmul.old {VGAM}"><tr><td>dirmul.old {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fitting a Dirichlet-Multinomial Distribution </h2>

<h3>Description</h3>

<p>Fits a Dirichlet-multinomial distribution to a matrix of 
non-negative integers.
</p>


<h3>Usage</h3>

<pre>
dirmul.old(link = "loge", ialpha = 0.01, parallel = FALSE, zero = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link</code></td>
<td>

<p>Link function applied to each of the <i>M</i> (positive)
shape parameters <i>alpha_j</i> for <i>j=1,&hellip;,M</i>. 
See <code><a href="Links.html">Links</a></code> for more choices.
Here, <i>M</i> is the number of columns of the response matrix.
</p>
</td></tr>
<tr valign="top"><td><code>ialpha</code></td>
<td>

<p>Numeric vector. Initial values for the 
<code>alpha</code> vector. Must be positive.
Recycled to length <i>M</i>.
</p>
</td></tr>
<tr valign="top"><td><code>parallel</code></td>
<td>

<p>A logical, or formula specifying which terms have equal/unequal
coefficients.
</p>
</td></tr>
<tr valign="top"><td><code>zero</code></td>
<td>

<p>An integer-valued vector specifying which linear/additive predictors
are modelled as intercepts only.  The values must be from the set
{1,2,...,<i>M</i>}.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Dirichlet-multinomial distribution, which is somewhat similar to a
Dirichlet distribution, has probability function
</p>
<p style="text-align: center;"><i>
        P(Y_1=y_1,&hellip;,Y_M=y_M) = C_{y_1,&hellip;,y_M}^{2y_{*}}
         Gamma(alpha_+) / Gamma( 2y_* + alpha_+)
         prod_{j=1}^M [ Gamma( y_j+ alpha_j) / Gamma( alpha_j)]</i></p>

<p>for <i>alpha_j  &gt; 0</i>,
<i>alpha_+ = alpha_1 + \cdots + alpha_M</i>,
and <i>2y_* = y_1 + \cdots + y_M</i>.
Here, <i>C_b^a</i> means &ldquo;<i>a</i> choose <i>b</i>&rdquo; and
refers to combinations (see <code><a href="../../base/html/choose.html">choose</a></code>).
The (posterior) mean is
</p>
<p style="text-align: center;"><i>
        E(Y_j) = (y_j +  alpha_j) / (2y_{*} +  alpha_+)</i></p>

<p>for <i>j=1,&hellip;,M</i>, and these are returned as
the fitted values as a <i>M</i>-column matrix.
</p>






<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
<code><a href="rrvglm.html">rrvglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Note</h3>

<p>The response should be a matrix of non-negative values.
Convergence seems to slow down if there are zero values.
Currently, initial values can be improved upon.
</p>
<p>This function is almost defunct and may be withdrawn soon.
Use <code><a href="dirmultinomial.html">dirmultinomial</a></code> instead.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Lange, K. (2002)
<em>Mathematical and Statistical Methods for Genetic Analysis</em>,
2nd ed.  New York: Springer-Verlag.
</p>
<p>Forbes, C., Evans, M., Hastings, N. and Peacock, B. (2011)
<em>Statistical Distributions</em>,
Hoboken, NJ, USA: John Wiley and Sons, Fourth edition.
</p>
<p>Paul, S. R., Balasooriya, U. and Banerjee, T. (2005)
Fisher information matrix of the Dirichlet-multinomial distribution.
<em>Biometrical Journal</em>, <b>47</b>, 230&ndash;236.
</p>
<p>Tvedebrink, T. (2010)
Overdispersion in allelic counts and <i>&theta;</i>-correction in forensic genetics.
<em>Theoretical Population Biology</em>, <b>78</b>, 200&ndash;210.
</p>





<h3>See Also</h3>

<p><code><a href="dirmultinomial.html">dirmultinomial</a></code>,
<code><a href="dirichlet.html">dirichlet</a></code>,
<code><a href="betabinomialff.html">betabinomialff</a></code>,
<code><a href="multinomial.html">multinomial</a></code>.
</p>


<h3>Examples</h3>

<pre>
# Data from p.50 of Lange (2002)
alleleCounts &lt;- c(2, 84, 59, 41, 53, 131, 2, 0,
       0, 50, 137, 78, 54, 51, 0, 0,
       0, 80, 128, 26, 55, 95, 0, 0,
       0, 16, 40, 8, 68, 14, 7, 1)
dim(alleleCounts) &lt;- c(8, 4)
alleleCounts &lt;- data.frame(t(alleleCounts))
dimnames(alleleCounts) &lt;- list(c("White","Black","Chicano","Asian"),
                    paste("Allele", 5:12, sep = ""))

set.seed(123)  # @initialize uses random numbers
fit &lt;- vglm(cbind(Allele5,Allele6,Allele7,Allele8,Allele9,
                  Allele10,Allele11,Allele12) ~ 1, dirmul.old,
             trace = TRUE, crit = "c", data = alleleCounts)

(sfit &lt;- summary(fit))
vcov(sfit)
round(eta2theta(coef(fit), fit@misc$link, fit@misc$earg), digits = 2)  # not preferred
round(Coef(fit), digits = 2)  # preferred
round(t(fitted(fit)), digits = 4)  # 2nd row of Table 3.5 of Lange (2002)
coef(fit, matrix = TRUE)


pfit &lt;- vglm(cbind(Allele5,Allele6,Allele7,Allele8,Allele9,
                   Allele10,Allele11,Allele12) ~ 1,
             dirmul.old(parallel = TRUE), trace = TRUE,
             data = alleleCounts)
round(eta2theta(coef(pfit, matrix = TRUE), pfit@misc$link,
                pfit@misc$earg), digits = 2)  # 'Right' answer
round(Coef(pfit), digits = 2)  # 'Wrong' answer due to parallelism constraint
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
