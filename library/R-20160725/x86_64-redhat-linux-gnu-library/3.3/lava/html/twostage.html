<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Two-stage estimator (non-linear SEM)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for twostage {lava}"><tr><td>twostage {lava}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Two-stage estimator (non-linear SEM)</h2>

<h3>Description</h3>

<p>Two-stage estimator for non-linear structural equation models
</p>


<h3>Usage</h3>

<pre>
twostage(model1, model2, data = parent.frame(), predictfun = function(mu,
  var, data, ...) cbind(u1 = mu[, 1], u2 = mu[, 1]^2 + var[1]), id1, id2,
  all = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>model1</code></td>
<td>
<p>Stage 1 measurement model</p>
</td></tr>
<tr valign="top"><td><code>model2</code></td>
<td>
<p>Stage 2 SEM</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr valign="top"><td><code>predictfun</code></td>
<td>
<p>Prediction of latent variable</p>
</td></tr>
<tr valign="top"><td><code>id1</code></td>
<td>
<p>Optional id-variable (stage 1 model)</p>
</td></tr>
<tr valign="top"><td><code>id2</code></td>
<td>
<p>Optional id-variable (stage 2 model)</p>
</td></tr>
<tr valign="top"><td><code>all</code></td>
<td>
<p>If TRUE return additional output (naive estimates)</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments to lower level functions</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre>
m &lt;- lvm(c(x1,x2,x3)~f1,f1~z,
         c(y1,y2,y3)~f2,f2~f1+z)
latent(m) &lt;- ~f1+f2
d &lt;- simulate(m,100,p=c("f2,f2"=2,"f1,f1"=0.5),seed=1)

## Full MLE
ee &lt;- estimate(m,d)

## Manual two-stage
## Not run: 
m1 &lt;- lvm(c(x1,x2,x3)~f1,f1~z); latent(m1) &lt;- ~f1
e1 &lt;- estimate(m1,d)
pp1 &lt;- predict(e1,f1~x1+x2+x3)

d$u1 &lt;- pp1[,]
d$u2 &lt;- pp1[,]^2+attr(pp1,"cond.var")
m2 &lt;- lvm(c(y1,y2,y3)~eta,c(y1,eta)~u1+u2+z); latent(m2) &lt;- ~eta
e2 &lt;- estimate(m2,d)

## End(Not run)

## Two-stage
m1 &lt;- lvm(c(x1,x2,x3)~f1,f1~z); latent(m1) &lt;- ~f1
m2 &lt;- lvm(c(y1,y2,y3)~eta,c(y1,eta)~u1+u2+z); latent(m2) &lt;- ~eta
pred &lt;- function(mu,var,data,...)
    cbind("u1"=mu[,1],"u2"=mu[,1]^2+var[1])
(mm &lt;- twostage(m1,m2,data=d,predictfun=pred))

if (interactive()) {
    pf &lt;- function(p) p["eta"]+p["eta~u1"]*u + p["eta~u2"]*u^2
    plot(mm,f=pf,data=data.frame(u=seq(-2,2,length.out=100)),lwd=2)
}
</pre>

<hr /><div style="text-align: center;">[Package <em>lava</em> version 1.4.4 <a href="00Index.html">Index</a>]</div>
</body></html>
