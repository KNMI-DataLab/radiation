<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: subtract marginal (spatial and temporal) means from...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for stInteraction {spacetime}"><tr><td>stInteraction {spacetime}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> subtract marginal (spatial and temporal) means from observations </h2>

<h3>Description</h3>

<p>subtract marginal (spatial and temporal) means from observations </p>


<h3>Usage</h3>

<pre> 
stInteraction(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p> object of class <code>STFDF</code></p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p> arguments passed to <a href="../../Matrix/html/colSums.html">rowMeans</a>, <a href="../../Matrix/html/colSums.html">colMeans</a> and <a href="../../base/html/mean.html">mean</a>, such as <code>na.rm=TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <a href="STFDF-class.html">STFDF</a> with each attribute replaced by its
residual, computed by $y_ij=x_ij-m_.jmi./m$ with $m$ the
grand mean, $m_.j$ the temporal mean, $m_i.$ the spatial mean
and $m$ the grand mean.
</p>


<h3>Examples</h3>

<pre>

if (require(gstat)) {
library(sp)
data(wind)
wind.loc$y = as.numeric(char2dms(as.character(wind.loc[["Latitude"]])))
wind.loc$x = as.numeric(char2dms(as.character(wind.loc[["Longitude"]])))
coordinates(wind.loc) = ~x+y
proj4string(wind.loc) = "+proj=longlat +datum=WGS84"
# match station order to names in wide table:
stations = 4:15
wind.loc = wind.loc[match(names(wind[stations]), wind.loc$Code),]
row.names(wind.loc) = wind.loc$Station
wind$time = ISOdate(wind$year+1900, wind$month, wind$day, 0)
space = list(values = names(wind)[stations])
wind.st = stConstruct(wind[stations], space, wind$time, SpatialObj = wind.loc)

wind.sti = stInteraction(wind.st)
# temporal means for any station should be zero:
c(mean(wind.sti[3,]),
# spatial mean for each time step should be zero:
mean(wind.sti[,5][[1]]))
}

</pre>

<hr /><div style="text-align: center;">[Package <em>spacetime</em> version 1.2-0 <a href="00Index.html">Index</a>]</div>
</body></html>
