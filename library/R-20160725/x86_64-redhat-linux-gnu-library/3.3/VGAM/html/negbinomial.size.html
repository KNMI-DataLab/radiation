<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Negative Binomial Distribution Family Function With Known...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for negbinomial.size {VGAM}"><tr><td>negbinomial.size {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Negative Binomial Distribution Family Function With Known Size</h2>

<h3>Description</h3>

<p>Maximum likelihood estimation of the mean parameter of a negative
binomial distribution with known size parameter.
</p>


<h3>Usage</h3>

<pre>
negbinomial.size(size = Inf, lmu = "loge", imu = NULL,
                 iprobs.y = 0.35, imethod = 1,
                 ishrinkage = 0.95, zero = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>size</code></td>
<td>

<p>Numeric, positive.
Same as argument <code>size</code> of <code><a href="../../stats/html/NegBinomial.html">rnbinom</a></code>.
If the response is a matrix then this is recycled to a matrix of
the same dimension, by row
(<code><a href="../../base/html/matrix.html">matrix</a></code> with <code>byrow = TRUE</code>).
</p>
</td></tr>
<tr valign="top"><td><code>lmu, imu</code></td>
<td>

<p>Same as <code><a href="negbinomial.html">negbinomial</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>iprobs.y</code></td>
<td>

<p>Same as <code><a href="negbinomial.html">negbinomial</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>imethod, zero</code></td>
<td>

<p>Same as <code><a href="negbinomial.html">negbinomial</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>ishrinkage</code></td>
<td>

<p>Same as <code><a href="negbinomial.html">negbinomial</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This <span class="pkg">VGAM</span> family function estimates only the mean parameter of
the negative binomial distribution.
See <code><a href="negbinomial.html">negbinomial</a></code> for general information.
Setting <code>size = 1</code> gives what I call the NB-G (geometric model;
see Hilbe (2011)).
The default, <code>size = Inf</code>, corresponds to the Poisson distribution.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
<code><a href="rrvglm.html">rrvglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Note</h3>

<p>If <code>lmu = "nbcanlink"</code> in <code>negbinomial.size()</code> then
the <code>size</code> argument here should be assigned.
</p>




<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Hilbe, J. M. (2011)
<em>Negative Binomial Regression</em>,
2nd Edition.
Cambridge: Cambridge University Press.
</p>
<p>Yee, T. W. (2014)
Reduced-rank vector generalized linear models with two linear predictors.
<em>Computational Statistics and Data Analysis</em>.
</p>


<h3>See Also</h3>

 
<p><code><a href="negbinomial.html">negbinomial</a></code>,
<code><a href="nbcanlink.html">nbcanlink</a></code> (NB-C model),
<code><a href="quasipoissonff.html">quasipoissonff</a></code>,
<code><a href="poissonff.html">poissonff</a></code>,
<code><a href="../../stats/html/NegBinomial.html">rnbinom</a></code>,
<code><a href="simulate.vlm.html">simulate.vlm</a></code>.
</p>



<h3>Examples</h3>

<pre>
# Simulated data with various multiple responses
size1 &lt;- exp(1); size2 &lt;- exp(2); size3 &lt;- exp(0); size4 &lt;- Inf
ndata &lt;- data.frame(x2 = runif(nn &lt;- 1000))
ndata &lt;- transform(ndata, eta1  = -1 - 2 * x2,  # eta1 must be negative
                          size1 = size1)
ndata &lt;- transform(ndata,
                   mu1  = nbcanlink(eta1, size = size1, inv = TRUE))
ndata &lt;- transform(ndata,
                   y1 = rnbinom(nn, mu = mu1,         size = size1),  # NB-C
                   y2 = rnbinom(nn, mu = exp(2 - x2), size = size2),
                   y3 = rnbinom(nn, mu = exp(3 + x2), size = size3),  # NB-G
                   y4 = rpois  (nn, la = exp(1 + x2)))

# Also known as NB-C with size known (Hilbe, 2011)
fit1 &lt;- vglm(y1 ~ x2, negbinomial.size(size = size1, lmu = "nbcanlink"),
             data = ndata, trace = TRUE, crit = "coef")
coef(fit1, matrix = TRUE)
head(fit1@misc$size)  # size saved here

fit2 &lt;- vglm(cbind(y2, y3, y4) ~ x2,
             negbinomial.size(size = c(size2, size3, size4)),
             data = ndata, trace = TRUE)
coef(fit2, matrix = TRUE)
head(fit2@misc$size)  # size saved here
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
