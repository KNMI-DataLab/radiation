<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Positive Binomial Distribution Family Function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for posbinomial {VGAM}"><tr><td>posbinomial {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Positive Binomial Distribution Family Function </h2>

<h3>Description</h3>

<p>Fits a positive binomial distribution.
</p>


<h3>Usage</h3>

<pre>
posbinomial(link = "logit", multiple.responses = FALSE, parallel = FALSE,
            omit.constant = FALSE, p.small = 1e-4, no.warning = FALSE,
            zero = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link, multiple.responses, parallel, zero</code></td>
<td>

<p>Details at <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>omit.constant</code></td>
<td>

<p>Logical.
If <code>TRUE</code> then the constant (<code>lchoose(size, size * yprop)</code>
is omitted from the <code>loglikelihood</code> calculation.
If the model is to be compared using
<code>AIC()</code> or <code>BIC()</code>
(see <code><a href="AICvlm.html">AICvlm</a></code> or <code><a href="BICvlm.html">BICvlm</a></code>)
to the likes of
<code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code> etc. then it is important
to set <code>omit.constant = TRUE</code> because all models then
will not have any normalizing constants in the likelihood function.
Hence they become comparable.
This is because the <i>M_0</i> Otis et al. (1978) model
coincides with <code>posbinomial()</code>.
See below for an example.
Also see <code><a href="posbernoulli.t.html">posbernoulli.t</a></code> regarding estimating the
population size (<code>N.hat</code> and <code>SE.N.hat</code>) if the
number of trials is the same for all observations.
</p>
</td></tr>
<tr valign="top"><td><code>p.small, no.warning</code></td>
<td>

<p>See <code><a href="posbernoulli.t.html">posbernoulli.t</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The positive binomial distribution is the ordinary binomial distribution
but with the probability of zero being zero.
Thus the other probabilities are scaled up
(i.e., divided by <i>1-P(Y=0)</i>).
The fitted values are the ordinary binomial distribution
fitted values, i.e., the usual mean.
</p>
<p>In the capture&ndash;recapture literature this model is called
the <i>M_0</i> if it is an intercept-only model.
Otherwise it is called the <i>M_h</i> when there are covariates.
It arises from a sum of a sequence of
<i>&tau;</i>-Bernoulli random variates subject to at least
one success (capture).
Here, each animal has the same probability of capture or
recapture, regardless of the <i>&tau;</i> sampling occasions.
Independence between animals and between sampling occasions etc.
is assumed.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Warning </h3>

<p>Under- or over-flow may occur if the data is ill-conditioned.
</p>


<h3>Note</h3>

<p>The input for this family function is the same as
<code><a href="binomialff.html">binomialff</a></code>.
</p>
<p>If <code>multiple.responses = TRUE</code> then each column of the matrix response
should be a count (the number of successes), and the
<code>weights</code> argument should be a matrix of the same dimension
as the response containing the number of trials.
If <code>multiple.responses = FALSE</code> then the response input should be the same
as <code><a href="binomialff.html">binomialff</a></code>.
</p>
<p>Yet to be done: a <code>quasi.posbinomial()</code> which estimates a
dispersion parameter.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Otis, D. L. et al. (1978)
Statistical inference from capture data on closed animal populations,
<em>Wildlife Monographs</em>,
<b>62</b>, 3&ndash;135.
</p>
<p>Patil, G. P. (1962)
Maximum likelihood estimation for
generalised power series distributions and its application to a
truncated binomial distribution.
<em>Biometrika</em>,
<b>49</b>, 227&ndash;237.
</p>
<p>Pearson, K. (1913)
<em>A Monograph on Albinism in Man</em>.
Drapers Company Research Memoirs.
</p>


<h3>See Also</h3>

 
<p><code><a href="posbernoulli.b.html">posbernoulli.b</a></code>,
<code><a href="posbernoulli.t.html">posbernoulli.t</a></code>,
<code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code>,
<code><a href="binomialff.html">binomialff</a></code>,
<code><a href="AICvlm.html">AICvlm</a></code>, <code><a href="BICvlm.html">BICvlm</a></code>,
<code><a href="simulate.vlm.html">simulate.vlm</a></code>.
</p>


<h3>Examples</h3>

<pre>
# Number of albinotic children in families with 5 kids (from Patil, 1962) ,,,,
albinos &lt;- data.frame(y = c(rep(1, 25), rep(2, 23), rep(3, 10), 4, 5),
                      n = rep(5, 60))
fit1 &lt;- vglm(cbind(y, n-y) ~ 1, posbinomial, albinos, trace = TRUE)
summary(fit1)
Coef(fit1)  # = MLE of p = 0.3088
head(fitted(fit1))
sqrt(vcov(fit1, untransform = TRUE))  # SE = 0.0322

# Fit a M_0 model (Otis et al. 1978) to the deermice data ,,,,,,,,,,,,,,,,,,,,,,,
M.0 &lt;- vglm(cbind(    y1 + y2 + y3 + y4 + y5 + y6,
                  6 - y1 - y2 - y3 - y4 - y5 - y6) ~ 1, trace = TRUE,
            posbinomial(omit.constant = TRUE), data = deermice)
coef(M.0, matrix = TRUE)
Coef(M.0)
constraints(M.0, matrix = TRUE)
summary(M.0)
c(   N.hat = M.0@extra$N.hat,     # Since tau = 6, i.e., 6 Bernoulli trials per
  SE.N.hat = M.0@extra$SE.N.hat)  # observation is the same for each observation

# Compare it to the M_b using AIC and BIC
M.b &lt;- vglm(cbind(y1, y2, y3, y4, y5, y6) ~ 1, trace = TRUE,
            posbernoulli.b, data = deermice)
sort(c(M.0 = AIC(M.0), M.b = AIC(M.b)))  # Okay since omit.constant = TRUE
sort(c(M.0 = BIC(M.0), M.b = BIC(M.b)))  # Okay since omit.constant = TRUE
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
