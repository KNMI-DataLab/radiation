<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Spread-Level Plots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for spreadLevelPlot {car}"><tr><td>spreadLevelPlot {car}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Spread-Level Plots</h2>

<h3>Description</h3>

<p>Creates plots for examining the possible dependence of
spread on level, or an extension of these plots to the studentized residuals
from linear models.
</p>


<h3>Usage</h3>

<pre>
spreadLevelPlot(x, ...)

slp(...)

## S3 method for class 'formula'
spreadLevelPlot(x, data=NULL, subset, na.action, 
    main=paste("Spread-Level Plot for", varnames[response], 
    "by", varnames[-response]), ...)

## Default S3 method:
spreadLevelPlot(x, by, robust.line=TRUE, 
	start=0, xlab="Median", ylab="Hinge-Spread", point.labels=TRUE, las=par("las"),
	main=paste("Spread-Level Plot for", deparse(substitute(x)), 
		"by", deparse(substitute(by))), col=palette()[1], col.lines=palette()[2],
    pch=1, lwd=2, grid=TRUE, ...)

## S3 method for class 'lm'
spreadLevelPlot(x, robust.line=TRUE, 
    smoother=loessLine, smoother.args=list(),
	xlab="Fitted Values",
	ylab="Absolute Studentized Residuals", las=par("las"),
	main=paste("Spread-Level Plot for\n", deparse(substitute(x))),
	pch=1, col=palette()[1], col.lines=palette()[2], col.smoother=palette()[3],
	lwd=2, grid=TRUE, ...)
	  
## S3 method for class 'spreadLevelPlot'
print(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a formula of the form <code>y ~ x</code>, where <code>y</code> is a numeric vector
and <code>x</code> is a factor, or an <code>lm</code> object to be plotted; alternatively a numeric vector.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>an optional data frame containing the variables to be plotted. 
By default the variables are taken from the environment from which 
<code>spreadLevelPlot</code> is called.</p>
</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr valign="top"><td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the data contain <code>NA</code>s. 
The default is set by the <code>na.action</code> setting of <code>options</code>.</p>
</td></tr>
<tr valign="top"><td><code>by</code></td>
<td>
<p>a factor, numeric vector, or character vector defining groups.</p>
</td></tr>
<tr valign="top"><td><code>robust.line</code></td>
<td>
<p>if <code>TRUE</code> a robust line is fit using the <code>rlm</code> function in
the <code>MASS</code> package; if <code>FALSE</code> a line is fit using <code>lm</code>.</p>
</td></tr>
<tr valign="top"><td><code>smoother</code></td>
<td>
<p>a function to draw a nonparametric-regression smooth; the default is <code><a href="ScatterplotSmoothers.html">loessLine</a></code>,
which does loess smoothing.  The function <code><a href="ScatterplotSmoothers.html">gamLine</a></code> fits a generalized additive model and
allows including a link and error function.
See <code><a href="ScatterplotSmoothers.html">ScatterplotSmoothers</a></code>.
Setting this argument to something other than a function, e.g., <code>FALSE</code> suppresses the smoother.</p>
</td></tr>
<tr valign="top"><td><code>smoother.args</code></td>
<td>
<p>a list of named values to be passed to the smoother function; the specified elements of the
list depend upon the smoother (see <code><a href="ScatterplotSmoothers.html">ScatterplotSmoothers</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>start</code></td>
<td>
<p>add the constant <code>start</code> to each data value.</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>title for the plot.</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>label for horizontal axis.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>label for vertical axis.</p>
</td></tr>
<tr valign="top"><td><code>point.labels</code></td>
<td>
<p>if <code>TRUE</code> label the points in the plot with group names.</p>
</td></tr>
<tr valign="top"><td><code>las</code></td>
<td>
<p>if <code>0</code>, ticks labels are drawn parallel to the
axis; set to <code>1</code> for horizontal labels (see <code><a href="../../graphics/html/par.html">par</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>color for points; the default is the first entry
in the current color palette (see <code><a href="../../grDevices/html/palette.html">palette</a></code>
and <code><a href="../../graphics/html/par.html">par</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>col.lines</code></td>
<td>
<p>color for lines; default is the second entry in the current
palette</p>
</td></tr>
<tr valign="top"><td><code>col.smoother</code></td>
<td>
<p>color for smooth line; default is third entry in the current palette.</p>
</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
<p>plotting character for points; default is <code>1</code> 
(a circle, see <code><a href="../../graphics/html/par.html">par</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
<p>line width; default is <code>2</code> (see <code><a href="../../graphics/html/par.html">par</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>grid</code></td>
<td>
<p>If TRUE, the default, a light-gray background grid is put on the
graph</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>arguments passed to plotting functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Except for linear models, computes the statistics for, and plots, a Tukey spread-level plot
of log(hinge-spread) vs. log(median) for the groups; fits a line to the plot; and calculates a
spread-stabilizing transformation from the slope of the line. 
</p>
<p>For linear models, plots log(abs(studentized residuals) vs. log(fitted values).
</p>
<p>The function <code>slp</code> is an abbreviation for <code>spreadLevelPlot</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>spreadLevelPlot</code> containing:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>Statistics</code></td>
<td>
<p>a matrix with the lower-hinge, median, upper-hinge, and hinge-spread
for each group. (Not for an <code>lm</code> object.)</p>
</td></tr>
<tr valign="top"><td><code>PowerTransformation</code></td>
<td>
<p>spread-stabilizing power transformation, calculated as <i>1 - slope</i>
of the line fit to the plot.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>


<h3>References</h3>

 
<p>Fox, J. (2008)
<em>Applied Regression Analysis and Generalized Linear Models</em>,
Second Edition. Sage.  
</p>
<p>Fox, J. and Weisberg, S. (2011) 
<em>An R Companion to Applied Regression</em>, Second Edition, Sage.
</p>
<p>Hoaglin, D. C., Mosteller, F. and Tukey, J. W. (Eds.) (1983)
<em>Understanding Robust and Exploratory Data Analysis.</em> Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="hccm.html">hccm</a></code>, <code><a href="ncvTest.html">ncvTest</a></code> </p>


<h3>Examples</h3>

<pre>
spreadLevelPlot(interlocks + 1 ~ nation, data=Ornstein)
slp(lm(interlocks + 1 ~ assets + sector + nation, data=Ornstein))
</pre>

<hr /><div style="text-align: center;">[Package <em>car</em> version 2.1-3 <a href="00Index.html">Index</a>]</div>
</body></html>
