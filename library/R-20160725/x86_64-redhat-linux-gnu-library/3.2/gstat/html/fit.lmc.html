<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fit a Linear Model of Coregionalization to a Multivariable...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for fit.lmc {gstat}"><tr><td>fit.lmc {gstat}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Fit a Linear Model of Coregionalization to a Multivariable Sample Variogram </h2>

<h3>Description</h3>

<p>Fit a Linear Model of Coregionalization to a Multivariable Sample Variogram;
in case of a single variogram model (i.e., no nugget) this is equivalent to
Intrinsic Correlation
</p>


<h3>Usage</h3>

<pre>
fit.lmc(v, g, model, fit.ranges = FALSE, fit.lmc = !fit.ranges, 
correct.diagonal = 1.0, ...) 
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>v</code></td>
<td>
<p> multivariable sample variogram, output of <a href="variogram.html">variogram</a> </p>
</td></tr>
<tr valign="top"><td><code>g</code></td>
<td>
<p> gstat object, output of <a href="gstat.html">gstat</a> </p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p> variogram model, output of <a href="vgm.html">vgm</a>; if supplied 
this value is used as initial value for each fit </p>
</td></tr>
<tr valign="top"><td><code>fit.ranges</code></td>
<td>
<p> logical; determines whether the range coefficients
(excluding that of the nugget component) should be fitted; or logical
vector: determines for each range parameter of the variogram model
whether it should be fitted or fixed. </p>
</td></tr>
<tr valign="top"><td><code>fit.lmc</code></td>
<td>
<p> logical; if TRUE, each coefficient matrices of partial
sills is guaranteed to be positive definite </p>
</td></tr>
<tr valign="top"><td><code>correct.diagonal</code></td>
<td>
<p> multiplicative correction factor to be applied
to partial sills of direct variograms only; the default value, 1.0, does
not correct. If you encounter problems with singular covariance matrices
during cokriging or cosimulation, you may want to try to increase this
to e.g. 1.01 </p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p> parameters that get passed to <a href="fit.variogram.html">fit.variogram</a> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class <code>gstat</code>, with fitted variograms;
</p>


<h3>Note</h3>

<p> This function does not use the iterative procedure proposed by
M. Goulard and M. Voltz (Math. Geol., 24(3): 269-286; reproduced in
Goovaerts' 1997 book) but uses simply two steps: first, each variogram
model is fitted to a direct or cross variogram; next each of the partial
sill coefficient matrices is approached by its in least squares sense
closest positive definite matrices (by setting any negative eigenvalues
to zero). 
</p>
<p>The argument <code>correct.diagonal</code> was introduced by experience: by
zeroing the negative eigenvalues for fitting positive definite partial
sill matrices, apparently still perfect correlation may result, leading
to singular cokriging/cosimulation matrices. If someone knows of a more
elegant way to get around this, please let me know.
</p>


<h3>Author(s)</h3>

<p> Edzer Pebesma </p>


<h3>References</h3>

 <p><a href="http://www.gstat.org/">http://www.gstat.org/</a> </p>


<h3>See Also</h3>

 <p><a href="variogram.html">variogram</a>, <a href="vgm.html">vgm</a>, <a href="fit.variogram.html">fit.variogram</a>,
<code>demo(cokriging)</code> </p>

<hr /><div style="text-align: center;">[Package <em>gstat</em> version 1.1-3 <a href="00Index.html">Index</a>]</div>
</body></html>
