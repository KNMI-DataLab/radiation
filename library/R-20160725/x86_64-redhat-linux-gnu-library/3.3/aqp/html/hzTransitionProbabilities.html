<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Horizon Transition Probabilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for hzTransitionProbabilities {aqp}"><tr><td>hzTransitionProbabilities {aqp}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Horizon Transition Probabilities</h2>

<h3>Description</h3>

<p>Functions for creating and working with horizon (sequence) transition probability matrices.</p>


<h3>Usage</h3>

<pre>
hzTransitionProbabilities(x, name, loopTerminalStates = FALSE)

genhzTableToAdjMat(tab)

mostLikelyHzSequence(mc, t0, maxIterations=10)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A <code>SoilProfileCollection</code> object.</p>
</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
<p>A horizon level attribute in <code>x</code> that names horizons.</p>
</td></tr>
<tr valign="top"><td><code>loopTerminalStates</code></td>
<td>
<p>should terminal states loop back to themselves? This is useful when the transition probability matrix will be used to initialize a <code>markovchain</code> object. See examples below.</p>
</td></tr>
<tr valign="top"><td><code>tab</code></td>
<td>
<p>A cross-tabulation relating original horizon designations to new, generalized horizon designations.</p>
</td></tr>
<tr valign="top"><td><code>mc</code></td>
<td>
<p>A <code>markovchain</code> object, initialized from a horizon sequence transition probability matrix with looped terminal states.</p>
</td></tr>
<tr valign="top"><td><code>t0</code></td>
<td>
<p>Time-zero: a label describing an initial state within a <code>markovchain</code> object.</p>
</td></tr>
<tr valign="top"><td><code>maxIterations</code></td>
<td>
<p>the maximum number of iterations when search for the most-likely horizon sequence</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details and related tutorial pending...</p>


<h3>Value</h3>

<p>The function <code>hzTransitionProbabilities</code> returns a square matrix of transition probabilities. See examples.
</p>
<p>The function <code>genhzTableToAdjMat</code> returns a square adjacency matrix. See examples.
</p>
<p>The function <code>mostLikelyHzSequence</code> returns the most likely sequence of horizons, given a <code>markovchain</code> object initialized from horizon transition probabilities and an initial state, <code>t0</code>. See examples.</p>


<h3>Note</h3>

<p>These functions are still experimental and subject to change.</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette</p>


<h3>See Also</h3>

<p><code><a href="generalize.hz.html">generalize.hz</a></code></p>


<h3>Examples</h3>

<pre>
data(sp4)
depths(sp4) &lt;- id ~ top + bottom

# horizon transition probabilities: row -&gt; col transitions
(tp &lt;- hzTransitionProbabilities(sp4, 'name'))


## Not run: 
## plot TP matrix with functions from sharpshootR package
library(sharpshootR)
par(mar=c(0,0,0,0), mfcol=c(1,2))
plot(sp4)
plotSoilRelationGraph(tp, graph.mode = 'directed', edge.arrow.size=0.5)

## demonstrate genhzTableToAdjMat usage
data(loafercreek, package='soilDB')

# convert contingency table -&gt; adj matrix / TP matrix
tab &lt;- table(loafercreek$hzname, loafercreek$genhz)
m &lt;- genhzTableToAdjMat(tab)

# plot 
par(mar=c(0,0,0,0), mfcol=c(1,1))
plotSoilRelationGraph(m, graph.mode = 'directed', edge.arrow.size=0.5)


## demonstrate markovchain integration
library(markovchain)
tp.loops &lt;- hzTransitionProbabilities(sp4, 'name', loopTerminalStates = TRUE)

# init new markovchain from TP matrix
mc &lt;- new("markovchain", states=dimnames(tp.loops)[[1]], transitionMatrix = tp.loops)

# simple plot
plot(mc, edge.arrow.size=0.5)

# check absorbing states
absorbingStates(mc)

# steady-state:
steadyStates(mc)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>aqp</em> version 1.9.10 <a href="00Index.html">Index</a>]</div>
</body></html>
