<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Multi Level Decomposition of unidimensional data</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mld {ade4}"><tr><td>mld {ade4}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Multi Level Decomposition of unidimensional data</h2>

<h3>Description</h3>

<p>The function <code>mld</code> performs an additive decomposition of the input vector <code>x</code> onto sub-spaces associated 
to an orthonormal orthobasis. The sub-spaces are defined by levels of the input factor <code>level</code>.
The function <code>haar2level</code> builds the factor <code>level</code> such that the multi level decomposition corresponds exactly to a multiresolution analysis performed with the haar basis.
</p>


<h3>Usage</h3>

<pre>
mld(x, orthobas, level, na.action = c("fail", "mean"),
 plot = TRUE, dfxy = NULL, phylog = NULL, ...)
haar2level(x)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>is a vector or a time serie containing the data to be decomposed. This must be a dyadic length vector (power of 2) for the function <code>haar2level</code>.</p>
</td></tr>
<tr valign="top"><td><code>orthobas</code></td>
<td>
<p>is a data frame containing the vectors of the orthonormal basis.</p>
</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
<p>is a factor which levels define the sub-spaces on which the function <code>mld</code> performs the additive decomposition.</p>
</td></tr>
<tr valign="top"><td><code>na.action</code></td>
<td>
<p> if 'fail' stops the execution of the current expression when <code>x</code> contains any missing value. If 'mean' replaces any missing values by mean(<code>x</code>).</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p>if TRUE plot <code>x</code> and the components resulting from the decomposition.</p>
</td></tr>
<tr valign="top"><td><code>dfxy</code></td>
<td>
<p>is a data frame with two coordinates.</p>
</td></tr>
<tr valign="top"><td><code>phylog</code></td>
<td>
<p>is an object of class <code>phylog</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the components resulting from the decomposition.
</p>


<h3>Author(s)</h3>

<p>SÃ©bastien Ollier <a href="mailto:sebastien.ollier@u-psud.fr">sebastien.ollier@u-psud.fr</a></p>


<h3>References</h3>

<p>Mallat, S. G. (1989) A theory for multiresolution signal decomposition: the wavelet representation. 
<em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, <b>11</b>, 7, 674&ndash;693.
</p>
<p>Percival, D. B. and Walden, A. T. (2000) <em>Wavelet Methods for Time Series Analysis</em>, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="gridrowcol.html">gridrowcol</a></code>, <code><a href="orthobasis.html">orthobasis</a></code>, <code><a href="orthogram.html">orthogram</a></code>, <code><a href="../../waveslim/html/mra.html">mra</a></code> for multiresolution analysis with various families of wavelets</p>


<h3>Examples</h3>

<pre>
## Not run: 
# decomposition of a time serie
data(co2)
x &lt;- log(co2)
orthobas &lt;- orthobasis.line(length(x))
level&lt;-rep("D", 467)
level[1:3]&lt;-rep("A", 3)
level[c(77,78,79,81)]&lt;-rep("B", 4)
level[156]&lt;-"C"
level&lt;-as.factor(level)
res &lt;- mld(x, orthobas, level)
sum(scale(x, scale = FALSE) - apply(res, 1, sum))

## End(Not run)
# decomposition of a biological trait on a phylogeny
data(palm)
vfruit&lt;-palm$traits$vfruit
vfruit&lt;-scalewt(vfruit)   
palm.phy&lt;-newick2phylog(palm$tre)
level &lt;- rep("F", 65)
level[c(4, 21, 3, 6, 13)] &lt;- LETTERS[1:5]
level &lt;- as.factor(level)
res &lt;- mld(as.vector(vfruit), palm.phy$Bscores, level,
 phylog = palm.phy, clabel.nod = 0.7, f.phylog=0.8,
  csize = 2, clabel.row = 0.7, clabel.col = 0.7)
</pre>

<hr /><div style="text-align: center;">[Package <em>ade4</em> version 1.7-4 <a href="00Index.html">Index</a>]</div>
</body></html>
