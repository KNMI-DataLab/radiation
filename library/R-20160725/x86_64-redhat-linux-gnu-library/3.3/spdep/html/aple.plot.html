<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Approximate profile-likelihood estimator (APLE) scatterplot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for aple.plot {spdep}"><tr><td>aple.plot {spdep}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Approximate profile-likelihood estimator (APLE) scatterplot</h2>

<h3>Description</h3>

<p>A scatterplot decomposition of the approximate profile-likelihood estimator, and a local APLE based on the list of vectors returned by the scatterplot function.
</p>


<h3>Usage</h3>

<pre>
aple.plot(x, listw, override_similarity_check=FALSE, useTrace=TRUE, do.plot=TRUE, ...)
localAple(x, listw, override_similarity_check=FALSE, useTrace=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a zero-mean detrended continuous variable</p>
</td></tr>
<tr valign="top"><td><code>listw</code></td>
<td>
<p>a <code>listw</code> object from for example <code>nb2listw</code></p>
</td></tr>
<tr valign="top"><td><code>override\_similarity\_check</code></td>
<td>
<p>default FALSE, if TRUE - typically for row-standardised weights with asymmetric underlying general weights - similarity is not checked</p>
</td></tr>
<tr valign="top"><td><code>useTrace</code></td>
<td>
<p>default TRUE, use trace of sparse matrix <code>W %*% W</code> (Li et al. (2010)), if FALSE, use crossproduct of eigenvalues of <code>W</code> as in Li et al. (2007)</p>
</td></tr>
<tr valign="top"><td><code>do.plot</code></td>
<td>
<p>default TRUE: should a scatterplot be drawn</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function solves a secondary eigenproblem of size n internally, so constructing the values for the scatterplot is quite compute and memory intensive, and is not suitable for very large n.
</p>


<h3>Value</h3>

<p><code>aple.plot</code> returns list with components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>X</code></td>
<td>
<p>A vector as described in Li et al. (2007), p. 366.</p>
</td></tr>
<tr valign="top"><td><code>Y</code></td>
<td>
<p>A vector as described in Li et al. (2007), p. 367.</p>
</td></tr>
</table>
<p><code>localAple</code> returns a vector of local APLE values.
</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Li, H, Calder, C. A. and Cressie N. A. C. (2007) Beyond Moran's I: testing for spatial dependence based on the spatial autoregressive model. Geographical Analysis 39, pp. 357-375; Li, H, Calder, C. A. and Cressie N. A. C. (2012) One-step estimation of spatial dependence parameters: Properties and extensions of the APLE statistic, Journal of Multivariate Analysis 105, 68-84.</p>


<h3>See Also</h3>

<p><code><a href="aple.html">aple</a></code></p>


<h3>Examples</h3>

<pre>
## Not run: 
example(aple)
plt_out &lt;- aple.plot(as.vector(scale(wheat$yield_detrend, scale=FALSE)),
 nb2listw(nbr12, style="W"), cex=0.6)
crossprod(plt_out$Y, plt_out$X)/crossprod(plt_out$X)
lm_obj &lt;- lm(Y ~ X, plt_out)
abline(lm_obj)
abline(v=0, h=0, lty=2)
zz &lt;- summary(influence.measures(lm_obj))
infl &lt;- as.integer(rownames(zz))
points(plt_out$X[infl], plt_out$Y[infl], pch=3, cex=0.6, col="red")
wheat$localAple &lt;- localAple(as.vector(scale(wheat$yield_detrend, scale=FALSE)),
 nb2listw(nbr12, style="W"))
mean(wheat$localAple)
hist(wheat$localAple)
spl &lt;- list("sp.text", coordinates(wheat)[infl,], rep("*", length(infl)))
spplot(wheat, "localAple", sp.layout=spl)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>spdep</em> version 0.6-6 <a href="00Index.html">Index</a>]</div>
</body></html>
