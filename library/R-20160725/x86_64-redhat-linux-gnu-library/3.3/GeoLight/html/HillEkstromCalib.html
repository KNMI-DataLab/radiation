<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Hill-Ekstrom calibration</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for HillEkstromCalib {GeoLight}"><tr><td>HillEkstromCalib {GeoLight}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Hill-Ekstrom calibration</h2>

<h3>Description</h3>

<p>Hill-Ekstrom calibration for one or multiple stationary periods.
</p>


<h3>Usage</h3>

<pre>
HillEkstromCalib(tFirst, tSecond, type, twl, site, start.angle = -6,
  distanceFilter = FALSE, distance, plot = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>tFirst</code></td>
<td>
<p>vector of sunrise/sunset times (e.g. 2008-12-01 08:30).</p>
</td></tr>
<tr valign="top"><td><code>tSecond</code></td>
<td>
<p>vector of of sunrise/sunset times (e.g. 2008-12-01 17:30).</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>vector of either 1 or 2, defining <code>tFirst</code> as sunrise or sunset respectively.</p>
</td></tr>
<tr valign="top"><td><code>twl</code></td>
<td>
<p>data.frame containing twilights and at least <code>tFirst</code>, <code>tSecond</code> and <code>type</code> (alternatively give each parameter separately).</p>
</td></tr>
<tr valign="top"><td><code>site</code></td>
<td>
<p>a <code>numerical vector</code> assigning each row to a particular
period. Stationary periods in numerical order and values &gt;0,
migration/movement periods 0</p>
</td></tr>
<tr valign="top"><td><code>start.angle</code></td>
<td>
<p>a single sun elevation angle. The combined process of
checking for minimal variance in resulting latitude, which is the initial
value for the sun elevation angle in the iterative process of identifying
the latitudes with the least variance</p>
</td></tr>
<tr valign="top"><td><code>distanceFilter</code></td>
<td>
<p>logical, if TRUE the <code><a href="distanceFilter.html">distanceFilter</a></code> will
be used to filter unrealistic positions</p>
</td></tr>
<tr valign="top"><td><code>distance</code></td>
<td>
<p>if <code>distanceFilter</code> is set <code>TRUE</code> a threshold
distance in km has to be set (see: <code><a href="distanceFilter.html">distanceFilter</a></code>)</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p>logical, if TRUE the function will give a plot with all relevant
information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>Hill-Ekstrom calibration</em> has been suggested by Hill &amp; Braun
(2001) and Ekstrom (2004), and allows for calibrating data during stationary
periods at unknown latitudinal positions. The Hill-Ekstrom calibration bases
on an increasing error range in latitudes with an increasing mismatch
between light level threshold and the used sun angle. This error is strongly
amplified with proximity to the equinox times due to decreasing slope of day
length variation with latitude. Furthermore, the sign of the error switches
at the equinox, i.e. latitude is overestimated before the equinox and
underestimated after the equinox (or vice versa depending on autumnal/vernal
equinox, hemisphere, and sign of the mismatch between light level threshold
and sun angle). When calculating the positions of a stationary period, the
variance in latitude is minimal if the sun elevation angle fits to the
defined light level threshold. Moreover, the accuracy of positions increases
with decreasing variance in latitudes. <b>However, the method is only
applicable for stationary periods and under stable shading intensities</b>. The
plot produced by the function may help to judge visually if the calculated
sun elevation angles are realistic (e.g. site 2 in the example below) or not
(e.g. site 3 in the example below.
</p>


<h3>Value</h3>

<p>A <code>vector</code> of sun elevation angles corresponding to the
Hill-Ekstrom calibration for each defined period.
</p>


<h3>Author(s)</h3>

<p>Simeon Lisovski
</p>


<h3>References</h3>

<p>Ekstrom, P.A. (2004) An advance in geolocation by light.
<em>Memoirs of the National Institute of Polar Research</em>, Special Issue,
<b>58</b>, 210-226.
</p>
<p>Hill, C. &amp; Braun, M.J. (2001) Geolocation by light level - the next step:
Latitude. In: <em>Electronic Tagging and Tracking in Marine Fisheries</em>
(eds J.R. Sibert &amp; J. Nielsen), pp. 315-330. Kluwer Academic Publishers, The
Netherlands.
</p>
<p>Lisovski, S., Hewson, C.M, Klaassen, R.H.G., Korner-Nievergelt, F.,
Kristensen, M.W &amp; Hahn, S. (2012) Geolocation by light: Accuracy and
precision affected by environmental factors. <em>Methods in Ecology and
Evolution</em>, DOI: 10.1111/j.2041-210X.2012.00185.x.
</p>


<h3>Examples</h3>

<pre>
data(hoopoe2)
  hoopoe2$tFirst &lt;- as.POSIXct(hoopoe2$tFirst, tz = "GMT")
  hoopoe2$tSecond &lt;- as.POSIXct(hoopoe2$tSecond, tz = "GMT")
residency &lt;- with(hoopoe2, changeLight(tFirst,tSecond,type, rise.prob=0.1,
                  set.prob=0.1, plot=FALSE, summary=FALSE))
HillEkstromCalib(hoopoe2,site = residency$site)
</pre>

<hr /><div style="text-align: center;">[Package <em>GeoLight</em> version 2.0.0 <a href="00Index.html">Index</a>]</div>
</body></html>
