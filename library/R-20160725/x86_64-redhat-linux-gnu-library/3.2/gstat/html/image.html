<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Image Gridded Coordinates in Data Frame</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for image {gstat}"><tr><td>image {gstat}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Image Gridded Coordinates in Data Frame
</h2>

<h3>Description</h3>

<p>Image gridded data, held in a data frame, keeping the
right aspect ratio for axes, and the right cell shape
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'data.frame'
image(x, zcol = 3, xcol = 1, ycol = 2, asp = 1, ...)
xyz2img(xyz, zcol = 3, xcol = 1, ycol = 2, tolerance = 10 * .Machine$double.eps)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p> data frame (or matrix) with x-coordinate,
y-coordinate, and z-coordinate in its columns </p>
</td></tr>
<tr valign="top"><td><code>zcol</code></td>
<td>
<p> column number or name of z-variable </p>
</td></tr>
<tr valign="top"><td><code>xcol</code></td>
<td>
<p> column number or name of x-coordinate </p>
</td></tr>
<tr valign="top"><td><code>ycol</code></td>
<td>
<p> column number or name of y-coordinate </p>
</td></tr>
<tr valign="top"><td><code>asp</code></td>
<td>
<p> aspect ratio for the x and y axes </p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p> arguments, passed to image.default </p>
</td></tr>
<tr valign="top"><td><code>xyz</code></td>
<td>
<p>data frame (same as <code>x</code>)</p>
</td></tr>
<tr valign="top"><td><code>tolerance</code></td>
<td>
<p> maximum allowed deviation for coordinats from being
exactly on a regularly spaced grid </p>
</td></tr>
</table>


<h3>Value</h3>

<p><a href="image.html">image.data.frame</a> plots an image from gridded data, organized
in arbritrary order, in a data frame. It uses <a href="image.html">xyz2img</a> and
<a href="../../graphics/html/image.html">image.default</a> for this. In the S-Plus version, <a href="image.html">xyz2img</a>
tries to make an image object with a size such that it will plot with
an equal aspect ratio; for the R version, image.data.frame uses the
<code>asp=1</code> argument to guarantee this.
</p>
<p><a href="image.html">xyz2img</a> returns a list with components: <code>z</code>, a matrix
containing the z-values; <code>x</code>, the increasing coordinates of the
rows of <code>z</code>; <code>y</code>, the increasing coordinates of the columns
of <code>z</code>. This list is suitable input to <a href="../../graphics/html/image.html">image.default</a>.
</p>


<h3>Note</h3>

<p>I wrote this function before I found out about <code>levelplot</code>,
a Lattice/Trellis function that lets you control the aspect ratio by
the <code>aspect</code> argument, and that automatically draws a legend, and
therefore I now prefer levelplot over <code>image</code>. Plotting points
on a levelplots is probably done with providing a panel function and
using <code>lpoints</code>.
</p>
<p>(for S-Plus only &ndash; ) it is hard (if not impossible) to get exactly right
cell shapes (e.g., square for a square grid) without altering the size of
the plotting region, but this function tries hard to do so by extending
the image to plot in either x- or y-direction.  The larger the grid, the
better the approximation. Geographically correct images can be obtained
by modifiying <code>par("pin")</code>. Read the examples, image a 2 x 2 grid,
and play with <code>par("pin")</code> if you want to learn more about this.
</p>


<h3>Author(s)</h3>

<p> Edzer Pebesma </p>


<h3>Examples</h3>

<pre>
library(sp)
data(meuse)
data(meuse.grid)
g &lt;- gstat(formula=log(zinc)~1,locations=~x+y,data=meuse,model=vgm(1,"Exp",300))
x &lt;- predict(g, meuse.grid)
image(x, 4, main="kriging variance and data points")
points(meuse$x, meuse$y, pch = "+")
# non-square cell test:
image(x[((x$y - 20) %% 80) == 0,], main = "40 x 80 cells")
image(x[((x$x - 20) %% 80) == 0,], main = "80 x 40 cells")
# the following works for square cells only:
oldpin &lt;- par("pin")
ratio &lt;- length(unique(x$x))/length(unique(x$y))
par(pin = c(oldpin[2]*ratio,oldpin[2]))
image(x, main="Exactly square cells, using par(pin)")
par(pin = oldpin)
library(lattice)
levelplot(var1.var~x+y, x, aspect = "iso", main = "kriging variance")
</pre>

<hr /><div style="text-align: center;">[Package <em>gstat</em> version 1.1-3 <a href="00Index.html">Index</a>]</div>
</body></html>
