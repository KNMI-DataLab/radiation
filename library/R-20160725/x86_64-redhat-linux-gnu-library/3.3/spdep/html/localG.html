<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: G and Gstar local spatial statistics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for localG {spdep}"><tr><td>localG {spdep}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>G and Gstar local spatial statistics</h2>

<h3>Description</h3>

<p>The local spatial statistic G is calculated for each zone based on the
spatial weights object used. The value returned is a Z-value, and may be
used as a diagnostic tool. High positive values indicate the posibility
of a local cluster of high values of the variable being analysed, very
low relative values a similar cluster of low values. For inference,
a Bonferroni-type test is suggested in the references, where tables of
critical values may be found (see also details below).
</p>


<h3>Usage</h3>

<pre>
localG(x, listw, zero.policy=NULL, spChk=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a numeric vector the same length as the neighbours list in listw</p>
</td></tr>
<tr valign="top"><td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td></tr>
<tr valign="top"><td><code>zero.policy</code></td>
<td>
<p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td></tr>
<tr valign="top"><td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the neighbours member of listw has a &quot;self.included&quot; attribute set
to TRUE, the Gstar variant, including the self-weight <i>w_{ii} &gt; 0</i>,
is calculated and returned.  The returned vector will have a &quot;gstari&quot;
attribute set to TRUE.  Self-weights can be included by using the
<code>include.self</code> function in the spweights package before converting
the neighbour list to a spatial weights list with <code>nb2listw</code> as
shown below in the example.
</p>
<p>The critical values of the statistic under assumptions given in the
references for the 95th percentile are for n=1: 1.645, n=50: 3.083,
n=100: 3.289, n=1000: 3.886.
</p>


<h3>Value</h3>

<p>A vector of G or Gstar values, with attributes &quot;gstari&quot; set to TRUE or
FALSE, &quot;call&quot; set to the function call, and class &quot;localG&quot;.
</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Ord, J. K. and Getis, A. 1995 Local spatial autocorrelation
statistics: distributional issues and an application. <em>Geographical
Analysis</em>, 27, 286&ndash;306; Getis, A. and Ord, J. K. 1996 Local spatial
statistics: an overview. In P. Longley and M. Batty (eds) <em>Spatial
analysis: modelling in a GIS environment</em> (Cambridge: Geoinformation
International), 261&ndash;277.</p>


<h3>Examples</h3>

<pre>
data(getisord)
xycoords &lt;- cbind(xyz$x, xyz$y)
nb30 &lt;- dnearneigh(xycoords, 0, 30)
G30 &lt;- localG(xyz$val, nb2listw(nb30, style="B"))
G30[length(xyz$val)-136]
nb60 &lt;- dnearneigh(xycoords, 0, 60)
G60 &lt;- localG(xyz$val, nb2listw(nb60, style="B"))
G60[length(xyz$val)-136]
nb90 &lt;- dnearneigh(xycoords, 0, 90)
G90 &lt;- localG(xyz$val, nb2listw(nb90, style="B"))
G90[length(xyz$val)-136]
nb120 &lt;- dnearneigh(xycoords, 0, 120)
G120 &lt;- localG(xyz$val, nb2listw(nb120, style="B"))
G120[length(xyz$val)-136]
nb150 &lt;- dnearneigh(xycoords, 0, 150)
G150 &lt;- localG(xyz$val, nb2listw(nb150, style="B"))
G150[length(xyz$val)-136]
brks &lt;- seq(-5,5,1)
cm.col &lt;- cm.colors(length(brks)-1)
image(x, y, t(matrix(G30, nrow=16, ncol=16, byrow=TRUE)),
  breaks=brks, col=cm.col, asp=1)
text(xyz$x, xyz$y, round(G30, digits=1), cex=0.7)
polygon(c(195,225,225,195), c(195,195,225,225), lwd=2)
title(main=expression(paste("Values of the ", G[i], " statistic")))
G30s &lt;- localG(xyz$val, nb2listw(include.self(nb30),
 style="B"))
cat("value according to Getis and Ord's eq. 14.2, p. 263 (1996)\n")
G30s[length(xyz$val)-136]
cat(paste("value given by Getis and Ord (1996), p. 267",
  "(division by n-1 rather than n \n in variance)\n"))
G30s[length(xyz$val)-136] *
  (sqrt(sum(scale(xyz$val, scale=FALSE)^2)/length(xyz$val)) /
  sqrt(var(xyz$val)))
image(x, y, t(matrix(G30s, nrow=16, ncol=16, byrow=TRUE)),
  breaks=brks, col=cm.col, asp=1)
text(xyz$x, xyz$y, round(G30s, digits=1), cex=0.7)
polygon(c(195,225,225,195), c(195,195,225,225), lwd=2)
title(main=expression(paste("Values of the ", G[i]^"*", " statistic")))
</pre>

<hr /><div style="text-align: center;">[Package <em>spdep</em> version 0.6-6 <a href="00Index.html">Index</a>]</div>
</body></html>
