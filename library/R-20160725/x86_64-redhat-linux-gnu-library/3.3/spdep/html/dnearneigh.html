<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Neighbourhood contiguity by distance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for dnearneigh {spdep}"><tr><td>dnearneigh {spdep}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Neighbourhood contiguity by distance</h2>

<h3>Description</h3>

<p>The function identifies neighbours of region points by Euclidean distance between lower (greater than) and upper (less than or equal to) bounds, or with longlat = TRUE, by Great Circle distance in kilometers.
</p>


<h3>Usage</h3>

<pre>
dnearneigh(x, d1, d2, row.names = NULL, longlat = NULL, bounds=c("GT", "LE"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>matrix of point coordinates or a SpatialPoints object</p>
</td></tr>
<tr valign="top"><td><code>d1</code></td>
<td>
<p>lower distance bound</p>
</td></tr>
<tr valign="top"><td><code>d2</code></td>
<td>
<p>upper distance bound</p>
</td></tr>
<tr valign="top"><td><code>row.names</code></td>
<td>
<p>character vector of region ids to be added to the neighbours list as attribute <code>region.id</code>, default <code>seq(1, nrow(x))</code></p>
</td></tr>
<tr valign="top"><td><code>longlat</code></td>
<td>
<p>TRUE if point coordinates are longitude-latitude decimal degrees, in which case distances are measured in kilometers; if x is a SpatialPoints object, the value is taken from the object itself, and overrides this argument if not NULL</p>
</td></tr>
<tr valign="top"><td><code>bounds</code></td>
<td>
<p>character vector of length 2, default <code>c("GT", "LE")</code>, the first element may also be <code>"GE"</code>, the second <code>"LT"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of integer vectors giving the region id numbers
for neighbours satisfying the distance criteria. See <code><a href="card.html">card</a></code> for details of &ldquo;nb&rdquo; objects.
</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>See Also</h3>

<p><code><a href="knearneigh.html">knearneigh</a></code>, <code><a href="card.html">card</a></code></p>


<h3>Examples</h3>

<pre>
example(columbus)
coords &lt;- coordinates(columbus)
rn &lt;- sapply(slot(columbus, "polygons"), function(x) slot(x, "ID"))
k1 &lt;- knn2nb(knearneigh(coords))
all.linked &lt;- max(unlist(nbdists(k1, coords)))
col.nb.0.all &lt;- dnearneigh(coords, 0, all.linked, row.names=rn)
summary(col.nb.0.all, coords)
plot(columbus, border="grey")
plot(col.nb.0.all, coords, add=TRUE)
title(main=paste("Distance based neighbours 0-",  format(all.linked),
 " distance units", sep=""))
data(state)
us48.fipsno &lt;- read.geoda(system.file("etc/weights/us48.txt",
 package="spdep")[1])
if (as.numeric(paste(version$major, version$minor, sep="")) &lt; 19) {
 m50.48 &lt;- match(us48.fipsno$"State.name", state.name)
} else {
 m50.48 &lt;- match(us48.fipsno$"State_name", state.name)
}
xy &lt;- as.matrix(as.data.frame(state.center))[m50.48,]
llk1 &lt;- knn2nb(knearneigh(xy, k=1, longlat=FALSE))
all.linked &lt;- max(unlist(nbdists(llk1, xy, longlat=FALSE)))
ll.nb &lt;- dnearneigh(xy, 0, all.linked, longlat=FALSE)
summary(ll.nb, xy, longlat=TRUE, scale=0.5)
gck1 &lt;- knn2nb(knearneigh(xy, k=1, longlat=TRUE))
all.linked &lt;- max(unlist(nbdists(gck1, xy, longlat=TRUE)))
gc.nb &lt;- dnearneigh(xy, 0, all.linked, longlat=TRUE)
summary(gc.nb, xy, longlat=TRUE, scale=0.5)
plot(ll.nb, xy)
plot(diffnb(ll.nb, gc.nb), xy, add=TRUE, col="red", lty=2)
title(main="Differences between Euclidean and Great Circle neighbours")

xy1 &lt;- SpatialPoints((as.data.frame(state.center))[m50.48,],
  proj4string=CRS("+proj=longlat +ellps=GRS80"))
gck1a &lt;- knn2nb(knearneigh(xy1, k=1))
all.linked &lt;- max(unlist(nbdists(gck1a, xy1)))
gc.nb &lt;- dnearneigh(xy1, 0, all.linked)
summary(gc.nb, xy1, scale=0.5)
</pre>

<hr /><div style="text-align: center;">[Package <em>spdep</em> version 0.6-6 <a href="00Index.html">Index</a>]</div>
</body></html>
