<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Mixture of Two Poisson Distributions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mix2poisson {VGAM}"><tr><td>mix2poisson {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Mixture of Two Poisson Distributions </h2>

<h3>Description</h3>

<p>Estimates the three parameters of a mixture of two Poisson distributions
by maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre>
mix2poisson(lphi = "logit", llambda = "loge",
            iphi = 0.5, il1 = NULL, il2 = NULL,
            qmu = c(0.2, 0.8), nsimEIM = 100, zero = "phi")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lphi, llambda</code></td>
<td>

<p>Link functions for the parameter <i>phi</i> and
<i>lambda</i>.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
</table>





<table summary="R argblock">
<tr valign="top"><td><code>iphi</code></td>
<td>

<p>Initial value for <i>phi</i>, whose value must lie
between 0 and 1.
</p>
</td></tr>
<tr valign="top"><td><code>il1, il2</code></td>
<td>

<p>Optional initial value for <i>lambda1</i> and
<i>lambda2</i>. These values must be positive.
The default is to compute initial values internally using
the argument <code>qmu</code>.


</p>
</td></tr>
<tr valign="top"><td><code>qmu</code></td>
<td>

<p>Vector with two values giving the probabilities relating to the sample
quantiles for obtaining initial values for <i>lambda1</i>
and <i>lambda2</i>.
The two values are fed in as the <code>probs</code> argument into
<code><a href="../../stats/html/quantile.html">quantile</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>nsimEIM, zero</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability function can be loosely written as 
</p>
<p style="text-align: center;"><i>
        P(Y=y) = phi * Poisson(lambda1) + (1-phi) * Poisson(lambda2)</i></p>

<p>where <i>phi</i> is the probability an observation belongs
to the first group, and <i>y=0,1,2,...</i>.
The parameter <i>phi</i> satisfies <i>0 &lt; phi &lt; 1</i>.
The mean of <i>Y</i> is
<i>phi*lambda1 + (1-phi)*lambda2</i>
and this is returned as the fitted values.
By default, the three linear/additive predictors are
<i>(logit(phi),
  log(lambda1), log(lambda2))^T</i>.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Warning </h3>

<p>This <span class="pkg">VGAM</span> family function requires care for a successful
application.
In particular, good initial values are required because of the presence
of local solutions. Therefore running this function with several
different combinations of arguments such as <code>iphi</code>, <code>il1</code>,
<code>il2</code>, <code>qmu</code> is highly recommended. Graphical methods such
as <code><a href="../../graphics/html/hist.html">hist</a></code> can be used as an aid.
</p>
<p>With grouped data (i.e., using the <code>weights</code> argument)
one has to use a large value of <code>nsimEIM</code>;
see the example below.
</p>
<p>This <span class="pkg">VGAM</span> family function is experimental and
should be used with care.
</p>


<h3>Note</h3>

<p>The response must be integer-valued since <code><a href="../../stats/html/dpois.html">dpois</a></code>
is invoked.
</p>
<p>Fitting this model successfully to data can be difficult due to local
solutions and ill-conditioned data. It pays to fit the model several
times with different initial values, and check that the best fit
looks reasonable. Plotting the results is recommended. This function
works better as <i>lambda1</i> and <i>lambda2</i>
become more different.
The default control argument <code>trace = TRUE</code> is to encourage
monitoring convergence.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee </p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/Poisson.html">rpois</a></code>,
<code><a href="poissonff.html">poissonff</a></code>,
<code><a href="mix2normal.html">mix2normal</a></code>.
</p>


<h3>Examples</h3>

<pre>
## Not run:  # Example 1: simulated data
nn &lt;- 1000
mu1 &lt;- exp(2.5)  # Also known as lambda1
mu2 &lt;- exp(3)
(phi &lt;- logit(-0.5, inverse = TRUE))
mdata &lt;- data.frame(y = rpois(nn, ifelse(runif(nn) &lt; phi, mu1, mu2)))
mfit &lt;- vglm(y ~ 1, mix2poisson, data = mdata)
coef(mfit, matrix = TRUE)

# Compare the results with the truth
round(rbind('Estimated' = Coef(mfit), 'Truth' = c(phi, mu1, mu2)), digits = 2)

ty &lt;- with(mdata, table(y))
plot(names(ty), ty, type = "h", main = "Orange=estimate, blue=truth",
     ylab = "Frequency", xlab = "y")
abline(v = Coef(mfit)[-1], lty = 2, col = "orange", lwd = 2)
abline(v = c(mu1, mu2), lty = 2, col = "blue", lwd = 2)

# Example 2: London Times data (Lange, 1997, p.31)
ltdata1 &lt;- data.frame(deaths = 0:9,
                      freq = c(162, 267, 271, 185, 111, 61, 27, 8, 3, 1))
ltdata2 &lt;- data.frame(y = with(ltdata1, rep(deaths, freq)))

# Usually this does not work well unless nsimEIM is large
Mfit &lt;- vglm(deaths ~ 1, weight = freq, data = ltdata1,
            mix2poisson(iphi = 0.3, il1 = 1, il2 = 2.5, nsimEIM = 5000))

# This works better in general
Mfit &lt;- vglm(y ~ 1, mix2poisson(iphi = 0.3, il1 = 1, il2 = 2.5), data = ltdata2)
coef(Mfit, matrix = TRUE)
Coef(Mfit)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
