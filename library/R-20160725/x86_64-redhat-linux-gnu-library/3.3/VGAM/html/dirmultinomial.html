<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fitting a Dirichlet-Multinomial Distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for dirmultinomial {VGAM}"><tr><td>dirmultinomial {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fitting a Dirichlet-Multinomial Distribution </h2>

<h3>Description</h3>

<p>Fits a Dirichlet-multinomial distribution to a matrix response. 
</p>


<h3>Usage</h3>

<pre>
dirmultinomial(lphi = "logit", iphi = 0.10, parallel = FALSE, zero = "M")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lphi</code></td>
<td>

<p>Link function applied to the <i>phi</i> 
parameter, which lies in the open unit interval <i>(0,1)</i>.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>iphi</code></td>
<td>

<p>Numeric. Initial value for <i>phi</i>.
Must be in the open unit interval <i>(0,1)</i>.
If a failure to converge occurs then try assigning this argument
a different value.
</p>
</td></tr>
<tr valign="top"><td><code>parallel</code></td>
<td>

<p>A logical (formula not allowed here) indicating whether the
probabilities <i>pi_1,&hellip;,pi_{M-1}</i>
are to be equal via equal coefficients.
Note <i>pi_M</i> will generally be different from the
other probabilities.
Setting <code>parallel = TRUE</code> will only work if you also set
<code>zero = NULL</code> because of interference between these arguments
(with respect to the intercept term).
</p>
</td></tr>
<tr valign="top"><td><code>zero</code></td>
<td>

<p>An integer-valued vector specifying which
linear/additive predictors are modelled as intercepts only.
The values must be from the set <i>\{1,2,&hellip;,M\}</i>.
If the character <code>"M"</code> then this means the numerical value
<i>M</i>, which corresponds to linear/additive predictor associated
with <i>phi</i>.
Setting <code>zero = NULL</code> means none of the values from
the set <i>\{1,2,&hellip;,M\}</i>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Dirichlet-multinomial distribution
arises from a multinomial distribution where
the probability parameters are not constant but are generated from a
multivariate distribution called the Dirichlet distribution.
The Dirichlet-multinomial distribution has probability function
</p>
<p style="text-align: center;"><i>
        P(Y_1=y_1,&hellip;,Y_M=y_M) = C_{y_1,&hellip;,y_M}^{N_{*}}
        prod_{j=1}^{M}
        prod_{r=1}^{y_{j}}
        (pi_j (1-phi) + (r-1)phi) /
        prod_{r=1}^{N_{*}}
        (1-phi + (r-1)phi)</i></p>

<p>where <i>phi</i> is the <em>over-dispersion</em> parameter
and <i>N_* = y_1+\cdots+y_M</i>.
Here, <i>C_b^a</i> means &ldquo;<i>a</i> choose <i>b</i>&rdquo; and
refers to combinations (see <code><a href="../../base/html/choose.html">choose</a></code>).
The above formula applies to each row of the matrix response.
In this <span class="pkg">VGAM</span> family function the first <i>M-1</i> linear/additive
predictors correspond to the first <i>M-1</i> probabilities via
</p>
<p style="text-align: center;"><i>
         eta_j =  log(P[Y=j]/ P[Y=M]) = log(pi_j/pi_M)</i></p>

<p>where <i>eta_j</i> is the <i>j</i>th linear/additive predictor
(<i>eta_M=0</i> by definition for <i>P[Y=M]</i> but not for
<i>phi</i>)
and
<i>j=1,&hellip;,M-1</i>.
The <i>M</i>th linear/additive predictor corresponds to <code>lphi</code>
applied to <i>phi</i>.
</p>
<p>Note that <i>E(Y_j) = N_* pi_j</i> but 
the probabilities (returned as the fitted values)
<i>pi_j</i> are bundled together as a <i>M</i>-column matrix.
The quantities <i>N_*</i> are returned as the prior weights. 
</p>
<p>The beta-binomial distribution is a special case of
the Dirichlet-multinomial distribution when <i>M=2</i>;
see <code><a href="betabinomial.html">betabinomial</a></code>.  It is easy to show that
the first shape parameter of the beta distribution is
<i>shape1=pi*(1/phi-1)</i> and the second shape
parameter is <i>shape2=(1-pi)*(1/phi-1)</i>.
Also, <i>phi=1/(1+shape1+shape2)</i>, which
is known as the <em>intra-cluster correlation</em> coefficient.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
<code><a href="rrvglm.html">rrvglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>
<p>If the model is an intercept-only model then <code>@misc</code> (which is a
list) has a component called <code>shape</code> which is a vector with the
<i>M</i> values <i>pi_j * (1/phi-1)</i>.
</p>




<h3>Warning </h3>

<p>This <span class="pkg">VGAM</span> family function is prone to numerical problems,
especially when there are covariates.
</p>


<h3>Note</h3>

<p>The response can be a matrix of non-negative integers, or else
a matrix of sample proportions and the total number of counts in
each row specified using the <code>weights</code> argument.
This dual input option is similar to <code><a href="multinomial.html">multinomial</a></code>.
</p>
<p>To fit a &lsquo;parallel&rsquo; model with the <i>phi</i> parameter
being an intercept-only you will need to use the <code>constraints</code>
argument.
</p>
<p>Currently, Fisher scoring is implemented. To compute the expected
information matrix a <code>for</code> loop is used; this may be very slow
when the counts are large.
Additionally, convergence may be slower than usual due to round-off
error when computing the expected information matrices.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Paul, S. R., Balasooriya, U. and Banerjee, T. (2005)
Fisher information matrix of the Dirichlet-multinomial distribution.
<em>Biometrical Journal</em>, <b>47</b>, 230&ndash;236.
</p>
<p>Tvedebrink, T. (2010)
Overdispersion in allelic counts and <i>&theta;</i>-correction in
forensic genetics.
<em>Theoretical Population Biology</em>, <b>78</b>, 200&ndash;210.
</p>
<p>Yu, P. and Shaw, C. A. (2014).
An Efficient Algorithm for Accurate Computation of
the Dirichlet-Multinomial Log-Likelihood Function.
<em>Bioinformatics</em>,
<b>30</b>, 1547&ndash;54.
</p>





<h3>See Also</h3>

<p><code><a href="dirmul.old.html">dirmul.old</a></code>,
<code><a href="betabinomial.html">betabinomial</a></code>,
<code><a href="betabinomialff.html">betabinomialff</a></code>,
<code><a href="dirichlet.html">dirichlet</a></code>,
<code><a href="multinomial.html">multinomial</a></code>.
</p>


<h3>Examples</h3>

<pre>
nn &lt;- 10; M &lt;- 5
ydata &lt;- data.frame(round(matrix(runif(nn * M, max = 10), nn, M)))  # Integer counts
colnames(ydata) &lt;- paste("y", 1:M, sep = "")

fit &lt;- vglm(cbind(y1, y2, y3, y4, y5) ~ 1, dirmultinomial,
            data = ydata, trace = TRUE)
head(fitted(fit))
depvar(fit)  # Sample proportions
weights(fit, type = "prior", matrix = FALSE)  # Total counts per row

ydata &lt;- transform(ydata, x2 = runif(nn))
fit &lt;- vglm(cbind(y1, y2, y3, y4, y5) ~ x2, dirmultinomial,
            data = ydata, trace = TRUE)
## Not run:  # This does not work:
Coef(fit) 
## End(Not run)
coef(fit, matrix = TRUE)
(sfit &lt;- summary(fit))
vcov(sfit)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
