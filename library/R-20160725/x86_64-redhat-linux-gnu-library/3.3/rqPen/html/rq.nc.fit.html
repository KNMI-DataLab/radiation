<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Non-convex penalized quantile regression</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for rq.nc.fit {rqPen}"><tr><td>rq.nc.fit {rqPen}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Non-convex penalized quantile regression</h2>

<h3>Description</h3>

<p>Produces penalized quantile regression models for a range of lambdas and penalty of choice. If lambda is unselected than an iterative algorithm is used to find a maximum lambda such that the penalty is large enough to produce an intercept only model. Then range of lambdas goes from the maximum lambda found to &quot;eps&quot; on the log scale. Local linear approximation approach used by Wang, Wu and Li to extend LLA as proposed by Zou and Li (2008) to the quantile regression setting.  
</p>


<h3>Usage</h3>

<pre>
rq.nc.fit(x,y,tau=.5,lambda=NULL,weights=NULL,intercept=TRUE,
          penalty="SCAD",a=3.7,iterations=10,
          converge_criteria=1e-06,alg=ifelse(p&lt;50,"LP","QICD"),penVars=NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p> Matrix of predictors.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p> Vector of response values.</p>
</td></tr>
<tr valign="top"><td><code>tau</code></td>
<td>
<p> Conditional quantile being modeled.</p>
</td></tr>
<tr valign="top"><td><code>lambda</code></td>
<td>
<p> Tuning parameter.</p>
</td></tr>  
<tr valign="top"><td><code>weights</code></td>
<td>
<p> Weights for the objective function.</p>
</td></tr>
<tr valign="top"><td><code>intercept</code></td>
<td>
<p> Whether model should include an intercept. Constant does not need to be included in &quot;x&quot;.</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>
<p> MCP or SCAD.</p>
</td></tr>
<tr valign="top"><td><code>a</code></td>
<td>
<p> Second tuning parameter.</p>
</td></tr> 
<tr valign="top"><td><code>iterations</code></td>
<td>
<p> Number of iterations to be done for iterative LLA algorithm.</p>
</td></tr> 
<tr valign="top"><td><code>converge_criteria</code></td>
<td>
<p> Difference in betas from iteration process that would satisfy convergence.</p>
</td></tr>
<tr valign="top"><td><code>alg</code></td>
<td>
<p> Defaults for small p to linear programming (LP), see Wang, Wu and Li (2012) for details. Otherwise a coordinate descent algorithm is used (QICD), see Peng and Wang (2015) for details. Both methods rely on the One-step sparse estimates algorithm.</p>
</td></tr>
<tr valign="top"><td><code>penVars</code></td>
<td>
<p>Variables that should be penalized. With default value of NULL all variables are penalized.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional items to be sent to rq.lasso.fit.</p>
</td></tr>   
</table>


<h3>Value</h3>

<p>Returns the following:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>coefficients</code></td>
<td>
<p> Coefficients from the penalized model.</p>
</td></tr> 
<tr valign="top"><td><code>PenRho</code></td>
<td>
<p> Penalized objective function value.</p>
</td></tr> 
<tr valign="top"><td><code>residuals</code></td>
<td>
<p> Residuals from the model.</p>
</td></tr>
<tr valign="top"><td><code>rho</code></td>
<td>
<p> Objective function evaluation without the penalty.</p>
</td></tr>
<tr valign="top"><td><code>tau</code></td>
<td>
<p> Conditional quantile being modeled.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p> Sample size.</p>
</td></tr>  
<tr valign="top"><td><code>penalty</code></td>
<td>
<p> Penalty used, SCAD or MCP.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Ben Sherwood</p>


<h3>References</h3>

<p>[1] Wang, L., Wu, Y. and Li, R. (2012). Quantile regression of analyzing heterogeneity in ultra-high dimension. <em>J. Am. Statist. Ass</em>, <b>107</b>, 214&ndash;222.
</p>
<p>[2] Wu, Y. and Liu, Y. (2009). Variable selection in quantile regression. <em>Statistica Sinica</em>, <b>19</b>, 801&ndash;817.
</p>
<p>[3] Zou, H. and Li, R. (2008). One-step sparse estimates in nonconcave penalized likelihood models. <em>Ann. Statist.</em>, <b>36</b>, 1509&ndash;1533.
</p>
<p>[4] Peng, B. and Wang, L. (2015). An iterative coordinate-descent algorithm for high-dimensional nonconvex penalized quantile regression. <em>J. Comp. Graph.</em>, <b>24</b>, 676&ndash;694.
</p>


<h3>Examples</h3>

<pre>
x &lt;- matrix(rnorm(800),nrow=100)
y &lt;- 1 + x[,1] - 3*x[,5] + rnorm(100)
scadModel &lt;- rq.nc.fit(x,y,lambda=1)
</pre>

<hr /><div style="text-align: center;">[Package <em>rqPen</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</body></html>
