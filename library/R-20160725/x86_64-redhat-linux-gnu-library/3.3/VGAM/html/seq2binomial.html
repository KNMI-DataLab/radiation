<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: The Two-stage Sequential Binomial Distribution Family...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for seq2binomial {VGAM}"><tr><td>seq2binomial {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> The Two-stage Sequential Binomial Distribution Family Function </h2>

<h3>Description</h3>

<p>Estimation of the probabilities of a
two-stage binomial distribution.
</p>


<h3>Usage</h3>

<pre>
seq2binomial(lprob1 = "logit", lprob2 = "logit",
             iprob1 = NULL,    iprob2 = NULL,
             parallel = FALSE, zero = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lprob1, lprob2</code></td>
<td>
 
<p>Parameter link functions applied to the two probabilities,
called <i>p</i> and <i>q</i> below.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>iprob1, iprob2</code></td>
<td>
 
<p>Optional initial value for the first and second probabilities respectively.
A <code>NULL</code> means a value is obtained in the <code>initialize</code> slot.
</p>
</td></tr>
<tr valign="top"><td><code>parallel, zero</code></td>
<td>

<p>Details at <code><a href="Links.html">Links</a></code>.
If <code>parallel = TRUE</code> then the constraint also applies to the intercept.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This <span class="pkg">VGAM</span> family function fits the model described by
Crowder and Sweeting (1989) which is described as follows.
Each of <i>m</i> spores has a probability <i>p</i> of germinating. Of
the <i>y1</i> spores that germinate, each has a probability <i>q</i>
of bending in a particular direction. Let <i>y2</i> be the number that
bend in the specified direction. The probability model for this data is
<i>P(y1,y2) =</i>
</p>
<p style="text-align: center;"><i>
{choose(m,y1)} p^{y1} (1-p)^{m-y1}
{choose(y1,y2)} q^{y2} (1-q)^{y1-y2}</i></p>

<p>for <i>0 &lt; p &lt; 1</i>, <i>0 &lt; q &lt; 1</i>,
<i>y1=1,&hellip;,m</i>
and
<i>y2=1,&hellip;,y1</i>.
Here, <i>p</i> is <code>prob1</code>,
<i>q</i> is <code>prob2</code>.
</p>
<p>Although the Authors refer to this as the <em>bivariate binomial</em> model,
I have named it the <em>(two-stage) sequential binomial</em> model.
Fisher scoring is used.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Note</h3>

<p>The response must be a two-column matrix of sample proportions
corresponding to <i>y1</i> and <i>y2</i>.
The <i>m</i> values should be inputted with the <code>weights</code>
argument of <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
The fitted value is a two-column matrix of estimated probabilities
<i>p</i> and <i>q</i>.
A common form of error is when there are no trials
for <i>y1</i>, e.g., if <code>mvector</code> below has some values
which are zero.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

 
<p>Crowder, M. and Sweeting, T. (1989).
Bayesian inference for a bivariate binomial distribution.
<em>Biometrika</em>,
<b>76</b>,
599&ndash;603.
</p>


<h3>See Also</h3>

 
<p><code><a href="binomialff.html">binomialff</a></code>,
<code><a href="cfibrosis.html">cfibrosis</a></code>.
</p>


<h3>Examples</h3>

<pre>
sdata &lt;- data.frame(mvector = round(rnorm(nn &lt;- 100, m = 10, sd = 2)),
                    x2 = runif(nn))
sdata &lt;- transform(sdata, prob1 = logit(+2 - x2, inverse = TRUE),
                          prob2 = logit(-2 + x2, inverse = TRUE))
sdata &lt;- transform(sdata, successes1 = rbinom(nn, size = mvector,    prob = prob1))
sdata &lt;- transform(sdata, successes2 = rbinom(nn, size = successes1, prob = prob2))
sdata &lt;- transform(sdata, y1 = successes1 / mvector)
sdata &lt;- transform(sdata, y2 = successes2 / successes1)
fit &lt;- vglm(cbind(y1, y2) ~ x2, seq2binomial, weight = mvector,
            data = sdata, trace = TRUE)
coef(fit)
coef(fit, matrix = TRUE)
head(fitted(fit))
head(depvar(fit))
head(weights(fit, type = "prior"))  # Same as with(sdata, mvector)
# Number of first successes:
head(depvar(fit)[, 1] * c(weights(fit, type = "prior")))
# Number of second successes:
head(depvar(fit)[, 2] * c(weights(fit, type = "prior")) * 
                          depvar(fit)[, 1])
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
