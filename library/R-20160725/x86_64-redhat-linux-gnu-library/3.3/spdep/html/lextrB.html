<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Find extreme eigenvalues of binary symmetric spatial weights</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for lextrB {spdep}"><tr><td>lextrB {spdep}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Find extreme eigenvalues of binary symmetric spatial weights</h2>

<h3>Description</h3>

<p>The functions find extreme eigenvalues of binary symmetric spatial weights, when these form planar graphs; general weights are not permiited. <code>l_max</code> finds the largest eigenvalue using Rayleigh quotient methods of any &ldquo;listw&rdquo; object. <code>lextrB</code> first calls <code>l_max</code>, and uses its output to find the smallest eigenvalue in addition for binary symmetric spatial weights. <code>lextrW</code> extends these to find the smallest eigenvalue for intrinsically symmetric row-standardized binary weights matrices (transformed to symmetric through similarity internally). <code>lextrS</code> does the same for variance-stabilized (&ldquo;S&rdquo; style) intrinsically symmetric binary weights matrices (transformed to symmetric through similarity internally).</p>


<h3>Usage</h3>

<pre>
lextrB(lw, zero.policy = TRUE, control = list())
lextrW(lw, zero.policy=TRUE, control=list())
lextrS(lw, zero.policy=TRUE, control=list())
l_max(lw, zero.policy=TRUE, control=list())
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lw</code></td>
<td>
<p>a binary symmetric <code>listw</code> object from, for example, <code>nb2listw</code> with style &ldquo;B&rdquo; for <code>lextrB</code>, style &ldquo;W&rdquo; for <code>lextrW</code> and style &ldquo;S&rdquo; for <code>lextrS</code>; for <code>l_max</code>, the object may be asymmetric and does not have to be binary</p>
</td></tr>
<tr valign="top"><td><code>zero.policy</code></td>
<td>
<p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>a list of control arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions return approximations to the extreme eigenvalues with the eigenvectors returned as attributes of this object.
</p>


<h3>Control arguments</h3>


<dl>
<dt>trace</dt><dd><p>report values in while loops, default NULL assuming FALSE; logical</p>
</dd>
<dt>tol</dt><dd><p>tolerance for breaking while loops, default <code>.Machine$double.eps^(1/2)</code>; numeric</p>
</dd>
<dt>maxiter</dt><dd><p>maximum number of iterations in while loops, default <code>6 * (length(lw$neighbours) - 2</code>; integer</p>
</dd>
<dt>useC</dt><dd><p>use C code, default TRUE, logical (not in <code>l_max</code>)</p>
</dd>
</dl>



<h3>Note</h3>

<p>It may be necessary to modify control arguments if warnings about lack of convergence are seen.</p>


<h3>Author(s)</h3>

<p>Roger Bivand, Yongwan Chun, Daniel Griffith</p>


<h3>References</h3>

<p>Griffith, D. A. (2004). Extreme eigenfunctions of adjacency matrices for planar graphs employed in spatial analyses. <em>Linear Algebra and its Applications</em>, 388:201â€“219.</p>


<h3>Examples</h3>

<pre>
data(boston)
ab.listb &lt;- nb2listw(boston.soi, style="B")
er &lt;- range(eigenw(ab.listb))
er
res_1 &lt;- lextrB(ab.listb)
c(res_1)
if (require(igraph)) {
  B &lt;- as(ab.listb, "symmetricMatrix")
  n &lt;- length(boston.soi)
  f2 &lt;- function(x, extra=NULL) {as.vector(B %*% x)}
  ar1 &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=1, ncv=8,
    which="LA", maxiter=200))
  print(ar1$values)
  arn &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=1, ncv=8,
    which="SA", maxiter=200))
  print(arn$values)
#  ar1 &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=2, ncv=8,
#    which="BE", maxiter=300))
# "BE" gives: At line 558 of file dsaup2.f: Fortran runtime error: 
# Index '9' of dimension 1 of array 'bounds' above upper bound of 8
# "BE" 
#  print(ar1$values)
}
k5 &lt;- knn2nb(knearneigh(boston.utm, k=5))
c(l_max(nb2listw(k5, style="B")))
max(Re(eigenw(nb2listw(k5, style="B"))))
c(l_max(nb2listw(k5, style="C")))
max(Re(eigenw(nb2listw(k5, style="C"))))
ab.listw &lt;- nb2listw(boston.soi, style="W")
er &lt;- range(eigenw(similar.listw(ab.listw)))
er
res_1 &lt;- lextrW(ab.listw)
c(res_1)
if (require(igraph)) {
  B &lt;- as(similar.listw(ab.listw), "symmetricMatrix")
  ar1 &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=1, ncv=8,
    which="LA", maxiter=400))
  print(ar1$values)
  arn &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=1, ncv=8,
    which="SA", maxiter=400))
  print(arn$values)
#  ar1 &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=2, ncv=8,
#    which="BE", maxiter=300))
# "BE" gives: At line 558 of file dsaup2.f: Fortran runtime error: 
# Index '9' of dimension 1 of array 'bounds' above upper bound of 8
#  print(ar1$values)
}
ab.listw &lt;- nb2listw(boston.soi, style="S")
er &lt;- range(eigenw(similar.listw(ab.listw)))
er
res_1 &lt;- lextrS(ab.listw)
c(res_1)
if (require(igraph)) {
  B &lt;- as(similar.listw(ab.listw), "symmetricMatrix")
  ar1 &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=1, ncv=8,
    which="LA", maxiter=300))
  print(ar1$values)
  arn &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=1, ncv=8,
    which="SA", maxiter=300))
  print(arn$values)
#  ar1 &lt;- arpack(f2, sym=TRUE, options=list(n=n, nev=2, ncv=8,
#    which="BE", maxiter=300))
# "BE" gives: At line 558 of file dsaup2.f: Fortran runtime error: 
# Index '9' of dimension 1 of array 'bounds' above upper bound of 8
#  print(ar1$values)
}
</pre>

<hr /><div style="text-align: center;">[Package <em>spdep</em> version 0.6-6 <a href="00Index.html">Index</a>]</div>
</body></html>
