<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Exchangeable Bivariate cloglog Odds-ratio Model From a...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for zipebcom {VGAM}"><tr><td>zipebcom {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Exchangeable Bivariate cloglog Odds-ratio Model From a
Zero-inflated Poisson Distribution </h2>

<h3>Description</h3>

<p>Fits an exchangeable bivariate odds-ratio model to two binary
responses with a complementary log-log link.
The data are assumed to come from a zero-inflated Poisson distribution
that has been converted to presence/absence.
</p>


<h3>Usage</h3>

<pre>
zipebcom(lmu12 = "cloglog", lphi12 = "logit", loratio = "loge",
         imu12 = NULL, iphi12 = NULL, ioratio = NULL, 
         zero = c("phi12", "oratio"), tol = 0.001, addRidge = 0.001)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lmu12, imu12</code></td>
<td>

<p>Link function, extra argument and optional initial values for
the first (and second) marginal probabilities.
Argument <code>lmu12</code> should be left alone.
Argument <code>imu12</code> may be of length 2 (one element for each response).
</p>
</td></tr>
<tr valign="top"><td><code>lphi12</code></td>
<td>

<p>Link function applied to the <i>phi</i> parameter of the
zero-inflated Poisson distribution (see <code><a href="zipoisson.html">zipoisson</a></code>).
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>loratio</code></td>
<td>

<p>Link function applied to the odds ratio.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>iphi12, ioratio</code></td>
<td>

<p>Optional initial values for <i>phi</i> and the odds ratio.
See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more details.
In general, good initial values (especially for <code>iphi12</code>)
are often required, therefore use these
arguments if convergence failure occurs.
If inputted, the value of <code>iphi12</code> cannot be more than the sample
proportions of zeros in either response.
</p>
</td></tr>
</table>





<table summary="R argblock">
<tr valign="top"><td><code>zero</code></td>
<td>

<p>Which linear/additive predictor is modelled as an intercept only?
A <code>NULL</code> means none.
The default has both <i>phi</i> and the odds ratio as
not being modelled as a function of the explanatory variables (apart
from an intercept).
</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>

<p>Tolerance for testing independence.
Should be some small positive numerical value.
</p>
</td></tr>
<tr valign="top"><td><code>addRidge</code></td>
<td>

<p>Some small positive numerical value.
The first two diagonal elements of the working weight matrices are 
multiplied by <code>1+addRidge</code> to make it diagonally dominant,
therefore positive-definite.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This <span class="pkg">VGAM</span> family function fits an exchangeable bivariate odds
ratio model (<code><a href="binom2.or.html">binom2.or</a></code>) with a <code><a href="cloglog.html">cloglog</a></code> link.
The data are assumed to come from a zero-inflated Poisson (ZIP) distribution
that has been converted to presence/absence.
Explicitly, the default model is
</p>
<p style="text-align: center;"><i>
        cloglog[P(Y_j=1)/(1-phi)] =  eta_1,\ \ \ j=1,2</i></p>

<p>for the (exchangeable) marginals, and
</p>
<p style="text-align: center;"><i>
        logit[phi] =  eta_2,</i></p>

<p>for the mixing parameter, and
</p>
<p style="text-align: center;"><i>
         log[P(Y_{00}=1) P(Y_{11}=1) / (P(Y_{01}=1) P(Y_{10}=1))] =  eta_3,</i></p>

<p>specifies the dependency between the two responses. Here, the responses
equal 1 for a success and a 0 for a failure, and the odds ratio is often
written <i>psi=p00 p11 / (p10 p01)</i>.
We have <i>p10 = p01</i> because of the exchangeability.
</p>
<p>The second linear/additive predictor models the <i>phi</i>
parameter (see <code><a href="zipoisson.html">zipoisson</a></code>).
The third linear/additive predictor is the same as <code><a href="binom2.or.html">binom2.or</a></code>,
viz., the log odds ratio.
</p>
<p>Suppose a dataset1 comes from a Poisson distribution that has been
converted to presence/absence, and that both marginal probabilities
are the same (exchangeable).
Then <code>binom2.or("cloglog", exch=TRUE)</code> is appropriate.
Now suppose a dataset2 comes from a <em>zero-inflated</em> Poisson
distribution. The first linear/additive predictor of <code>zipebcom()</code>
applied to dataset2
is the same as that of
<code>binom2.or("cloglog", exch=TRUE)</code>
applied to dataset1.
That is, the <i>phi</i> has been taken care
of by <code>zipebcom()</code> so that it is just like the simpler
<code><a href="binom2.or.html">binom2.or</a></code>.
</p>
<p>Note that, for <i>eta_1</i>,
<code>mu12 = prob12 / (1-phi12)</code> where <code>prob12</code> is the probability
of a 1 under the ZIP model.
Here, <code>mu12</code> correspond to <code>mu1</code> and <code>mu2</code> in the
<code><a href="binom2.or.html">binom2.or</a></code>-Poisson model.
</p>
<p>If <i>phi=0</i> then <code>zipebcom()</code> should be equivalent to
<code>binom2.or("cloglog", exch=TRUE)</code>.
Full details are given in Yee and Dirnbock (2009).
</p>
<p>The leading <i>2 x 2</i> submatrix of the expected
information matrix (EIM) is of rank-1, not 2! This is due to the
fact that the parameters corresponding to the first two
linear/additive predictors are unidentifiable. The quick fix
around this problem is to use the <code>addRidge</code> adjustment.
The model is fitted by maximum likelihood estimation since the full
likelihood is specified. Fisher scoring is implemented.
</p>
<p>The default models <i>eta2</i> and <i>eta3</i> as
single parameters only, but this
can be circumvented by setting <code>zero=NULL</code> in order to model the 
<i>phi</i> and odds ratio as a function of all the explanatory
variables.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>
<p>When fitted, the <code>fitted.values</code> slot of the object contains the
four joint probabilities, labelled as <i>(Y1,Y2)</i> = (0,0),
(0,1), (1,0), (1,1), respectively.
These estimated probabilities should be extracted with the <code>fitted</code>
generic function.
</p>


<h3>Warning </h3>

<p>The fact that the EIM is not of full rank may mean the model is
naturally ill-conditioned.
Not sure whether there are any negative consequences wrt theory.
For now
it is certainly safer to fit <code><a href="binom2.or.html">binom2.or</a></code> to bivariate binary
responses.
</p>


<h3>Note</h3>

<p>The <code>"12"</code> in the argument names reinforce the user about the
exchangeability assumption.
The name of this <span class="pkg">VGAM</span> family function stands for
<em>zero-inflated Poisson exchangeable bivariate complementary
log-log odds-ratio model</em> or ZIP-EBCOM.
</p>
<p>See <code><a href="binom2.or.html">binom2.or</a></code> for details that are pertinent to this
<span class="pkg">VGAM</span> family function too.
Even better initial values are usually needed here.
</p>
<p>The <code>xij</code> (see <code><a href="vglm.control.html">vglm.control</a></code>) argument enables
environmental variables with different values at the two time points
to be entered into an exchangeable <code><a href="binom2.or.html">binom2.or</a></code> model.
See the author's webpage for sample code.
</p>


<h3>References</h3>

<p>Yee, T. W. and Dirnbock, T. (2009)
Models for analysing species' presence/absence data
at two time points.
Journal of Theoretical Biology, <b>259</b>(4), 684&ndash;694.
</p>


<h3>See Also</h3>

<p><code><a href="binom2.or.html">binom2.or</a></code>,
<code><a href="zipoisson.html">zipoisson</a></code>,
<code><a href="cloglog.html">cloglog</a></code>,
<code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code>.
</p>


<h3>Examples</h3>

<pre>
zdata &lt;- data.frame(x2 = seq(0, 1, len = (nsites &lt;- 2000)))
zdata &lt;- transform(zdata, eta1 =  -3 + 5 * x2,
                         phi1 = logit(-1, inverse = TRUE),
                         oratio = exp(2))
zdata &lt;- transform(zdata, mu12 = cloglog(eta1, inverse = TRUE) * (1-phi1))
tmat &lt;-  with(zdata, rbinom2.or(nsites, mu1 = mu12, oratio = oratio, exch = TRUE))
zdata &lt;- transform(zdata, ybin1 = tmat[, 1], ybin2 = tmat[, 2])

with(zdata, table(ybin1, ybin2)) / nsites  # For interest only
## Not run: 
# Various plots of the data, for interest only
par(mfrow = c(2, 2))
plot(jitter(ybin1) ~ x2, data = zdata, col = "blue")

plot(jitter(ybin2) ~ jitter(ybin1), data = zdata, col = "blue")

plot(mu12 ~ x2, data = zdata, col = "blue", type = "l", ylim = 0:1,
     ylab = "Probability", main = "Marginal probability and phi")
with(zdata, abline(h = phi1[1], col = "red", lty = "dashed"))

tmat2 &lt;- with(zdata, dbinom2.or(mu1 = mu12, oratio = oratio, exch = TRUE))
with(zdata, matplot(x2, tmat2, col = 1:4, type = "l", ylim = 0:1,
     ylab = "Probability", main = "Joint probabilities")) 
## End(Not run)

# Now fit the model to the data.
fit &lt;- vglm(cbind(ybin1, ybin2) ~ x2, zipebcom, data = zdata, trace = TRUE)
coef(fit, matrix = TRUE)
summary(fit)
vcov(fit)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
