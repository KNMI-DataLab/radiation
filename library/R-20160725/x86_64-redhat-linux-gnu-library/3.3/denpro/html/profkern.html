<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculates a level set tree of a kernel estimate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for profkern {denpro}"><tr><td>profkern {denpro}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Calculates a level set tree of a kernel estimate
</h2>

<h3>Description</h3>

<p>Given a data matrix, returns a level set tree of a kernel estimate, 
when the dimension of the estimate is less or equal to 4.
</p>


<h3>Usage</h3>

<pre>
profkern(dendat, h, N, Q, cvol=TRUE, ccen=TRUE, cfre=FALSE,
kernel="epane", compoinfo=FALSE, trunc=3, threshold=0.0000001,
sorsa="crc",hw=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>dendat</code></td>
<td>
<p>n*d data matrix; d&lt;=4</p>
</td></tr>
<tr valign="top"><td><code>h</code></td>
<td>
<p>positive real number or vector of positive real numbers; 
smoothing parameters from the largest to the smallest</p>
</td></tr>
<tr valign="top"><td><code>N</code></td>
<td>
<p>d-vector of dyadic integers &gt;=4;
number of knots for every direction: kernel
estimate will be evaluated on these knots</p>
</td></tr>
<tr valign="top"><td><code>Q</code></td>
<td>
<p>positive integer; number of quantization levels</p>
</td></tr> 
<tr valign="top"><td><code>cvol</code></td>
<td>
<p>TRUE or FALSE; TRUE if one wants that the volumes of
the separated parts of the level sets are returned, 
note that one needs the volumes for drawing a volume plot</p>
</td></tr>
<tr valign="top"><td><code>ccen</code></td>
<td>
<p>T or F; TRUE if one wants that the barycenters of the 
separated parts of the level sets are returned,
note that one needs the barycenters for drawing a barycenter plot</p>
</td></tr>
<tr valign="top"><td><code>cfre</code></td>
<td>
<p>T or F; TRUE if one wants that the frequencies for 
separated parts of the level sets are returned (not implemented)</p>
</td></tr>
<tr valign="top"><td><code>kernel</code></td>
<td>
<p>either &quot;epane&quot; or &quot;gauss&quot;; 
the kernel of the kernel estimate</p>
</td></tr>
<tr valign="top"><td><code>compoinfo</code></td>
<td>
<p>TRUE or FALSE; whether definitions of separated
regions of level sets will be returned</p>
</td></tr>
<tr valign="top"><td><code>trunc</code></td>
<td>
<p>positive real number; truncation of the Gaussian kernel
to the interval [-trunc,trunc]</p>
</td></tr>
<tr valign="top"><td><code>threshold</code></td>
<td>
<p>positive real number; kernel will be truncated to
0 if the value is smaller than the threshold (not implemented)</p>
</td></tr>
<tr valign="top"><td><code>sorsa</code></td>
<td>
<p>if not &quot;crc&quot; uses slower R code</p>
</td></tr>
<tr valign="top"><td><code>hw</code></td>
<td>
<p>lower level parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of level set trees: for each value  of h
the level set tree of the corresponding kernel estimate. 
If h is not a vector but scalar, then only one
level set tree will be returned.
The level set tree is a list of vectors. 
The elements of the vectors supply information for each node of the tree. 
Below we denote with &quot;nodenum&quot; the number of nodes of the tree.
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>parent</code></td>
<td>
<p>&quot;nodenum&quot;-vector of integers in the range 0,..., nodenum-1;
links to the parent of each node. Root nodes are marked with 0.</p>
</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
<p>&quot;nodenum&quot;-vector of positive real numbers;
level of the level set from which the set corresponding to the node
is a part of.</p>
</td></tr>
<tr valign="top"><td><code>volume</code></td>
<td>
<p>&quot;nodenum&quot;-vector of positive real numbers; 
volumes of sets corresponding to each node</p>
</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
<p>d*nodenum-matrix; barycenters of sets 
corresponding to each node</p>
</td></tr>
<tr valign="top"><td><code>invalue</code></td>
<td>
<p>&quot;nodenum&quot;-vector of positive integers;
level of the level set in terms of original frequencies 
(these values are not normalized so that the 
estimate would integrate to one</p>
</td></tr>
<tr valign="top"><td><code>component</code></td>
<td>
<p>Will be returned if &quot;compoinfo&quot;=TRUE; for each
node of the level set a tree pointer to &quot;AtomlistAtom&quot;</p>
</td></tr>
<tr valign="top"><td><code>AtomlistAtom</code></td>
<td>
<p>Will be returned if &quot;compoinfo&quot;=TRUE; pointers
to &quot;index&quot;</p>
</td></tr>
<tr valign="top"><td><code>AtomlistNext</code></td>
<td>
<p>Will be returned if &quot;compoinfo&quot;=TRUE; pointers
which define the list of atoms for each separated component (for each node
of the level set tree)</p>
</td></tr>
<tr valign="top"><td><code>index</code></td>
<td>
<p>Will be returned if &quot;compoinfo&quot;=TRUE; matrix with d
columns: determines a knot of the multivariate grid where estimate
was evaluated</p>
</td></tr>
<tr valign="top"><td><code>nodefrek</code></td>
<td>
<p>&quot;nodenum&quot;-vector of positive integers;
number of observations in the set corresponding to the node. 
This is useful in cluster analysis applications. (Not implemented.)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Applies the DynaDecompose algorithm, described in
the article
&quot;Algorithms for manipulation of level sets of nonparametric density
estimates&quot;,
by Jussi Klemela </p>


<h3>Author(s)</h3>

<p> Jussi Klemela </p>


<h3>See Also</h3>

 
<p><code><a href="plotvolu.html">plotvolu</a></code>,
<code><a href="plotbary.html">plotbary</a></code>, 
<code><a href="plottree.html">plottree</a></code>, 
</p>


<h3>Examples</h3>

<pre>
set.seed(1)
dendat&lt;-matrix(rnorm(20),10)      # 10*2 data-matrix
pk&lt;-profkern(dendat,h=1,N=c(8,8),Q=4)
plotvolu(pk)

dendat&lt;-sim.data(n=200,type="mulmod")
pk&lt;-profkern(dendat,h=1,N=c(64,64),Q=30)
plotvolu(pk)

</pre>

<hr /><div style="text-align: center;">[Package <em>denpro</em> version 0.9.2 <a href="00Index.html">Index</a>]</div>
</body></html>
