<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Beta-geometric Distribution Family Function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for betageometric {VGAM}"><tr><td>betageometric {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Beta-geometric Distribution Family Function </h2>

<h3>Description</h3>

<p>Maximum likelihood estimation for the beta-geometric distribution.
</p>


<h3>Usage</h3>

<pre>
betageometric(lprob = "logit", lshape = "loge",
              iprob = NULL,    ishape = 0.1,
              moreSummation = c(2, 100), tolerance = 1.0e-10, zero = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lprob, lshape</code></td>
<td>
 
<p>Parameter link functions applied to the
parameters <i>prob</i> and <i>phi</i>
(called <code>prob</code> and <code>shape</code> below).
The former lies in the unit interval and the latter is positive.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>iprob, ishape</code></td>
<td>
 
<p>Numeric. 
Initial values for the two parameters.
A <code>NULL</code> means a value is computed internally.
</p>
</td></tr>
<tr valign="top"><td><code>moreSummation</code></td>
<td>
 
<p>Integer, of length 2. 
When computing the expected information matrix a series summation from
0 to <code>moreSummation[1]*max(y)+moreSummation[2]</code> is made, in which the
upper limit is an approximation to infinity.
Here, <code>y</code> is the response.
</p>
</td></tr>
<tr valign="top"><td><code>tolerance</code></td>
<td>
 
<p>Positive numeric. 
When all terms are less than this then the series is deemed to have
converged.
</p>
</td></tr>
<tr valign="top"><td><code>zero</code></td>
<td>

<p>An integer-valued vector specifying which
linear/additive predictors are modelled as intercepts only.
If used, the value must be from the set {1,2}.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A random variable <i>Y</i> has a 2-parameter beta-geometric distribution
if <i>P(Y=y) = prob * (1-prob)^y</i>
for <i>y=0,1,2,...</i> where
<i>prob</i> are generated from a standard beta distribution with
shape parameters <code>shape1</code> and <code>shape2</code>.
The parameterization here is to focus on the parameters
<i>prob</i> and 
<i>phi = 1/(shape1+shape2)</i>,
where <i>phi</i> is <code>shape</code>.
The default link functions for these ensure that the appropriate range
of the parameters is maintained.
The mean of <i>Y</i> is
<i>E(Y) = 
       shape2 / (shape1-1) = (1-prob) / (prob-phi)</i>
if <code>shape1 &gt; 1</code>, and if so, then this is returned as
the fitted values.
</p>
<p>The geometric distribution is a special case of the beta-geometric
distribution with <i>phi=0</i> (see <code><a href="geometric.html">geometric</a></code>).
However, fitting data from a geometric distribution may result in
numerical problems because the estimate of <i>log(phi)</i>
will 'converge' to <code>-Inf</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Note</h3>

<p>The first iteration may be very slow;
if practical, it is best for the <code>weights</code> argument of
<code><a href="vglm.html">vglm</a></code> etc. to be used rather than inputting a very
long vector as the response, i.e., <code>vglm(y ~ 1, ..., weights = wts)</code>
is to be preferred over <code>vglm(rep(y, wts) ~ 1, ...)</code>.
If convergence problems occur try inputting some values of argument
<code>ishape</code>.
</p>
<p>If an intercept-only model is fitted then the <code>misc</code> slot of the
fitted object has list components <code>shape1</code> and <code>shape2</code>.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee </p>


<h3>References</h3>

<p>Paul, S. R. (2005)
Testing goodness of fit of the geometric distribution:
an application to human fecundability data.
<em>Journal of Modern Applied Statistical Methods</em>, <b>4</b>, 425&ndash;433.
</p>


<h3>See Also</h3>

 
<p><code><a href="geometric.html">geometric</a></code>,
<code><a href="betaff.html">betaff</a></code>,
<code><a href="betageomUC.html">rbetageom</a></code>.
</p>


<h3>Examples</h3>

<pre>
bdata &lt;- data.frame(y = 0:11, wts = c(227,123,72,42,21,31,11,14,6,4,7,28))
fitb &lt;- vglm(y ~ 1, betageometric, data = bdata, weight = wts, trace = TRUE)
fitg &lt;- vglm(y ~ 1,     geometric, data = bdata, weight = wts, trace = TRUE)
coef(fitb, matrix = TRUE)
Coef(fitb)
sqrt(diag(vcov(fitb, untransform = TRUE)))
fitb@misc$shape1
fitb@misc$shape2
# Very strong evidence of a beta-geometric:
pchisq(2 * (logLik(fitb) - logLik(fitg)), df = 1, lower.tail = FALSE)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
