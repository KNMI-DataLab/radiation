<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Choynowski probability map values</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for choynowski {spdep}"><tr><td>choynowski {spdep}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Choynowski probability map values</h2>

<h3>Description</h3>

<p>Calculates Choynowski probability map values.
</p>


<h3>Usage</h3>

<pre>
choynowski(n, x, row.names=NULL, tol = .Machine$double.eps^0.5, legacy=FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>n</code></td>
<td>
<p>a numeric vector of counts of cases</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>a numeric vector of populations at risk</p>
</td></tr>
<tr valign="top"><td><code>row.names</code></td>
<td>
<p>row names passed through to output data frame</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>accumulate values for observed counts &gt;= expected until value less than tol</p>
</td></tr>
<tr valign="top"><td><code>legacy</code></td>
<td>
<p>default FALSE using vectorised alternating side <code>ppois</code> version, if true use original version written from sources and iterating down to <code>tol</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>pmap</code></td>
<td>
<p>Poisson probability map values: probablility of getting a more &ldquo;extreme&rdquo; count than actually observed, one-tailed with less than expected and more than expected folded together</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>logical: TRUE if observed count less than expected</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Choynowski, M (1959) Maps based on probabilities, Journal of
the American Statistical Association, 54, 385&ndash;388; Cressie, N, Read,
TRC (1985), Do sudden infant deaths come in clusters? Statistics and
Decisions, Supplement Issue 2, 333&ndash;349; Bailey T, Gatrell A (1995)
Interactive Spatial Data Analysis, Harlow: Longman, pp. 300&ndash;303.</p>


<h3>See Also</h3>

<p><code><a href="probmap.html">probmap</a></code></p>


<h3>Examples</h3>

<pre>
example(auckland)
res &lt;- choynowski(auckland$M77_85, 9*auckland$Und5_81)
resl &lt;- choynowski(auckland$M77_85, 9*auckland$Und5_81, legacy=TRUE)
all.equal(res, resl)
rt &lt;- sum(auckland$M77_85)/sum(9*auckland$Und5_81)
ch_ppois_pmap &lt;- numeric(length(auckland$Und5_81))
side &lt;- c("greater", "less")
for (i in seq(along=ch_ppois_pmap)) {
  ch_ppois_pmap[i] &lt;- poisson.test(auckland$M77_85[i], r=rt,
    T=(9*auckland$Und5_81[i]), alternative=side[(res$type[i]+1)])$p.value
}
all.equal(ch_ppois_pmap, res$pmap)

res1 &lt;- probmap(auckland$M77_85, 9*auckland$Und5_81)
table(abs(res$pmap - res1$pmap) &lt; 0.00001, res$type)
lt005 &lt;- (res$pmap &lt; 0.05) &amp; (res$type)
ge005 &lt;- (res$pmap &lt; 0.05) &amp; (!res$type)
cols &lt;- rep("white", length(lt005))
cols[lt005] &lt;- grey(2/7)
cols[ge005] &lt;- grey(5/7)
plot(auckland, col=cols) 
legend("bottomleft", fill=grey(c(2,5)/7), legend=c("low", "high"), bty="n")
</pre>

<hr /><div style="text-align: center;">[Package <em>spdep</em> version 0.6-6 <a href="00Index.html">Index</a>]</div>
</body></html>
