<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot a model's response over a range of predictor values</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plotmo {plotmo}"><tr><td>plotmo {plotmo}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot a model's response over a range of predictor values</h2>

<h3>Description</h3>

<p>Plot a model's response when varying one or two predictors while
holding the other predictors constant.  A poor man's partial
dependence plot.
</p>
<p>Please see the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>.
</p>


<h3>Usage</h3>

<pre>
plotmo(object=stop("no 'object' argument"),
    type=NULL, nresponse=NA,
    pt.col=0, jitter=.5, smooth.col=0, level=0,
    func=NULL, inverse.func=NULL, nrug=0, grid.col=0,
    type2="persp",
    degree1=TRUE, all1=FALSE, degree2=TRUE, all2=FALSE,
    do.par=TRUE, clip=TRUE, ylim=NULL, caption=NULL, trace=0,
    grid.func=median, grid.levels=NULL, extend=0,
    ngrid1=50, ngrid2=20, ndiscrete=5, npoints=3000,
    center=FALSE, xflip=FALSE, yflip=FALSE, swapxy=FALSE, int.only.ok=TRUE,
    ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>

<p>The model object.
</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>

<p>Type parameter passed to <code><a href="../../stats/html/predict.html">predict</a></code>.
For allowed values see the <code>predict</code> method for
your <code>object</code> (such as <code><a href="../../earth/html/predict.earth.html">predict.earth</a></code>).
By default, <code>plotmo</code> tries to automatically select a suitable
value for the model in question (usually <code>"response"</code>)
but this will not always be correct.
Use <code>trace=1</code> to see the <code>type</code> argument passed to <code>predict</code>.
</p>
</td></tr>
<tr valign="top"><td><code>nresponse</code></td>
<td>

<p>Which column to use when <code>predict</code> returns multiple columns.
This can be a column index or column name
(which may be abbreviated, partial matching is used).
</p>
</td></tr>
<tr valign="top"><td><code>pt.col</code></td>
<td>

<p>The color of response points (or response sites in degree2 plots).
This refers to the response <code>y</code> in the data
used to build the model.
Note that the displayed points are jittered by default
(see the <code>jitter</code> argument).
<br />
Default is <code>0</code>, display no response points.
<br />
This can be a vector, like all such arguments, for example
<code>pt.col = as.numeric(survived)+2</code>.
<br />
You can modify the plotted points with
<code>pt.pch</code>, <code>pt.cex</code>, etc.
(these get passed via <code>plotmo</code>'s &ldquo;<code>...</code>&rdquo; argument).
To label the points, set <code>pt.pch</code> to a character vector.
</p>
</td></tr>
<tr valign="top"><td><code>jitter</code></td>
<td>

<p>Applies only if <code>pt.col</code> is specified.<br />
The default is <code>jitter=.5</code>, automatically apply some jitter to the points.
Points are jittered horizontally and vertically.<br />
Use <code>jitter=0</code> to disable this automatic jittering.
Otherwise something like <code>jitter=1</code>, but the optimum value is data dependent.
</p>
</td></tr>
<tr valign="top"><td><code>smooth.col</code></td>
<td>

<p>Color of smooth line through the response points.
(The points themselves will not be plotted unless <code>pt.col</code> is specified.)
Default is <code>0</code>, no smooth line.
<br />
Example:</p>
<pre>    mod &lt;- lm(Volume~Height, data=trees)
    plotmo(mod, pt.color=1, smooth.col=2)</pre>
<p>You can adjust the amount of smoothing with <code>smooth.f</code>.
This gets passed as <code>f</code> to <code><a href="../../stats/html/lowess.html">lowess</a></code>.
The default is <code>.5</code>.
Lower values make the line more wiggly.
</p>
</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>

<p>Draw estimated confidence or prediction interval bands at the given <code>level</code>,
if the predict method for the model supports them.<br />
Default is <code>0</code>, bands not plotted.
Else a fraction, for example <code>level=.95</code>.
See &ldquo;<em>Prediction intervals</em>&rdquo; in the <code>plotmo</code> vignette.
Example:</p>
<pre>    mod &lt;- lm(log(Volume)~log(Girth), data=trees)
    plotmo(mod, level=.95)</pre>
<p>You can modify the color of the bands with <code>level.shade</code> and <code>level.shade2</code>.
</p>
</td></tr>
<tr valign="top"><td><code>func</code></td>
<td>

<p>Superimpose <code>func(x)</code> on the plot.
Example:</p>
<pre>    mod &lt;- lm(Volume~Girth, data=trees)
    estimated.volume &lt;- function(x) .17 * x$Girth^2
    plotmo(mod, pt.col=2, func=estimated.volume)</pre>
<p>The <code>func</code> is called for each plot with a single argument which
is a data frame with columns in the same order as the predictors
in the <code>formula</code> or <code>x</code> used to build the model.
Use <code>trace=2</code> to see the column names and first few rows of this dataframe.
</p>
</td></tr>
<tr valign="top"><td><code>inverse.func</code></td>
<td>

<p>A function applied to the response before plotting.
Useful to transform a transformed response back to the original scale.
Example:</p>
<pre>    mod &lt;- lm(log(Volume)~., data=trees)
    plotmo(mod, inverse.func=exp)    # exp() is inverse of log()

</pre>
</td></tr>
<tr valign="top"><td><code>nrug</code></td>
<td>

<p>Number of points in the <code><a href="../../graphics/html/rug.html">rug</a></code> rug along the bottom of the plot
(a sample of <code>nrug</code> points is plotted).
Default is <code>0</code>, no rug.
Use <code>nrug=TRUE</code> or <code>-1</code> for all points.
The rug is jittered to match the jittered points
(see the <code>jitter</code> argument).
<br />
The special value <code>nrug="density"</code> means plot the
density of the points along the bottom.
You can modify the <code><a href="../../stats/html/density.html">density</a></code> plot with <code>density.adjust</code> (default is <code>.5</code>),
<code>density.col</code>, <code>density.lty</code>, etc.
</p>
</td></tr>
<tr valign="top"><td><code>grid.col</code></td>
<td>

<p>Default is <code>0</code>, no grid.
Else add a background <code><a href="../../graphics/html/grid.html">grid</a></code>
of the specified color to the degree1 plots.
The special value <code>grid.col=TRUE</code> is treated as <code>"lightgray"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>type2</code></td>
<td>

<p>Degree2 plot type.
One of <code>"<a href="../../graphics/html/persp.html">persp</a>"</code> (default),
<code>"<a href="../../graphics/html/image.html">image</a>"</code>, or <code>"<a href="../../graphics/html/contour.html">contour</a>"</code>.
You can pass arguments to these functions if necessary by using
<code>persp.</code>, <code>image.</code>, or <code>contour.</code> as a prefix.
Examples:</p>
<pre>    plotmo(mod, persp.ticktype="detailed", persp.nticks=2)
    plotmo(mod, type2="image")
    plotmo(mod, type2="image", image.col=heat.colors(12))
    plotmo(mod, type2="contour", contour.col=2, contour.labcex=.4)
    </pre>
</td></tr>
<tr valign="top"><td><code>degree1</code></td>
<td>

<p>An index vector specifying which subset of degree1 (main effect) plots to include
(after selecting the relevant predictors as described in
&ldquo;<em>Which variables are plotted?</em>&rdquo; in the <code>plotmo</code> vignette).
<br />
Default is <code>TRUE</code>, meaning all (the <code>TRUE</code> gets recycled).
Use <code>degree=FALSE</code> or <code>0</code> for no degree1 plots.
<br />
Can also be a character vector
specifying which variables to plot
e.g. <code>degree1=c("wind", "vis")</code>.
Variable are matched with <code><a href="../../base/html/grep.html">grep</a></code>.  Thus <code>"wind"</code> will match
all variables with <code>"wind"</code> anywhere in their name. Use <code>"^wind$"</code>
to match only the variable named <code>"wind"</code>.
<br />
Note that an integer <code>degree1</code> indexes plots on the page,
not columns of <code>x</code>.
Probably the easiest way to use this argument (and <code>degree2</code>) is to
first use the default (and possibly <code>all1=TRUE</code>)
to plot all figures.  This shows how the figures are numbered.
Then replot using <code>degree1</code> to select the figures you want,
for example <code>degree1=c(1,3,4)</code>.
</p>
</td></tr>
<tr valign="top"><td><code>all1</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to plot all predictors,
not just those usually selected by <code>plotmo</code>.
<br />
The <code>all1</code> argument increases the number of plots;
the <code>degree1</code> argument reduces the number of plots.
</p>
</td></tr>
<tr valign="top"><td><code>degree2</code></td>
<td>

<p>An index vector specifying which subset of degree2 (interaction) plots to include.
<br />
Default is <code>TRUE</code> meaning all
(after selecting the relevant interaction terms as described in
&ldquo;<em>Which variables are plotted?</em>&rdquo; in the <code>plotmo</code> vignette).
<br />
Can also be a character vector specifying which variables to plot
(<code><a href="../../base/html/grep.html">grep</a></code> is used for matching).
For example, <code>degree2="vis"</code> selects degree2 plots
for the <code>vis</code> variable.
</p>
</td></tr>
<tr valign="top"><td><code>all2</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to plot all pairs of predictors,
not just those usually selected by <code>plotmo</code>.
</p>
</td></tr>
<tr valign="top"><td><code>do.par</code></td>
<td>
<p>One of <code>NULL</code>, <code>FALSE</code>, <code>TRUE</code>, or <code>2</code>, as follows:
</p>
<p><code>do.par=NULL</code>. Same as <code>do.par=FALSE</code> if the
number of plots is one; else the same as <code>TRUE</code>.
</p>
<p><code>do.par=FALSE</code>. Use the current <code><a href="../../graphics/html/par.html">par</a></code> settings.
You can pass additional graphics parameters in the &ldquo;<code>...</code>&rdquo; argument.
</p>
<p><code>do.par=TRUE</code> (default). Start a new page and call <code><a href="../../graphics/html/par.html">par</a></code> as
appropriate to display multiple plots on the same page.
This automatically sets parameters like <code>mfrow</code> and <code>mar</code>.
You can pass additional graphics parameters in the &ldquo;<code>...</code>&rdquo; argument.



</p>
<p><code>do.par=2</code>.  Like <code>do.par=TRUE</code> but don't restore
the <code><a href="../../graphics/html/par.html">par</a></code> settings to their original state when <code>plotmo</code> exits,
so you can add something to the plot.
<br />
</p>
</td></tr>
<tr valign="top"><td><code>clip</code></td>
<td>

<p>The default is <code>clip=TRUE</code>, meaning ignore very outlying
predictions  when determining the automatic <code>ylim</code>.
This keeps <code>ylim</code> fairly compact while
still covering all or nearly all the data,
even if there are a few crazy predicted values.
See &ldquo;<em>The <code>ylim</code> and <code>clip</code> arguments</em>&rdquo; in the <code>plotmo</code> vignette.
<br />
Use <code>clip=FALSE</code> for no clipping.
</p>
</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
<p>Three possibilities:
<br />
<code>ylim=NULL</code> (default). Automatically determine a <code>ylim</code>
to use across all graphs.
<br />
<code>ylim=NA</code>. Each graph has its own <code>ylim</code>.
<br />
<code>ylim=c(ymin,ymax)</code>. Use the specified limits across all graphs.
<br />
</p>
</td></tr>
<tr valign="top"><td><code>caption</code></td>
<td>

<p>Overall caption.  By default create the caption automatically.
Use <code>caption=""</code> for no caption.
(Use <code>main</code> to set the title of individual plots, can be a vector.)
</p>
</td></tr>
<tr valign="top"><td><code>trace</code></td>
<td>

<p>Default is <code>0</code>.
<br />
<code>trace=1</code> (or <code>TRUE</code>) for a summary trace (shows how
<code><a href="../../stats/html/predict.html">predict</a></code> is invoked for the current object).
<br />
<code>trace=2</code> for detailed tracing.
<br />
<code>trace=-1</code> inhibits the messages usually issued by <code>plotmo</code>,
like the &ldquo;<code>plotmo grid:</code>&rdquo; and &ldquo;<code>nothing to plot</code>&rdquo;
messages. Error and warning messages will be printed as usual.
<br />
<br />
</p>
</td></tr>
<tr valign="top"><td><code>grid.func</code></td>
<td>

<p>Function applied to columns of the <code>x</code> matrix to pin the values of
variables not on the axes.
Default is <code><a href="../../stats/html/median.html">median</a></code>.
This argument is not related to the <code>grid.col</code> argument.
Examples:</p>
<pre>    plotmo(mod, grid.func=mean)
    grid.func &lt;- function(x, ...) quantile(x)[2] # 25% quantile
    plotmo(mod, grid.func=grid.func)</pre>
<p>This argument is ignored for factors.  The first level of
factors is used. That can be changed with <code>grid.levels</code>, see below.
</p>
</td></tr>
<tr valign="top"><td><code>grid.levels</code></td>
<td>

<p>Default is <code>NULL</code>.
Else a list of variables and their fixed value to be used
when the variable is not on the axis.
Supersedes <code>grid.func</code> for variables in the list.
Names and values can be abbreviated, partial matching is used.
Example:</p>
<pre>    plotmo(mod, grid.levels=list(sex="m", age=21))

</pre>
</td></tr>
<tr valign="top"><td><code>extend</code></td>
<td>

<p>Amount to extend the horizontal axis in each plot.
The default is <code>0</code>, do not extend
(i.e. use the range of the variable in the training data).
Else something like <code>extend=.5</code>, which will extend both the lower
and upper <code>xlim</code> of each plot by 50%.<br />
This argument is useful if you want to see how the model performs
on data that is beyond the training data;
for example, you want to see how a time-series model performs on future data.<br />
This argument is currently implemented only for degree1 plots.
Factors and discrete variables (see the <code>ndiscrete</code> argument)
are not extended.
</p>
</td></tr>
<tr valign="top"><td><code>ngrid1</code></td>
<td>

<p>Number of equally spaced x values in each degree1 plot.
Default is <code>50</code>.
</p>
</td></tr>
<tr valign="top"><td><code>ngrid2</code></td>
<td>

<p>Grid size for degree2 plots (<code>ngrid2 x ngrid2</code> points are plotted).
Default is <code>20</code>.
<br />
The default will sometimes be too small for <code>contour</code> and <code>image</code> plots.
<br />
With large <code>ngrid2</code> values, <code>persp</code> plots look better with
<code>persp.border=NA</code>.
</p>
</td></tr>
<tr valign="top"><td><code>npoints</code></td>
<td>

<p>Number of response points to be plotted
(a sample of <code>npoints</code> points is plotted).
Applies only if <code>pt.col</code> is specified.
<br />
The default is 3000 (not all, to avoid overplotting on large models).
Use <code>npoints=TRUE</code> or <code>-1</code> for all points.
</p>
</td></tr>
<tr valign="top"><td><code>ndiscrete</code></td>
<td>

<p>Default <code>5</code> (a somewhat arbitrary value).
Variables with no more than <code>ndiscrete</code> unique values
are plotted as quantized in plots (a staircase rather than a curve).
Factors are always considered discrete.
</p>
</td></tr>
<tr valign="top"><td><code>int.only.ok</code></td>
<td>

<p>Plot the model even if it is an intercept-only model.
Do this by plotting a single degree1 plot for the first predictor.
<br />
The default is <code>TRUE</code>.
Use <code>int.only.ok=FALSE</code> to instead issue an error message for intercept-only models.
</p>
</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>

<p>Center the plotted response.
Default is <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>xflip</code></td>
<td>

<p>Default <code>FALSE</code>.
Use <code>TRUE</code> to flip the direction of the <code>x</code> axis.
This argument (and <code>yflip</code> and <code>swapxy</code>) is useful when comparing
to a plot from another source and you want the axes to be the same.
(Note that <code>xflip</code> and <code>yflip</code> cannot be used on the <code>persp</code> plots,
a limitation of the <code>persp</code> function.)
</p>
</td></tr>
<tr valign="top"><td><code>yflip</code></td>
<td>

<p>Default <code>FALSE</code>.
Use <code>TRUE</code> to flip the direction of the y axis of the degree2 graphs.
</p>
</td></tr>
<tr valign="top"><td><code>swapxy</code></td>
<td>

<p>Default <code>FALSE</code>.
Use <code>TRUE</code> to swap the x and y axes on the degree2 graphs.
<br />
<br />
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>Dot arguments are passed to the predict and plot functions.
Dot argument names, whether prefixed or not, should be specified in full
and not abbreviated.
<br />
<br />
&ldquo;Prefixed&rdquo; arguments are passed directly to the associated function.
For example the prefixed argument <code>persp.col="pink"</code> passes
<code>col="pink"</code> to <code>persp()</code>, overriding the global
<code>col</code> setting.
To send an argument to <code>predict</code> whose name may alias with
<code>plotmo</code>'s arguments, use <code>predict.</code> as a prefix.
Example:</p>
<pre>    plotmo(mod, s=1)           # error:  arg matches multiple formal args
    plotmo(mod, predict.s=1)   # ok now: s=1 will be passed to predict()
</pre>
<p>The prefixes recognized by <code>plotmo</code> are:</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>predict.</code> </td><td style="text-align: left;"> passed to the <code><a href="../../stats/html/predict.html">predict</a></code> method for the model
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>degree1.</code> </td><td style="text-align: left;"> modifies degree1 plots e.g. <code>degree1.col=3, degree1.lwd=2</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>persp.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="../../graphics/html/persp.html">persp</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contour.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="../../graphics/html/contour.html">contour</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>image.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="../../graphics/html/image.html">image</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>pt.</code> </td><td style="text-align: left;"> see the <code>pt.col</code> argument
(arguments passed to <code><a href="../../graphics/html/points.html">points</a></code> and <code><a href="../../graphics/html/text.html">text</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>smooth.</code> </td><td style="text-align: left;"> see the <code>smooth.col</code> argument
(arguments passed to <code><a href="../../graphics/html/lines.html">lines</a></code> and <code><a href="../../stats/html/lowess.html">lowess</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>level.</code> </td><td style="text-align: left;"> see the <code>level</code> argument
(<code>level.shade</code>, <code>level.shade2</code>, and arguments for <code><a href="../../graphics/html/polygon.html">polygon</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>func.</code> </td><td style="text-align: left;"> see the <code>func</code> argument
(arguments passed to <code><a href="../../graphics/html/lines.html">lines</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>rug.</code> </td><td style="text-align: left;"> see the <code>nrug</code> argument
(<code>rug.jitter</code>, and arguments passed to <code><a href="../../graphics/html/rug.html">rug</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>density.</code> </td><td style="text-align: left;"> see the <code>nrug</code> (sic) argument
(<code>density.adjust</code>, and arguments passed to <code><a href="../../graphics/html/lines.html">lines</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>grid.</code> </td><td style="text-align: left;"> see the <code>grid.col</code> argument
(arguments passed to <code><a href="../../graphics/html/grid.html">grid</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>caption.</code> </td><td style="text-align: left;"> see the <code>caption</code> argument
(arguments passed to <code><a href="../../graphics/html/mtext.html">mtext</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>par.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="../../graphics/html/par.html">par</a></code>
(only necessary if a <code>par</code> argument name clashes
with a <code>plotmo</code> argument)
</td>
</tr>

</table>

<p>The <code>cex</code> argument is relative, so
specifying <code>cex=1</code> is the same as not specifying <code>cex</code>.
</p>
<p>For backwards compatibility, some dot arguments are supported but not
explicitly documented.  For example, the old argument <code>col.response</code>
is no longer in <code>plotmo</code>'s formal argument list, but is still
accepted and treated like the new argument <code>pt.col</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In general this function won't work on models that don't save the call
and data with the model in a standard way.
For further discussion please see &ldquo;<em>Accessing the model
data</em>&rdquo; in the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>.
Package authors may want to look at
<a href="../doc/modguide.pdf">Guidelines for S3 Regression Models</a>.
</p>
<p>By default, <code>plotmo</code> tries to use sensible model-dependent
defaults when calling <code>predict</code>.
Use <code>trace=1</code> to see the arguments passed to <code>predict</code>.
You can change the defaults by using <code>plotmo</code>'s <code>type</code> argument,
and by using dot arguments prefixed with
<code>predict.</code> (see the description of &ldquo;<code>...</code>&rdquo; above).
</p>


<h3>See Also</h3>

<p>Please see the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>.
</p>


<h3>Examples</h3>

<pre>
if (require(rpart)) {
    data(kyphosis)
    rpart.model &lt;- rpart(Kyphosis~., data=kyphosis)
    plotmo(rpart.model, type="prob", nresponse="present")
}
if (require(earth)) {
    data(ozone1)
    earth.model &lt;- earth(O3 ~ ., data=ozone1, degree=2)
    plotmo(earth.model)
}
</pre>

<hr /><div style="text-align: center;">[Package <em>plotmo</em> version 3.2.0 <a href="00Index.html">Index</a>]</div>
</body></html>
