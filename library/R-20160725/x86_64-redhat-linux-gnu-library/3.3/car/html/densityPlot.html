<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Nonparametric Density Estimates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for densityPlot {car}"><tr><td>densityPlot {car}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Nonparametric Density Estimates
</h2>

<h3>Description</h3>

<p><code>densityPlot</code> contructs and graphs nonparametric density estimates, possibly conditioned on a factor.
It is a wrapper for the standard <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code><a href="../../stats/html/density.html">density</a></code> function.
</p>


<h3>Usage</h3>

<pre>
densityPlot(x, ...)

## Default S3 method:
densityPlot(x, g, bw = "SJ", adjust=1,
    kernel = c("gaussian", "epanechnikov", "rectangular", 
               "triangular", "biweight", "cosine", "optcosine"),
    xlab = deparse(substitute(x)), ylab = "Density", col = palette(), 
    lty = seq_along(col), lwd = 2, grid=TRUE,
    legend.location = "topright", legend.title = deparse(substitute(g)), 
    show.bw = FALSE, rug = TRUE, ...)
    
## S3 method for class 'formula'
densityPlot(formula, data = NULL, subset, na.action = NULL, xlab, ylab, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a numeric variable, the density of which is estimated.</p>
</td></tr>
<tr valign="top"><td><code>g</code></td>
<td>
<p>an optional factor to divide the data.</p>
</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> model formula, of the form <code>~ variable</code> to estimate the unconditional
density of <code>variable</code>, or <code>variable ~ factor</code> to estimate the density of <code>variable</code>
within each level of <code>factor</code>.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>an optional data frame containing the data.</p>
</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
<p>an optional vector defining a subset of the data.</p>
</td></tr>
<tr valign="top"><td><code>na.action</code></td>
<td>
<p>a function to handle missing values; defaults to the value of the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>na.action</code> option,
initially set to <code><a href="../../stats/html/na.fail.html">na.omit</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>bw</code></td>
<td>
<p>the bandwidth for the density estimate(s); either the quoted name of a rule to
compute the bandwidth, or a numeric value; the default is <code>"SJ"</code>; if plotting by groups, <code>bw</code>
may be a vector of values or rules, one for each group. See <code><a href="../../stats/html/density.html">density</a></code> and <code><a href="../../stats/html/bandwidth.html">bw.SJ</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>adjust</code></td>
<td>
<p>a multiplicative adjustment factor for the bandwidth; the default, <code>1</code>, indicates no adjustment;
if plotting by groups, <code>adjust</code> may be a vector of adjustment factors, one for each group.</p>
</td></tr>
<tr valign="top"><td><code>kernel</code></td>
<td>
<p>kernel function; the default is &quot;gaussian&quot; (see <code><a href="../../stats/html/density.html">density</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>label for the horizontal-axis; defaults to the name of the variable <code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>label for the vertical axis; defaults to <code>"Density"</code>.</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>vector of colors for the density estimate(s); defaults to the color <code><a href="../../grDevices/html/palette.html">palette</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
<p>vector of line types for the density estimate(s); defaults to the successive integers, starting at 1.</p>
</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
<p>line width for the density estimate(s); defaults to 2.</p>
</td></tr>
<tr valign="top"><td><code>grid</code></td>
<td>
<p>if <code>TRUE</code> (the default), grid lines are drawn on the plot.</p>
</td></tr>
<tr valign="top"><td><code>legend.location</code></td>
<td>
<p>location for the legend when densities are plotted for several groups; defaults to
<code>"upperright"</code>; see <code><a href="../../graphics/html/legend.html">legend</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>legend.title</code></td>
<td>
<p>label for the legend, which is drawn if densities are plotted by groups; the default is
the name of the factor g.</p>
</td></tr>
<tr valign="top"><td><code>show.bw</code></td>
<td>
<p>if <code>TRUE</code>, show the bandwidth(s) in the horizontal-axis label or (for multiple groups)
the legend; the default is <code>FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>rug</code></td>
<td>
<p>if <code>TRUE</code> (the default), draw a rug plot (one-dimentional scatterplot) at the bottom of the density estimate.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>arguments to be passed to <code><a href="../../graphics/html/plot.html">plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>These functions return <code>NULL</code> invisibly and draw graphs.
</p>


<h3>Author(s)</h3>

<p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a>
</p>


<h3>References</h3>

<p>W. N. Venables and B. D. Ripley (2002) <em>Modern Applied Statistics with S</em>. New York: Springer.</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/density.html">density</a></code>, <code><a href="../../stats/html/bandwidth.html">bw.SJ</a></code>, <code>link{plot.density}</code>
</p>


<h3>Examples</h3>

<pre>
densityPlot(~ income, show.bw=TRUE, data=Prestige)
densityPlot(income ~ type, data=Prestige)
</pre>

<hr /><div style="text-align: center;">[Package <em>car</em> version 2.1-3 <a href="00Index.html">Index</a>]</div>
</body></html>
