<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Simulate Responses for VGLMs and VGAMs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for simulate.vlm {VGAM}"><tr><td>simulate.vlm {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Simulate Responses for VGLMs and VGAMs</h2>

<h3>Description</h3>

<p>Simulate one or more responses from the distribution
corresponding to a fitted model object.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'vlm'
simulate(object, nsim = 1, seed = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an object representing a fitted model.
Usually an object of class
<code><a href="vglm-class.html">vglm-class</a></code>
or
<code><a href="vgam-class.html">vgam-class</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>nsim, seed</code></td>
<td>

<p>Same as <code><a href="../../stats/html/simulate.html">simulate</a></code>.
</p>
</td></tr>
</table>









<table summary="R argblock">
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional optional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a methods function for <code><a href="../../stats/html/simulate.html">simulate</a></code>
and hopefully should behave in a very similar manner.
Only <span class="pkg">VGAM</span> family functions with a <code>simslot</code> slot
have been implemented for <code><a href="../../stats/html/simulate.html">simulate</a></code>.
</p>


<h3>Value</h3>

<p>Similar to <code><a href="../../stats/html/simulate.html">simulate</a></code>.
Note that many <span class="pkg">VGAM</span> family functions can handle multiple responses. 
This can result in a longer data frame with more rows
(<code>nsim</code> multiplied by <code>n</code> rather than the
ordinary <code>n</code>).
In the future an argument may be available so that there
is always <code>n</code> rows no matter how many responses were
inputted.
</p>












<h3>Warning</h3>

<p>With multiple response and/or multivariate responses,
the order of the elements may differ.
For some <span class="pkg">VGAM</span> families, the order is 
<i>n x N x F</i>,
where <i>n</i> is the sample size,
<i>N</i> is <code>nsim</code> and
<i>F</i> is <code>ncol(fitted(vglmObject))</code>.
For other <span class="pkg">VGAM</span> families, the order is 
<i>n x F x N</i>.
An example of each is given below.
</p>


<h3>See Also</h3>

<p>Currently the <span class="pkg">VGAM</span> family functions with a
<code>simslot</code> slot are:
<code><a href="alaplace3.html">alaplace1</a></code>,
<code><a href="alaplace3.html">alaplace2</a></code>,
<code><a href="betabinomial.html">betabinomial</a></code>,
<code><a href="betabinomialff.html">betabinomialff</a></code>,
<code><a href="betaR.html">betaR</a></code>,
<code><a href="betaff.html">betaff</a></code>,
<code><a href="biamhcop.html">biamhcop</a></code>,
<code><a href="bifrankcop.html">bifrankcop</a></code>,
<code><a href="bilogistic.html">bilogistic</a></code>,
<code><a href="binomialff.html">binomialff</a></code>,
<code><a href="binormal.html">binormal</a></code>,
<code><a href="binormalcop.html">binormalcop</a></code>,
<code><a href="biclaytoncop.html">biclaytoncop</a></code>,
<code><a href="cauchy.html">cauchy</a></code>,
<code><a href="cauchy.html">cauchy1</a></code>,
<code><a href="chisq.html">chisq</a></code>,
<code><a href="dirichlet.html">dirichlet</a></code>,
<code><a href="dagum.html">dagum</a></code>,
<code><a href="erlang.html">erlang</a></code>,
<code><a href="exponential.html">exponential</a></code>,
<code><a href="bifgmcop.html">bifgmcop</a></code>,
<code><a href="fisk.html">fisk</a></code>,
<code><a href="gamma1.html">gamma1</a></code>,
<code><a href="gamma2.html">gamma2</a></code>,
<code><a href="gammaR.html">gammaR</a></code>,
<code><a href="gengamma.html">gengamma.stacy</a></code>,
<code><a href="geometric.html">geometric</a></code>,
<code><a href="gompertz.html">gompertz</a></code>,
<code><a href="gumbelII.html">gumbelII</a></code>,
<code><a href="hzeta.html">hzeta</a></code>,
<code><a href="inv.lomax.html">inv.lomax</a></code>,
<code><a href="inv.paralogistic.html">inv.paralogistic</a></code>,
<code><a href="kumar.html">kumar</a></code>,
<code><a href="lgammaff.html">lgamma1</a></code>,
<code><a href="lgammaff.html">lgamma3</a></code>,
<code><a href="lindley.html">lindley</a></code>,
<code><a href="lino.html">lino</a></code>,
<code><a href="logff.html">logff</a></code>,
<code><a href="logistic.html">logistic1</a></code>,
<code><a href="logistic.html">logistic</a></code>,
<code><a href="lognormal.html">lognormal</a></code>,
<code><a href="lomax.html">lomax</a></code>,
<code><a href="makeham.html">makeham</a></code>,
<code><a href="negbinomial.html">negbinomial</a></code>,
<code><a href="negbinomial.size.html">negbinomial.size</a></code>,
<code><a href="paralogistic.html">paralogistic</a></code>,
<code><a href="perks.html">perks</a></code>,
<code><a href="poissonff.html">poissonff</a></code>,
<code><a href="posnegbinomial.html">posnegbinomial</a></code>,
<code><a href="posnormal.html">posnormal</a></code>,
<code><a href="pospoisson.html">pospoisson</a></code>,
<code><a href="negbinomial.html">polya</a></code>,
<code><a href="negbinomial.html">polyaR</a></code>,
<code><a href="posbinomial.html">posbinomial</a></code>,
<code><a href="rayleigh.html">rayleigh</a></code>,
<code><a href="riceff.html">riceff</a></code>,
<code><a href="simplex.html">simplex</a></code>,
<code><a href="sinmad.html">sinmad</a></code>,
<code><a href="slash.html">slash</a></code>,
<code><a href="studentt.html">studentt</a></code>,
<code><a href="studentt.html">studentt2</a></code>,
<code><a href="studentt.html">studentt3</a></code>,
<code><a href="triangle.html">triangle</a></code>,
<code><a href="uninormal.html">uninormal</a></code>,
<code><a href="yulesimon.html">yulesimon</a></code>,
<code><a href="zageometric.html">zageometric</a></code>,
<code><a href="zageometric.html">zageometricff</a></code>,
<code><a href="zanegbinomial.html">zanegbinomial</a></code>,
<code><a href="zanegbinomial.html">zanegbinomialff</a></code>,
<code><a href="zapoisson.html">zapoisson</a></code>,
<code><a href="zapoisson.html">zapoissonff</a></code>,
<code><a href="zigeometric.html">zigeometric</a></code>,
<code><a href="zigeometric.html">zigeometricff</a></code>,
<code><a href="zinegbinomial.html">zinegbinomial</a></code>,
<code><a href="zipf.html">zipf</a></code>,
<code><a href="zipoisson.html">zipoisson</a></code>,
<code><a href="zipoisson.html">zipoissonff</a></code>.
</p>


<p>See also
<code><a href="../../base/html/Random.html">RNG</a></code> about random number generation in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>,
<code><a href="vglm.html">vglm</a></code>, <code><a href="vgam.html">vgam</a></code> for model fitting.
</p>


<h3>Examples</h3>

<pre>
nn &lt;- 10; mysize &lt;- 20; set.seed(123)
bdata &lt;- data.frame(x2 = rnorm(nn))
bdata &lt;- transform(bdata,
  y1   = rbinom(nn, size = mysize, p = logit(1+x2, inverse = TRUE)),
  y2   = rbinom(nn, size = mysize, p = logit(1+x2, inverse = TRUE)),
  f1   = factor(as.numeric(rbinom(nn, size = 1,
                                  p = logit(1+x2, inverse = TRUE)))))
(fit1 &lt;- vglm(cbind(y1, aaa = mysize - y1) ~ x2,  # Matrix response (2-colns)
              binomialff, data = bdata))
(fit2 &lt;- vglm(f1 ~ x2, binomialff, model = TRUE, data = bdata)) # Factor response

set.seed(123); simulate(fit1, nsim = 8)
set.seed(123); c(simulate(fit2, nsim = 3))  # Use c() when model = TRUE

# An n x N x F example
set.seed(123); n &lt;- 100
bdata &lt;- data.frame(x2 = runif(n), x3 = runif(n))
bdata &lt;- transform(bdata, y1 = rnorm(n, 1 + 2 * x2),
                          y2 = rnorm(n, 3 + 4 * x2))
fit1 &lt;- vglm(cbind(y1, y2) ~ x2, binormal(eq.sd = TRUE), data = bdata)
nsim &lt;- 1000  # Number of simulations for each observation
my.sims &lt;- simulate(fit1, nsim = nsim)
dim(my.sims)  # A data frame
aaa &lt;- array(unlist(my.sims), c(n, nsim, ncol(fitted(fit1))))  # n by N by F
summary(rowMeans(aaa[, , 1]) - fitted(fit1)[, 1])  # Should be all 0s
summary(rowMeans(aaa[, , 2]) - fitted(fit1)[, 2])  # Should be all 0s

# An n x F x N example
n &lt;- 100; set.seed(111); nsim &lt;- 1000
zdata &lt;- data.frame(x2 = runif(n))
zdata &lt;- transform(zdata, lambda1 =  loge(-0.5 + 2 * x2, inverse = TRUE),
                          lambda2 =  loge( 0.5 + 2 * x2, inverse = TRUE),
                          pstr01  = logit( 0,            inverse = TRUE),
                          pstr02  = logit(-1.0,          inverse = TRUE))
zdata &lt;- transform(zdata, y1 = rzipois(n, lambda = lambda1, pstr0 = pstr01),
                          y2 = rzipois(n, lambda = lambda2, pstr0 = pstr02))
zip.fit  &lt;- vglm(cbind(y1, y2) ~ x2, zipoissonff, data = zdata, crit = "coef")
my.sims &lt;- simulate(zip.fit, nsim = nsim)
dim(my.sims)  # A data frame
aaa &lt;- array(unlist(my.sims), c(n, ncol(fitted(zip.fit)), nsim))  # n by F by N
summary(rowMeans(aaa[, 1, ]) - fitted(zip.fit)[, 1])  # Should be all 0s
summary(rowMeans(aaa[, 2, ]) - fitted(zip.fit)[, 2])  # Should be all 0s
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
