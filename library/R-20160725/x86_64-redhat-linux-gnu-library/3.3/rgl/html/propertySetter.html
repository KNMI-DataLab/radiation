<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Write HTML/Javascript code to control a WebGL display.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for propertySetter {rgl}"><tr><td>propertySetter {rgl}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Write HTML/Javascript code to control a WebGL display.
</h2>

<h3>Description</h3>

<p><code>propertySlider</code> writes out HTML code to control WebGL displays on the same page via a slider; <code>par3dinterpSetter</code> and
<code>propertySetter</code> return Javascript code
to be used in HTML controls.
</p>


<h3>Usage</h3>

<pre>
propertySlider(setter = propertySetter,
             minS = NULL, maxS = NULL, step = 1, init = NULL, 
	     labels, 
	     id = basename(tempfile("input")), name = id,
	     outputid = paste0(id, "text"),
	     index = NULL,
	     ...) 
	     
propertySetter(values = NULL, entries, properties, objids, prefixes = "",
               param = seq_len(NROW(values)), interp = TRUE, digits = 7) 
               
par3dinterpSetter(fn, from, to, steps, subscene, omitConstant = TRUE, 
                  rename = character(), ...)

matrixSetter(fns, from, to, steps, subscene = currentSubscene3d(), 
             matrix = "userMatrix", omitConstant = TRUE, prefix = "", ...) 
             
vertexSetter(values, vertices = 1, attributes, objid, prefix = "",
	     param = seq_len(NROW(values)), interp = TRUE,
	     digits = 7)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>setter</code></td>
<td>
<p>A function to write Javascript code, or its output, or
a list containing several of these.</p>
</td></tr>
<tr valign="top"><td><code>minS, maxS, step, init</code></td>
<td>
<p>Slider values to be displayed. Reasonable defaults are used if missing.</p>
</td></tr>
<tr valign="top"><td><code>labels</code></td>
<td>
<p>Labels to display for each slider value.  The
defaults are calculated using internal variables.  If <code>NULL</code>,
no labels will be shown.</p>
</td></tr>
<tr valign="top"><td><code>id</code></td>
<td>
<p>The <code>id</code> of the input control that will be generated.</p>
</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
<p>The name of the input control that will be generated.</p>
</td></tr>
<tr valign="top"><td><code>outputid</code></td>
<td>
<p>The <code>id</code> of the output control that
will display the slider value, or <code>NULL</code> for none.</p>
</td></tr>
<tr valign="top"><td><code>index</code></td>
<td>
<p>The 1-based index of this slider:  it controls the
corresponding entry in an indexed setter such as <code>matrixSetter</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>See Details below.</p>
</td></tr>
<tr valign="top"><td><code>values</code></td>
<td>
<p>An array of values; rows correspond to slider positions.  Alternatively, <code>NULL</code>; the generated function takes a
single value or array of values and applies them directly.</p>
</td></tr>
<tr valign="top"><td><code>entries, properties, objids, prefixes</code></td>
<td>
<p>Vectors describing
the columns of <code>values</code>.  See the details below.</p>
</td></tr>
<tr valign="top"><td><code>param</code></td>
<td>
<p>Parameter values corresponding to each row of <code>values</code>.</p>
</td></tr>
<tr valign="top"><td><code>interp</code></td>
<td>
<p>Whether to interpolate values.  If <code>FALSE</code>, 
the Javascript function will expect non-negative integer values.
Ignored if <code>values</code> is <code>NULL</code>.</p>
</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
<p>How many significant digits to emit in the Javascript code.</p>
</td></tr>
<tr valign="top"><td><code>fn</code></td>
<td>
<p>A function returned from <code><a href="par3dinterp.html">par3dinterp</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>from, to, steps</code></td>
<td>
<p>Values where <code>fn</code> should be evaluated.</p>
</td></tr>
<tr valign="top"><td><code>subscene</code></td>
<td>
<p>Which subscene's properties should be modified?</p>
</td></tr>
<tr valign="top"><td><code>omitConstant</code></td>
<td>
<p>If <code>TRUE</code>, do not set values that are
constant across the range.</p>
</td></tr>
<tr valign="top"><td><code>rename</code></td>
<td>
<p>A named character vector of names of Javascript properties
to modify.  See the details.</p>
</td></tr>
<tr valign="top"><td><code>fns</code></td>
<td>
<p>A list containing functions returned from 
<code><a href="par3dinterp.html">par3dinterp</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>matrix</code></td>
<td>
<p>A character string giving the Javascript property
name of the matrix to modify.</p>
</td></tr>
<tr valign="top"><td><code>prefix</code></td>
<td>
<p>The prefix of the scene containing <code>matrix</code>.</p>
</td></tr>
<tr valign="top"><td><code>vertices</code></td>
<td>
<p>A vector of vertex numbers (1-based) within 
an object.</p>
</td></tr>
<tr valign="top"><td><code>attributes</code></td>
<td>
<p>A vector of attributes of a vertex, 
from <code>c("x", "y", "z", "r", "g", "b", "a", "nx", "ny", "nz",
               "radius", "ox", "oy", "oz", "ts", "tt")</code>.  See
Details.</p>
</td></tr>
<tr valign="top"><td><code>objid</code></td>
<td>
<p>The object containing the vertices to be modified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> parameters to <code>propertySlider</code> will be passed to
<code>setter</code> if the latter is a function, otherwise ignored. 
</p>
<p>The <code>...</code> parameters to <code>par3dinterpSetter</code>
will be passed to <code>propertySetter</code>.
</p>
<p>The <code>...</code> parameters to <code>matrixSetter</code> will be passed to the
<code>par3dinterpSetter</code> functions used for each of the functions
in <code>fns</code>.
</p>
<p><code>propertySetter</code> is a low-level general purpose function for modifying
properties of objects in the scene.  It is mainly for internal use.
<code>propertySlider</code> uses it to generate Javascript for a slider control
to manipulate those properties.  
</p>
<p><code>vertexSetter</code> modifies attributes of vertices in a single
object.  The <code>attributes</code> are properties of each vertex 
in a scene; not all are applicable to all objects. In order, 
the are: coordinates of the vertex <code>"x", "y", "z"</code>, color
of the vertex <code>"r", "g", "b", "a"</code>, normal at the vertex
<code>"nx", "ny", "nz"</code>, radius of a sphere at the vertex
<code>"radius"</code>, origin within a texture <code>"ox", "oy"</code> and
perhaps <code>"oz"</code>, texture coordinates <code>"ts", "tt"</code>.
</p>
<p><code>propertySetter</code> and <code>vertexSetter</code> allow values to be 
specified in two ways.
The normal way when used with a slider is to interpolate between
specified values indexed by the slider.  If <code>values = NULL</code>,
the value of the slider is used directly (and only one entry can
be set).  Multiple entries can be set directly by passing
an array of values in custom Javascript code.
</p>
<p><code>par3dinterpSetter</code> uses <code>propertySetter</code>
to set parameters corresponding to values produced by the result of
<code>par3dinterp</code>.  Its <code>rename</code> argument allows translation
of names, e.g. <code>rename = c(userMatrix = "myMatrix")</code> would
cause the <code>"userMatrix"</code> result from <code><a href="par3dinterp.html">par3dinterp</a></code>
to be used to modify the Javascript <code>myMatrix</code> property.
</p>
<p><code>matrixSetter</code> is used in the situation where multiple controls
(e.g. sliders) are used to determine the value of a matrix, typically
<code>"userMatrix"</code>.  It will generate one <code>par3dinterpSetter</code>
function for each of the entries in <code>fns</code>; these will be called
when a <code>propertySlider</code> with the corresponding (1-based) index
is changed, and the results multiplied together from right to left
to produce a new value for whichever property is named in <code>matrix</code>.
</p>
<p>The rows of the <code>values</code> matrix correspond to different settings
for numeric properties.  The columns are values to insert into those properties.
</p>
<p>Argument <code>entries</code> gives the numeric (zero based) index into the Javascript
property named by <code>properties</code>, for the object id <code>objids</code>, in the
display with prefix <code>prefixes</code>.  All of these may be vectors, corresponding
to the columns of <code>values</code>.  All but <code>entries</code> will be recycled 
to the appropriate length; its length needs to match the number of 
columns in <code>values</code>.
</p>
<p>There are two modes for determining the values to substitute.  In the simplest
mode (<code>interp = FALSE</code> in <code>propertySetter</code>), 
each row of <code>values</code> corresponds to a location for the slider, and
the values are simply copied into place.  This requires that <code>param</code>, 
<code>min</code>, <code>max</code> and <code>step</code> take on their default values.
</p>
<p>In other cases, linear interpolation is used between successive rows of <code>values</code>,
with extrapolation outside the range of <code>param</code> 
repeating the first or last row.   <code>param</code> should then
contain the values that correspond to exact rows.
</p>
<p>In both cases, <code>param</code> must be a strictly increasing vector.
</p>


<h3>Value</h3>

<p><code>propertySlider</code> prints the full code to generate the control, 
and returns the <code>id</code> of the control that was generated.  
</p>
<p><code>propertySetter</code> returns a single element character vector 
containing the Javascript source for a function to set
the appropriate properties.   It does not assign the function 
to a variable or include any of the HTML wrapper text that 
<code>propertySlider</code> adds.  
</p>
<p>The character vector has class
<code>"propertySetter"</code>, and an attribute named <code>"env"</code>
which gives access to the local environment where it was
created, so for example <code>attr(value, "env")$prefixes</code> will
give access to the <code>prefixes</code> argument if <code>value</code>
was produced by <code>"propertySetter"</code>.
</p>
<p><code>par3dinterpSetter</code> returns a <code>propertySetter</code> result.
</p>
<p><code>matrixSetter</code> is similar to <code>propertySetter</code>, but
the Javascript function takes arguments <code>value, index</code>, 
and the class of the result is 
<code>c("matrixSetter", "indexedSetter", "propertySetter")</code>.
</p>
<p><code>vertexSetter</code> is similar to <code>propertySetter</code>, but
the class of the result is <code>c("vertexSetter", "propertySetter")</code>.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>See Also</h3>

<p><code><a href="writeWebGL.html">writeWebGL</a></code>.  <code><a href="webGLcontrols.html">clipplaneSlider</a></code> makes
use of <code>propertySlider</code>.
</p>
<p><code><a href="ageSetter.html">ageSetter</a></code> can be used as the <code>setter</code> argument
to <code>propertySlider</code> to modify objects according to a linear (age)
scale.
</p>


<h3>Examples</h3>

<pre>
  # Just the setter function
  cat(propertySetter(1:4, entries = 12, properties = "values", objids = 13))

  # A 4-position slider
  propertySlider(values = 1:4, entries = 12, properties = "values", objids = 13, interp = FALSE)

  # A 10-position slider interpolating the 4-position slider
  propertySlider(values = 1:4, entries = 12, properties = "values", objids = 13,
               step = (4-1)/9)
               
  # The userMatrix interpolation from example(play3d)
  M &lt;- r3dDefaults$userMatrix
  fn &lt;- par3dinterp(time = (0:2)*0.75, userMatrix = list(M,
                                     rotate3d(M, pi/2, 1, 0, 0),
                                     rotate3d(M, pi/2, 0, 1, 0) ) )
  cat(par3dinterpSetter(fn, 0, 3, steps=10))
</pre>

<hr /><div style="text-align: center;">[Package <em>rgl</em> version 0.96.0 <a href="00Index.html">Index</a>]</div>
</body></html>
