<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Vincenty Direct Calculation of a Destination</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for destination {SDMTools}"><tr><td>destination {SDMTools}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Vincenty Direct Calculation of a Destination</h2>

<h3>Description</h3>

<p><code>destination</code> estimates the destination latitude and
longitude given a starting latitude and longitude, a
bearing and distance. <br /> <br /> For general information on
Vincenty's formula, see e.g.,
<a href="http://en.wikipedia.org/wiki/Vincenty's_formulae">http://en.wikipedia.org/wiki/Vincenty's_formulae</a>. It
states: <br /> <em>Vincenty's formulae are two related
iterative methods used in geodesy to calculate the distance
between two points on the surface of an spheroid, developed
by Thaddeus Vincenty in 1975. They are based on the
assumption that the figure of the Earth is an oblate
spheroid, and hence are more accurate than methods such as
great-circle distance which assume a spherical Earth.</em> <br />
<br /> <b>Note:</b> this method assumes a locations are lat &amp;
lon given in WGS 84.
</p>


<h3>Usage</h3>

<pre>
destination(lat, lon, bearing, distance)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lat</code></td>
<td>
<p>a single value or vector of values
representing latitude in decimal degrees from -90 to 90
degrees.</p>
</td></tr>
<tr valign="top"><td><code>lon</code></td>
<td>
<p>a single value or vector of values
representing longitude in decimal degrees from -180 to
180 degrees.</p>
</td></tr>
<tr valign="top"><td><code>bearing</code></td>
<td>
<p>a single value or vector of values
representing the bearings (directions) of interest
ranging from 0 to 360 degrees.</p>
</td></tr>
<tr valign="top"><td><code>distance</code></td>
<td>
<p>a single value or vector of values
representing the distances in metres to the destination.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typical useages are:<br /> </p>
 <ol>
<li><p> a single start
location, bearing and distance to give a single output
location<br /> &ndash;output would be a single destination location
</p>
</li>
<li><p> a single start location with one or more bearings or
distances to give multiple output locations<br /> &ndash;output
would be a destination locations for each combination of
bearings and distances </p>
</li>
<li><p> multiple start locations with
a single bearing or distance<br /> &ndash;output would be a
destination locations representing the bearing and distance
from each of the start locations </p>
</li>
<li><p> multiple start
locations with multiple bearings or distances<br /> &ndash;output
would be a destination locations representing the
combinations of bearings and distances from each of the
start locations<br /> &ndash; NOTE that the bearing and distance
vectors must be of the same length of the input lat and
long.  </p>
</li></ol>

<p>See examples for all possible usages.
</p>


<h3>Value</h3>

<p>Returns a data.frame with: </p>
<table summary="R valueblock">
<tr valign="top"><td><code>lon1</code></td>
<td>
<p>the original
longitude</p>
</td></tr> <tr valign="top"><td><code>lat1</code></td>
<td>
<p>the original latitude</p>
</td></tr>
<tr valign="top"><td><code>bearing</code></td>
<td>
<p>the bearing used</p>
</td></tr> <tr valign="top"><td><code>distance</code></td>
<td>
<p>the
distance used</p>
</td></tr> <tr valign="top"><td><code>lon2</code></td>
<td>
<p>the destination longitude</p>
</td></tr>
<tr valign="top"><td><code>lat2</code></td>
<td>
<p>the destination latitude</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeremy VanDerWal <a href="mailto:jjvanderwal@gmail.com">jjvanderwal@gmail.com</a>
</p>


<h3>Source</h3>

<p>The source code here was modified from
<a href="http://www.movable-type.co.uk/scripts/latlong-vincenty-direct.html">http://www.movable-type.co.uk/scripts/latlong-vincenty-direct.html</a>.<br />
<br /> Destinations were validated against Geoscience
Australia calculations
(<a href="http://www.ga.gov.au/geodesy/datums/vincenty_direct.jsp">http://www.ga.gov.au/geodesy/datums/vincenty_direct.jsp</a>).
</p>


<h3>References</h3>

<p>Vincenty, T. 1975. Direct and Inverse Solutions of
Geodesics on the Ellipsoid with application of Nested
Equations. Survey Review, vol XXII no 176.
<a href="http://www.ngs.noaa.gov/PUBS_LIB/inverse.pdf">http://www.ngs.noaa.gov/PUBS_LIB/inverse.pdf</a>
</p>


<h3>Examples</h3>

<pre>
###single lat lons
lats = -85; lons = 165
#single bearing &amp; single distance
destination(lats,lons,bearing=180,distance=500000)

#multiple bearings
destination(lats,lons,bearing=seq(0,360,length.out=9),distance=500000)

#multiple bearings
destination(lats,lons,bearing=45,distance=seq(0,5000000,length.out=11))

#multiple bearings, multiple distances
destination(lats,lons,bearing=seq(0,360,length.out=9),
    distance=seq(0,5000000,length.out=11))

###multiple lat lons
lats = seq(-90,90,length.out=9); lons = seq(-180,180,length.out=9)

#multiple lat lons but single bearings / distances
destination(lats,lons,bearing=45,distance=500000)

#different bearings for each lat lon
destination(lats,lons,bearing=seq(0,360,length.out=9),distance=500000)

#different distances for each lat lon
destination(lats,lons,bearing=45,distance=seq(0,5000000,length.out=9))

#different bearings &amp; distances for each lat lon
destination(lats,lons,bearing=seq(0,360,length.out=9),
    distance=seq(0,5000000,length.out=9))
</pre>

<hr /><div style="text-align: center;">[Package <em>SDMTools</em> version 1.1-221 <a href="00Index.html">Index</a>]</div>
</body></html>
