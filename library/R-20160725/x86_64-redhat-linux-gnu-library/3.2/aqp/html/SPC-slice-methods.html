<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Slicing of SoilProfilecollection Objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for slice-methods {aqp}"><tr><td>slice-methods {aqp}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Slicing of SoilProfilecollection Objects</h2>

<h3>Description</h3>

<p>Slicing of SoilProfilecollection Objects</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
slice(object, fm, top.down=TRUE, just.the.data=FALSE, strict=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>fm</code></td>
<td>
<p>A formula: either &lsquo;integer.vector ~ var1 + var2 + var3&rsquo; where named variables are sliced according to &lsquo;integer.vector&rsquo; OR where all variables are sliced accordin to &lsquo;integer.vector&rsquo; &lsquo;integer.vector ~.&rsquo;.</p>
</td></tr>
<tr valign="top"><td><code>top.down</code></td>
<td>
<p>Logical, should slices be defined from the top-down? The default is usually what you want.</p>
</td></tr>
<tr valign="top"><td><code>just.the.data</code></td>
<td>
<p>Logical, return just the sliced data or a new SoilProfileCollection object.</p>
</td></tr>
<tr valign="top"><td><code>strict</code></td>
<td>
<p>Logical, should the horizonation be strictly checked for self-consistency?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either a new SoilProfileCollection with data sliced according to <code>fm</code>, or a <code>data.frame</code>.</p>


<h3>Methods</h3>


<dl>
<dt>data = &quot;SoilProfileCollection&quot;</dt><dd><p>Typical usage, where input is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p><code>slab()</code> and <code>slice()</code> are much faster and require less memory if input data are either numeric or character.</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette</p>


<h3>References</h3>

<p>D.E. Beaudette, P. Roudier, A.T. O'Geen, Algorithms for quantitative pedology: A toolkit for soil scientists, Computers &amp; Geosciences, Volume 52, March 2013, Pages 258-268, 10.1016/j.cageo.2012.10.020.
</p>


<h3>See Also</h3>

<p><code><a href="SPC-slab-methods.html">slab</a></code></p>


<h3>Examples</h3>

<pre>
# simulate some data, IDs are 1:20
library(plyr)
d &lt;- ldply(1:20, random_profile)

# init SoilProfilecollection object
depths(d) &lt;- id ~ top + bottom
head(horizons(d))

# generate single slice at 10 cm
# output is a SoilProfilecollection object
s &lt;- slice(d, 10 ~ name + p1 + p2 + p3)

# generate single slice at 10 cm, output data.frame
s &lt;- slice(d, 10 ~ name + p1 + p2 + p3, just.the.data=TRUE)

# generate integer slices from 0 - 25 cm
s &lt;- slice(d, 0:25 ~ name + p1 + p2 + p3)
plot(s)

# generate slices from 0 - 10 cm, for all variables
s &lt;- slice(d, 0:10 ~ .)
print(s)

# note that pct missing is computed for each slice,
# if all vars are missing, then NA is returned
d$p1[1:10] &lt;- NA
s &lt;- slice(d, 10 ~ ., just.the.data=TRUE)
print(s)

## 
## check sliced data
##

# test that mean of 1 cm slices property is equal to the 
# hz-thickness weighted mean value of that property
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# get the first profile
sp1.sub &lt;- sp1[which(profile_id(sp1) == 'P009'), ]

# compute hz-thickness wt. mean
hz.wt.mean &lt;- with(horizons(sp1.sub), 
sum((bottom - top) * prop) / sum(bottom - top) 
)

# hopefully the same value, calculated via slice()
s &lt;- slice(sp1.sub, 0:max(sp1.sub) ~ prop)
hz.slice.mean &lt;- mean(s$prop, na.rm=TRUE)

# same?
if(!all.equal(hz.slice.mean, hz.wt.mean))
	stop('there is a bug in slice() !!!')


</pre>

<hr /><div style="text-align: center;">[Package <em>aqp</em> version 1.9.3 <a href="00Index.html">Index</a>]</div>
</body></html>
