<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Multivariate Adaptive Regression Splines</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mars {mda}"><tr><td>mars {mda}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Multivariate Adaptive Regression Splines</h2>

<h3>Description</h3>

<p>Multivariate adaptive regression splines.
</p>


<h3>Usage</h3>

<pre>
mars(x, y, w, wp, degree, nk, penalty, thresh, prune, trace.mars,
     forward.step, prevfit, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a matrix containing the independent variables.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>a vector containing the response variable, or in the case of
multiple responses, a matrix whose columns are the response values
for each variable.</p>
</td></tr>
<tr valign="top"><td><code>w</code></td>
<td>
<p>an optional vector of observation weights (currently ignored).</p>
</td></tr>
<tr valign="top"><td><code>wp</code></td>
<td>
<p>an optional vector of response weights.</p>
</td></tr>
<tr valign="top"><td><code>degree</code></td>
<td>
<p>an optional integer specifying maximum interaction
degree (default is 1).</p>
</td></tr>
<tr valign="top"><td><code>nk</code></td>
<td>
<p>an optional integer specifying the maximum number of model
terms.</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>
<p>an optional value specifying the cost per degree of
freedom charge (default is 2).</p>
</td></tr>
<tr valign="top"><td><code>thresh</code></td>
<td>
<p>an optional value specifying forward stepwise stopping
threshold (default is 0.001).</p>
</td></tr>
<tr valign="top"><td><code>prune</code></td>
<td>
<p>an optional logical value specifying whether the model
should be pruned in a backward stepwise fashion (default is
<code>TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>trace.mars</code></td>
<td>
<p>an optional logical value specifying whether info
should be printed along the way (default is <code>FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>forward.step</code></td>
<td>
<p>an optional logical value specifying whether
forward stepwise process should be carried out (default is
<code>TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>prevfit</code></td>
<td>
<p>optional data structure from previous fit.  To see the
effect of changing the penalty parameter, one can use prevfit with
<code>forward.step = FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"mars"</code>, which is a list with the following
components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>call</code></td>
<td>
<p>call used to <code>mars</code>.</p>
</td></tr>
<tr valign="top"><td><code>all.terms</code></td>
<td>
<p>term numbers in full model.  <code>1</code> is the constant
term.  Remaining terms are in pairs (<code>2 3</code>, <code>4 5</code>, and so
on).  <code>all.terms</code> indicates nonsingular set of terms.</p>
</td></tr>
<tr valign="top"><td><code>selected.terms</code></td>
<td>
<p>term numbers in selected model.</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>
<p>the input penalty value.</p>
</td></tr>
<tr valign="top"><td><code>degree</code></td>
<td>
<p>the input degree value.</p>
</td></tr>
<tr valign="top"><td><code>thresh</code></td>
<td>
<p>the input threshold value.</p>
</td></tr>
<tr valign="top"><td><code>gcv</code></td>
<td>
<p>gcv of chosen model.</p>
</td></tr>
<tr valign="top"><td><code>factor</code></td>
<td>
<p>matrix with <i>ij</i>-th element equal to 1 if term
<i>i</i> has a factor of the form <i>x_j &gt; c</i>, equal to <i>-1</i> if
term <i>i</i> has a factor of the form <i>x_j &le; c</i>, and to 0 if
<i>xj</i> is not in term <i>i</i>.</p>
</td></tr>
<tr valign="top"><td><code>cuts</code></td>
<td>
<p>matrix with <i>ij</i>-th element equal to the cut point
<i>c</i> for variable <i>j</i> in term <i>i</i>.</p>
</td></tr>
<tr valign="top"><td><code>residuals</code></td>
<td>
<p>residuals from fit.</p>
</td></tr>
<tr valign="top"><td><code>fitted</code></td>
<td>
<p>fitted values from fit.</p>
</td></tr>
<tr valign="top"><td><code>lenb</code></td>
<td>
<p>length of full model.</p>
</td></tr>
<tr valign="top"><td><code>coefficients</code></td>
<td>
<p>least squares coefficients for final model.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>a matrix of basis functions obtained from the input x
matrix.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function was coded from scratch, and did not use any of
Friedman's mars code.  It gives quite similar results to  Friedman's
program in our tests, but not exactly the same results.  We have not 
implemented Friedman's anova decomposition nor are categorical
predictors handled properly yet.  Our version does handle multiple
response variables, however.  </p>


<h3>Author(s)</h3>

<p>Trevor Hastie and Robert Tibshirani
</p>


<h3>References</h3>

<p>J. Friedman, &ldquo;Multivariate Adaptive Regression Splines&rdquo; (with
discussion) (1991). 
<em>Annals of Statistics</em>, <b>19</b>/1, 1&ndash;141.
</p>


<h3>See Also</h3>

<p><code><a href="predict.mars.html">predict.mars</a></code>,
<code><a href="model.matrix.mars.html">model.matrix.mars</a></code>.
</p>
<p>Package <span class="pkg">earth</span> also provides multivariate adaptive regression
spline models based on the Hastie/Tibshirani mars code in package
<span class="pkg">mda</span>, adding some extra features. It can be used in the
<code>method</code>
argument of <code>fda</code> or <code>mda</code>.
</p>


<h3>Examples</h3>

<pre>
data(trees)
fit1 &lt;- mars(trees[,-3], trees[3])
showcuts &lt;- function(obj)
{
  tmp &lt;- obj$cuts[obj$sel, ]
  dimnames(tmp) &lt;- list(NULL, names(trees)[-3])
  tmp
}
showcuts(fit1)

## examine the fitted functions
par(mfrow=c(1,2), pty="s")
Xp &lt;- matrix(sapply(trees[1:2], mean), nrow(trees), 2, byrow=TRUE)
for(i in 1:2) {
  xr &lt;- sapply(trees, range)
  Xp1 &lt;- Xp; Xp1[,i] &lt;- seq(xr[1,i], xr[2,i], len=nrow(trees))
  Xf &lt;- predict(fit1, Xp1)
  plot(Xp1[ ,i], Xf, xlab=names(trees)[i], ylab="", type="l")
}
</pre>

<hr /><div style="text-align: center;">[Package <em>mda</em> version 0.4-9 <a href="00Index.html">Index</a>]</div>
</body></html>
