<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Assigns colors to data points</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for colors2data {denpro}"><tr><td>colors2data {denpro}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Assigns colors to data points
</h2>

<h3>Description</h3>

<p>Assigns colors to data points according to cluster membership, 
when the clusters are defined as high density regions 
</p>


<h3>Usage</h3>

<pre>
colors2data(dendat, pcf, lst, paletti = NULL, clusterlevel = NULL, nodes = NULL,
type = "regular")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>dendat</code></td>
<td>
<p>n*d matrix of real numbers; the data matrix.</p>
</td></tr>
<tr valign="top"><td><code>pcf</code></td>
<td>
<p>piecewise constant function; output of &quot;pcf.kern&quot;, or
&quot;pcf.func&quot;, for example.</p>
</td></tr>
<tr valign="top"><td><code>lst</code></td>
<td>
<p>level set tree; a list of vectors.
The list contains at least vectors &quot;level&quot;, &quot;volume&quot;, and &quot;parent&quot;. 
For example, function &quot;leafsfirst&quot; computes a level set tree.</p>
</td></tr>
<tr valign="top"><td><code>paletti</code></td>
<td>
<p>a vector of names of colors; for example paletti=c(&quot;black&quot;,&quot;red&quot;,&quot;blue&quot;).</p>
</td></tr>
<tr valign="top"><td><code>clusterlevel</code></td>
<td>
<p>a positive real number; gives the level which is such that the
disconnected components of the level set with this level define the clusters.</p>
</td></tr>
<tr valign="top"><td><code>nodes</code></td>
<td>
<p>a vector of positive integers; contains pointers to the nodes of
level set tree &quot;lst&quot;; the nodes indicate which disconnected components of level sets
define the clusters.</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>either &quot;regular&quot; or &quot;adaptive&quot;; if type=&quot;regular&quot;, then the piecewise
constant function has a regular partition; if type=&quot;adaptive&quot;, then the piecewise
constant function has an adaptive partition.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>a list with components &quot;datacolo&quot; and &quot;ord&quot;.
&quot;datacolo&quot; is a vector of color names.
This vector assigns a color to each row of matrix &quot;dendat&quot;.
&quot;ord&quot; is a vector of positive integers.
This vector contains pointers to rows of the matrix &quot;dendat&quot;.
The pointers indicate the order so that the data points with the lowest estimated
density are first.
</p>


<h3>Author(s)</h3>

<p>Jussi Klemela</p>


<h3>See Also</h3>

<p><code><a href="pcf.kern.html">pcf.kern</a></code>
<code><a href="leafsfirst.html">leafsfirst</a></code>
</p>


<h3>Examples</h3>

<pre>
# generate data
seed&lt;-1
n&lt;-50
d&lt;-2
l&lt;-3; D&lt;-4; c&lt;-D/sqrt(2)
M&lt;-matrix(0,l,d); M[2,]&lt;-c; M[3,]&lt;--c
sig&lt;-matrix(1,l,d)
p&lt;-rep(1/l,l)
dendat&lt;-sim.data(type="mixt",n=n,M=M,sig=sig,p=p,seed=seed)

# colored volume function 
h&lt;-(4/(d+2))^(1/(d+4))*n^(-1/(d+4))*apply(dendat,2,sd)
N&lt;-rep(20,d)
pcf&lt;-pcf.kern(dendat,h,N)
lst&lt;-leafsfirst(pcf)

# colored scatter plot
cd&lt;-colors2data(dendat,pcf,lst)
plot(dendat,col=cd$datacolo)

# colored scatter plot: plot the observations so that the observations with
# the highest density value are plotted last
cd&lt;-colors2data(dendat,pcf,lst)
plot(dendat[cd$ord,1],dendat[cd$ord,2],col=cd$datacolo[cd$ord])

</pre>

<hr /><div style="text-align: center;">[Package <em>denpro</em> version 0.9.2 <a href="00Index.html">Index</a>]</div>
</body></html>
