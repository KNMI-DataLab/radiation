<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Positive Bernoulli Family Function with Time Effects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for posbernoulli.t {VGAM}"><tr><td>posbernoulli.t {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Positive Bernoulli Family Function with Time Effects </h2>

<h3>Description</h3>

<p>Fits a GLM/GAM-like model to multiple Bernoulli responses where
each row in the capture history matrix response has at least one success
(capture).
Sampling occasion effects are accommodated.
</p>




<h3>Usage</h3>

<pre>
posbernoulli.t(link = "logit", parallel.t = FALSE ~ 1, iprob = NULL,
               p.small = 1e-4, no.warning = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link, iprob, parallel.t</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for information.
By default, the parallelism assumption does not apply to the intercept.
Setting <code>parallel.t = FALSE ~ -1</code>,
or equivalently <code>parallel.t = FALSE ~ 0</code>,
results in the <i>M_0</i>/<i>M_h</i> model.
</p>
</td></tr>
<tr valign="top"><td><code>p.small, no.warning</code></td>
<td>

<p>A small probability value used to give a warning for the
Horvitz&ndash;Thompson estimator.
Any estimated probability value less than <code>p.small</code> will
result in a warning, however, setting <code>no.warning = TRUE</code>
will suppress this warning if it occurs.
This is because the Horvitz-Thompson estimator is the sum of the
reciprocal of such probabilities, therefore any probability that
is too close to 0 will result in an unstable estimate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These models (commonly known as <i>M_t</i> or <i>M_{th}</i>
(no prefix <i>h</i> means it is an intercept-only model)
in the capture&ndash;recapture literature) operate on a capture
history matrix response of 0s and 1s (<i>n x tau</i>).
Each column is a
sampling occasion where animals are potentially captured
(e.g., a field trip), and each row is an individual animal.
Capture is a 1, else a 0.  No removal of animals from
the population is made (closed population), e.g., no
immigration or emigration.  Each row of the response
matrix has at least one capture.
Once an animal is captured for the first time,
it is marked/tagged so that its future capture history can be recorded.
Then it is released immediately back into the population to remix.
It is released immediately after each recapture too.
It is assumed that the animals are independent and
that, for a given animal, each sampling occasion is independent.
And animals do not lose their marks/tags, and
all marks/tags are correctly recorded.
</p>
<p>The number of linear/additive predictors is equal to the number
of sampling occasions, i.e., <i>M = &tau;</i>, say.
The default link functions
are <i>(logit p_(1),&hellip;,logit p_(tau))^T</i>
where each <i>p_{j}</i> denotes the probability of capture at
time point <i>j</i>.
The fitted value returned is a matrix of probabilities
of the same dimension as the response matrix.
</p>

<p>A conditional likelihood is maximized here using Fisher scoring.
Each sampling occasion has a separate probability that
is modelled here. The probabilities can be constrained
to be equal by setting <code>parallel.t = FALSE ~ 0</code>;
then the results are effectively the same as
<code><a href="posbinomial.html">posbinomial</a></code> except the binomial constants are
not included in the log-likelihood.
If <code>parallel.t = TRUE ~ 0</code> then each column should have
at least one 1 and at least one 0.
</p>
<p>It is well-known that some species of animals are affected
by capture, e.g., trap-shy or trap-happy. This <span class="pkg">VGAM</span>
family function does <em>not</em> allow any behavioral effect to be
modelled (<code><a href="posbernoulli.b.html">posbernoulli.b</a></code> 
and <code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code> do) because the
denominator of the likelihood function must be free of
behavioral effects.
</p>











<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>
<p>Upon fitting the <code>extra</code> slot has a (list) component
called <code>N.hat</code>
which is a point estimate of the population size <i>N</i>
(it is the Horvitz-Thompson (1952) estimator).
And there is a component called <code>SE.N.hat</code>
containing its standard error.
</p>


<h3>Note</h3>








<p>The <code>weights</code> argument of <code><a href="vglm.html">vglm</a></code> need not be
assigned, and the default is just a matrix of ones.
</p>
<p>Fewer numerical problems are likely to occur
for <code>parallel.t = TRUE</code>.
Data-wise, each sampling occasion may need at least one success
(capture) and one failure.
Less stringent conditions in the data are needed when
<code>parallel.t = TRUE</code>.
Ditto when parallelism is applied to the intercept too.

</p>
<p>The response matrix is returned unchanged;
i.e., not converted into proportions like <code><a href="posbinomial.html">posbinomial</a></code>.
If the response matrix has column names then these are used in the
labelling, else <code>prob1</code>, <code>prob2</code>, etc. are used.
</p>
<p>Using <code>AIC()</code> or <code>BIC()</code> to compare
<code><a href="posbernoulli.t.html">posbernoulli.t</a></code>,
<code><a href="posbernoulli.b.html">posbernoulli.b</a></code>,
<code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code>
models with a
<code><a href="posbinomial.html">posbinomial</a></code>
model requires <code>posbinomial(omit.constant = TRUE)</code> 
because one needs to remove the normalizing constant from the
log-likelihood function.
See <code><a href="posbinomial.html">posbinomial</a></code> for an example.
</p>










<h3>Author(s)</h3>

<p> Thomas W. Yee. </p>


<h3>References</h3>

<p>Huggins, R. M. (1991)
Some practical aspects of a conditional likelihood
approach to capture experiments.
<em>Biometrics</em>,
<b>47</b>, 725&ndash;732.
</p>
<p>Huggins, R. M. and Hwang, W.-H. (2011)
A review of the use of conditional likelihood in
capture&ndash;recapture experiments.
<em>International Statistical Review</em>,
<b>79</b>, 385&ndash;400.
</p>
<p>Otis, D. L. and Burnham, K. P. and White, G. C. and Anderson, D. R. (1978)
Statistical inference from capture data on closed animal populations,
<em>Wildlife Monographs</em>,
<b>62</b>, 3&ndash;135.
</p>
<p>Yee, T. W. and Stoklosa, J. and Huggins, R. M. (2015)
The <span class="pkg">VGAM</span> package for capture&ndash;recapture data using the
conditional likelihood.
<em>Journal of Statistical Software</em>,
<b>65</b>, 1&ndash;33.
<a href="http://www.jstatsoft.org/v65/i05/">http://www.jstatsoft.org/v65/i05/</a>.
</p>



<h3>See Also</h3>

 
<p><code><a href="posbernoulli.b.html">posbernoulli.b</a></code>,
<code><a href="posbernoulli.tb.html">posbernoulli.tb</a></code>,
<code><a href="Select.html">Select</a></code>,
<code><a href="deermice.html">deermice</a></code>,
<code><a href="Huggins89.t1.html">Huggins89table1</a></code>,
<code><a href="Huggins89.t1.html">Huggins89.t1</a></code>,
<code><a href="posbernUC.html">dposbern</a></code>,
<code><a href="posbernUC.html">rposbern</a></code>,
<code><a href="posbinomial.html">posbinomial</a></code>,
<code><a href="AICvlm.html">AICvlm</a></code>,
<code><a href="BICvlm.html">BICvlm</a></code>,
<code><a href="prinia.html">prinia</a></code>.
</p>





<h3>Examples</h3>

<pre>
M.t &lt;- vglm(cbind(y1, y2, y3, y4, y5, y6) ~ 1, posbernoulli.t,
            data = deermice, trace = TRUE)
coef(M.t, matrix = TRUE)
constraints(M.t, matrix = TRUE)
summary(M.t, presid = FALSE)

M.h.1 &lt;- vglm(Select(deermice, "y") ~ sex + weight, trace = TRUE,
              posbernoulli.t(parallel.t = FALSE ~ -1), data = deermice)
coef(M.h.1, matrix = TRUE)
constraints(M.h.1)
summary(M.h.1, presid = FALSE)
head(depvar(M.h.1))  # Response capture history matrix
dim(depvar(M.h.1))

M.th.2 &lt;- vglm(cbind(y1, y2, y3, y4, y5, y6) ~ sex + weight, trace = TRUE,
               posbernoulli.t(parallel.t = FALSE), data = deermice)
lrtest(M.h.1, M.th.2)  # Test the parallelism assumption wrt sex and weight
coef(M.th.2)
coef(M.th.2, matrix = TRUE)
constraints(M.th.2)
summary(M.th.2, presid = FALSE)
head(model.matrix(M.th.2, type = "vlm"), 21)

M.th.2@extra$N.hat     # Estimate of the population size; should be about N
M.th.2@extra$SE.N.hat  # SE of the estimate of the population size
# An approximate 95 percent confidence interval:
round(M.th.2@extra$N.hat + c(-1, 1) * 1.96 *  M.th.2@extra$SE.N.hat, 1)

# Fit a M_h model, effectively the parallel M_t model, using posbinomial()
deermice &lt;- transform(deermice, ysum = y1 + y2 + y3 + y4 + y5 + y6,
                                tau  = 6)
M.h.3 &lt;- vglm(cbind(ysum, tau - ysum) ~ sex + weight,
              posbinomial(omit.constant = TRUE), data = deermice, trace = TRUE)
max(abs(coef(M.h.1) - coef(M.h.3)))  # Should be zero
logLik(M.h.3) - logLik(M.h.1)  # Difference is due to the binomial constants
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
