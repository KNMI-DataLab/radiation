<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Generalized Pareto Distribution Family Function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for gpd {VGAM}"><tr><td>gpd {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Generalized Pareto Distribution Family Function </h2>

<h3>Description</h3>

<p>Maximum likelihood estimation of the 2-parameter
generalized  Pareto distribution (GPD).
</p>


<h3>Usage</h3>

<pre>
gpd(threshold = 0, lscale = "loge", lshape = logoff(offset = 0.5),
    percentiles = c(90, 95), iscale = NULL, ishape = NULL,
    tolshape0 = 0.001, type.fitted = c("percentiles", "mean"),
    imethod = 1, zero = "shape")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>threshold</code></td>
<td>

<p>Numeric, values are recycled if necessary.
The threshold value(s), called <i>mu</i> below.
</p>
</td></tr>
<tr valign="top"><td><code>lscale</code></td>
<td>

<p>Parameter link function for the scale parameter <i>sigma</i>.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>lshape</code></td>
<td>

<p>Parameter link function for the shape parameter <i>xi</i>.
See <code><a href="Links.html">Links</a></code> for more choices.
The default constrains the parameter to be greater than <i>-0.5</i>
because if <i>xi &lt;= -0.5</i> then Fisher
scoring does not work.
See the Details section below for more information.
</p>
<p>For the shape parameter,
the default <code><a href="logoff.html">logoff</a></code> link has an offset
called <i>A</i> below; and then the second linear/additive predictor is
<i>log(xi+A)</i> which means that
<i>xi &gt; -A</i>.
The working weight matrices are positive definite if <i>A = 0.5</i>.
</p>
</td></tr>
</table>









<table summary="R argblock">
<tr valign="top"><td><code>percentiles</code></td>
<td>

<p>Numeric vector of percentiles used
for the fitted values. Values should be between 0 and 100.
See the example below for illustration.
This argument is ignored if <code>type.fitted = "mean"</code>.
</p>



</td></tr>
<tr valign="top"><td><code>type.fitted</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for information.
The default is to use the <code>percentiles</code> argument.
If <code>"mean"</code> is chosen, then the mean
<i>mu + sigma / (1-xi)</i>
is returned as the fitted values,
and these are only defined for <i>xi&lt;1</i>.
</p>
</td></tr>
<tr valign="top"><td><code>iscale, ishape</code></td>
<td>

<p>Numeric. Optional initial values for <i>sigma</i>
and <i>xi</i>.
The default is to use <code>imethod</code> and compute a value internally for
each parameter.
Values of <code>ishape</code> should be between <i>-0.5</i> and <i>1</i>.
Values of <code>iscale</code> should be positive.
</p>
</td></tr>
</table>






<table summary="R argblock">
<tr valign="top"><td><code>tolshape0</code></td>
<td>

<p>Passed into <code><a href="gpdUC.html">dgpd</a></code> when computing the log-likelihood.
</p>
</td></tr>
</table>







<table summary="R argblock">
<tr valign="top"><td><code>imethod</code></td>
<td>

<p>Method of initialization, either 1 or 2. The first is the method of
moments, and the second is a variant of this.  If neither work, try
assigning values to arguments <code>ishape</code> and/or <code>iscale</code>.
</p>
</td></tr>
<tr valign="top"><td><code>zero</code></td>
<td>

<p>Can be an integer-valued vector specifying which
linear/additive predictors are modelled as intercepts only.
For one response, the value should be from the set {1,2} corresponding
respectively to <i>sigma</i> and <i>xi</i>.
It is often a good idea for the <i>sigma</i> parameter only
to be modelled through
a linear combination of the explanatory variables because the
shape parameter is probably best left as an intercept only:
<code>zero = 2</code>.
Setting <code>zero = NULL</code> means both parameters are modelled with
explanatory variables.
See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distribution function of the GPD can be written
</p>
<p style="text-align: center;"><i>
          G(y) = 1 - [1 +  xi (y-mu)/  sigma  ]_{+}^{- 1/  xi}  </i></p>

<p>where
<i>mu</i> is the location parameter
(known, with value <code>threshold</code>),
<i>sigma &gt; 0</i> is the scale parameter,
<i>xi</i> is the shape parameter, and
<i>h_+ = max(h,0)</i>.
The function <i>1-G</i> is known as the <em>survivor function</em>.
The limit <i>xi --&gt; 0</i>
gives the <em>shifted exponential</em> as a special case:
</p>
<p style="text-align: center;"><i>
          G(y) = 1 -  exp[-(y-mu)/  sigma]. </i></p>

<p>The support is <i>y&gt;mu</i> for <i>xi&gt;0</i>,
and
<i>mu &lt; y &lt;mu-sigma / xi</i> for <i>xi&lt;0</i>.
</p>
<p>Smith (1985) showed that if <i>xi &lt;= -0.5</i> then
this is known as the nonregular case and problems/difficulties
can arise both theoretically and numerically. For the (regular)
case <i>xi &gt; -0.5</i> the classical asymptotic
theory of maximum likelihood estimators is applicable; this is
the default.
</p>
<p>Although for <i>xi &lt; -0.5</i> the usual asymptotic properties
do not apply, the maximum likelihood estimator generally exists and
is superefficient for <i>-1 &lt; xi &lt; -0.5</i>, so it is
&ldquo;better&rdquo; than normal.
When <i>xi &lt; -1</i> the maximum
likelihood estimator generally does not exist as it effectively becomes
a two parameter problem.
</p>
<p>The mean of <i>Y</i> does not exist unless <i>xi &lt; 1</i>, and
the variance does not exist unless <i>xi &lt; 0.5</i>.  So if
you want to fit a model with finite variance use <code>lshape = "extlogit"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
However, for this <span class="pkg">VGAM</span> family function, <code><a href="vglm.html">vglm</a></code>
is probably preferred over <code><a href="vgam.html">vgam</a></code> when there is smoothing.
</p>


<h3>Warning</h3>

<p>Fitting the GPD by maximum likelihood estimation can be numerically
fraught. If <i>1 + xi*(y-mu)/sigma &lt;=
  0</i> then some crude evasive action is taken but the estimation process
can still fail. This is particularly the case if <code><a href="vgam.html">vgam</a></code>
with <code><a href="s.html">s</a></code> is used. Then smoothing is best done with
<code><a href="vglm.html">vglm</a></code> with regression splines (<code><a href="../../splines/html/bs.html">bs</a></code>
or <code><a href="../../splines/html/ns.html">ns</a></code>) because <code><a href="vglm.html">vglm</a></code> implements
half-stepsizing whereas <code><a href="vgam.html">vgam</a></code> doesn't. Half-stepsizing
helps handle the problem of straying outside the parameter space.
</p>


<h3>Note</h3>

<p>The response in the formula of <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code> is <i>y</i>.
Internally, <i>y-mu</i> is computed.
This <span class="pkg">VGAM</span> family function can handle a multiple
responses, which is inputted as a matrix.
The response stored on the object is the original uncentred data.
</p>
<p>With functions <code><a href="gpdUC.html">rgpd</a></code>, <code><a href="gpdUC.html">dgpd</a></code>, etc., the
argument <code>location</code> matches with the argument <code>threshold</code>
here.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee </p>


<h3>References</h3>

<p>Yee, T. W. and Stephenson, A. G. (2007)
Vector generalized linear and additive extreme value models.
<em>Extremes</em>, <b>10</b>, 1&ndash;19.
</p>
<p>Coles, S. (2001)
<em>An Introduction to Statistical Modeling of Extreme Values</em>.
London: Springer-Verlag.
</p>
<p>Smith, R. L. (1985)
Maximum likelihood estimation in a class of nonregular cases.
<em>Biometrika</em>, <b>72</b>, 67&ndash;90.
</p>


<h3>See Also</h3>

<p><code><a href="gpdUC.html">rgpd</a></code>,
<code><a href="meplot.html">meplot</a></code>,
<code><a href="gev.html">gev</a></code>,
<code><a href="paretoff.html">paretoff</a></code>,
<code><a href="vglm.html">vglm</a></code>,
<code><a href="vgam.html">vgam</a></code>,
<code><a href="s.html">s</a></code>.
</p>


<h3>Examples</h3>

<pre>
# Simulated data from an exponential distribution (xi = 0)
Threshold &lt;- 0.5
gdata &lt;- data.frame(y1 = Threshold + rexp(n = 3000, rate = 2))
fit &lt;- vglm(y1 ~ 1, gpd(threshold = Threshold), data = gdata, trace = TRUE)
head(fitted(fit))
summary(depvar(fit))  # The original uncentred data
coef(fit, matrix = TRUE)  # xi should be close to 0
Coef(fit)
summary(fit)

head(fit@extra$threshold)  # Note the threshold is stored here

# Check the 90 percentile
ii &lt;- depvar(fit) &lt; fitted(fit)[1, "90%"]
100 * table(ii) / sum(table(ii))  # Should be 90%

# Check the 95 percentile
ii &lt;- depvar(fit) &lt; fitted(fit)[1, "95%"]
100 * table(ii) / sum(table(ii))  # Should be 95%

## Not run:  plot(depvar(fit), col = "blue", las = 1,
               main = "Fitted 90% and 95% quantiles")
matlines(1:length(depvar(fit)), fitted(fit), lty = 2:3, lwd = 2) 
## End(Not run)


# Another example
gdata &lt;- data.frame(x2 = runif(nn &lt;- 2000))
Threshold &lt;- 0; xi &lt;- exp(-0.8) - 0.5
gdata &lt;- transform(gdata, y2 = rgpd(nn, scale = exp(1 + 0.1*x2), shape = xi))
fit &lt;- vglm(y2 ~ x2, gpd(Threshold), data = gdata, trace = TRUE)
coef(fit, matrix = TRUE)


## Not run:  # Nonparametric fits
# Not so recommended:
fit1 &lt;- vgam(y2 ~ s(x2), gpd(Threshold), data = gdata, trace = TRUE)
par(mfrow = c(2, 1))
plot(fit1, se = TRUE, scol = "blue")
# More recommended:
fit2 &lt;- vglm(y2 ~ sm.bs(x2), gpd(Threshold), data = gdata, trace = TRUE)
plot(as(fit2, "vgam"), se = TRUE, scol = "blue") 
## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-2 <a href="00Index.html">Index</a>]</div>
</body></html>
