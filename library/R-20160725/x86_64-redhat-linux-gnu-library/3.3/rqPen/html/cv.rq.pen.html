<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Cross Validated quantile regression</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for cv.rq.pen {rqPen}"><tr><td>cv.rq.pen {rqPen}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Cross Validated quantile regression</h2>

<h3>Description</h3>

<p>Produces penalized quantile regression models for a range of lambdas and penalty of choice. If lambda is unselected than an iterative algorithm is used to find a maximum lambda such that the penalty is large enough to produce an intercept only model. Then range of lambdas goes from the maximum lambda found to &quot;eps&quot; on the log scale. For non-convex penalties local linear approximation approach used by Wang, Wu and Li to extend LLA as proposed by Zou and Li (2008) to the quantile regression setting.  
</p>


<h3>Usage</h3>

<pre>
cv.rq.pen(x,y,tau=.5,lambda=NULL,weights=NULL,penalty="LASSO",
          intercept=TRUE,criteria="CV",cvFunc="check",nfolds=10,
          foldid=NULL,nlambda=100,eps=.0001,init.lambda=1, penVars=NULL,...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p> Matrix of predictors.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p> Vector of response values.</p>
</td></tr>
<tr valign="top"><td><code>tau</code></td>
<td>
<p> Conditional quantile being modelled.</p>
</td></tr>            
<tr valign="top"><td><code>lambda</code></td>
<td>
<p> Vector of lambdas. Default is for lambdas to be automatically generated.</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p> Weights for the objective function.</p>
</td></tr> 
<tr valign="top"><td><code>penalty</code></td>
<td>
<p> Type of penalty: &quot;LASSO&quot;, &quot;SCAD&quot; or &quot;MCP&quot;.</p>
</td></tr>
<tr valign="top"><td><code>intercept</code></td>
<td>
<p> Whether model should include an intercept. Constant does not need to be included in &quot;x&quot;.</p>
</td></tr>
<tr valign="top"><td><code>criteria</code></td>
<td>
<p> How models will be evaluated. Either cross-validation &quot;CV&quot;, BIC &quot;BIC&quot; or large P BIC &quot;PBIC&quot;.</p>
</td></tr>
<tr valign="top"><td><code>cvFunc</code></td>
<td>
<p> If cross-validation is used how errors are evaluated. Check function &quot;check&quot;, &quot;SqErr&quot; (Squared Error) or &quot;AE&quot; (Absolute Value).</p>
</td></tr>
<tr valign="top"><td><code>nfolds</code></td>
<td>
<p> K for K-folds cross-validation.</p>
</td></tr>
<tr valign="top"><td><code>foldid</code></td>
<td>
<p> Group id for cross-validation. Function will randomly generate groups if not specified.</p>
</td></tr>
<tr valign="top"><td><code>nlambda</code></td>
<td>
<p> Number of lambdas for which models are fit.</p>
</td></tr>
<tr valign="top"><td><code>eps</code></td>
<td>
<p> Smallest lambda used.</p>
</td></tr>
<tr valign="top"><td><code>init.lambda</code></td>
<td>
<p> Initial lambda used to find the maximum lambda. Not needed if lambda values are set.</p>
</td></tr>
<tr valign="top"><td><code>penVars</code></td>
<td>
<p>Variables that should be penalized. With default value of NULL all variables are penalized.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments to be sent to rq.lasso.fit or rq.nc.fit.</p>
</td></tr>   
</table>


<h3>Value</h3>

<p>Returns the following:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>models</code></td>
<td>
<p> List of penalized models fit. Number of models will match number of lambdas and correspond to cv$lambda.</p>
</td></tr>
<tr valign="top"><td><code>cv</code></td>
<td>
<p> Data frame with &quot;lambda&quot; and second column is the evaluation based on the criteria selected.</p>
</td></tr>
<tr valign="top"><td><code>lambda.min</code></td>
<td>
<p> Lambda which provides the smallest statistic for the selected criteria.</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>
<p> Penalty selected.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Ben Sherwood</p>


<h3>References</h3>

<p>[1] Wang, L., Wu, Y. and Li, R. Quantile regression of analyzing heterogeneity in ultra-high dimension. <em>J. Am. Statist. Ass</em>, <b>107</b>, 214&ndash;222.
</p>
<p>[2] Wu, Y. and Liu, Y. (2009). Variable selection in quantile regression. <em>Statistica Sinica</em>, <b>19</b>, 801&ndash;817.
</p>
<p>[3] Zou, H. and Li, R. (2008). One-step sparse estimates in nonconcave penalized likelihood models. <em>Ann. Statist.</em>, <b>36</b>, 1509&ndash;1533.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
x &lt;- matrix(rnorm(800),nrow=100)
y &lt;- 1 + x[,1] - 3*x[,5] + rnorm(100)
cv_model &lt;- cv.rq.pen(x,y)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>rqPen</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</body></html>
